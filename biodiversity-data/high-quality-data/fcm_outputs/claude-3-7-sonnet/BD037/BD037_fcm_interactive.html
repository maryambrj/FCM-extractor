
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"commercial harvest": {"concepts": "commercial harvest", "concept_list": ["commercial harvest"], "type": "cluster", "node_size": 18, "label": "commercial harvest"}, "Ecosystem Conservation Management": {"concepts": "protected species, single species management, ecosystem approaches, food-web supporting species, spatial scales, geographic scale diversity, sampling difficulty, species conservation concern, species abundance, meso-predators, mid-level predators, single-species approach, upper trophic level predators, population increases, human-wildlife conflict, population recovery, multi-species management, ecosystem-based management, harmful organisms, elasmobranch diversity, negative interactions, biodiversity conservation, northern gulf of mexico, gamma diversity, conservation concern, geographic diversity, trophic ecology, species complexes, species management, species interactions, food-web, cascading effects, north central gulf, biodiversity, species diversity, ecosystem diversity", "concept_list": ["protected species", "single species management", "ecosystem approaches", "food-web supporting species", "spatial scales", "geographic scale diversity", "sampling difficulty", "species conservation concern", "species abundance", "meso-predators", "mid-level predators", "single-species approach", "upper trophic level predators", "population increases", "human-wildlife conflict", "population recovery", "multi-species management", "ecosystem-based management", "harmful organisms", "elasmobranch diversity", "negative interactions", "biodiversity conservation", "northern gulf of mexico", "gamma diversity", "conservation concern", "geographic diversity", "trophic ecology", "species complexes", "species management", "species interactions", "food-web", "cascading effects", "north central gulf", "biodiversity", "species diversity", "ecosystem diversity"], "type": "cluster", "node_size": 123, "label": "Ecosystem Conservation Management"}, "Fishing Industry Dynamics": {"concepts": "fisheries ecology, fishermen, fishing industry, recreational fishing, commercial fishermen, recreational harvest, ecosystem-based fishery management, fisheries management", "concept_list": ["fisheries ecology", "fishermen", "fishing industry", "recreational fishing", "commercial fishermen", "recreational harvest", "ecosystem-based fishery management", "fisheries management"], "type": "cluster", "node_size": 39, "label": "Fishing Industry Dynamics"}, "Management Tools & Stakeholders": {"concepts": "decision making framework, conceptual model, assessment priority, resource managers, harvest moratorium, report cards, mental modeler, movement patterns, management plans, stock assessment, scenario simulations, charter fishing, management interventions, extension work, sedar 77, regional managers, chesapeake bay, overfishing, noaa, tourism operators, life histories, case studies, australia, sawfish, life history, stakeholder groups, stakeholders, ebfm, sedar process, dolphins, hammerhead species, telemetry, shark deprivation, workshop, tradeoffs, hammerheads, sedar report cards", "concept_list": ["decision making framework", "conceptual model", "assessment priority", "resource managers", "harvest moratorium", "report cards", "mental modeler", "movement patterns", "management plans", "stock assessment", "scenario simulations", "charter fishing", "management interventions", "extension work", "sedar 77", "regional managers", "chesapeake bay", "overfishing", "noaa", "tourism operators", "life histories", "case studies", "australia", "sawfish", "life history", "stakeholder groups", "stakeholders", "ebfm", "sedar process", "dolphins", "hammerhead species", "telemetry", "shark deprivation", "workshop", "tradeoffs", "hammerheads", "sedar report cards"], "type": "cluster", "node_size": 126, "label": "Management Tools & Stakeholders"}, "Marine Species Resources": {"concepts": "shark populations, coastal sharks, sailor's sea, white sharks, reef fish, marine resources, shark species diversity, oysters, living shorelines, aquaculture", "concept_list": ["shark populations", "coastal sharks", "sailor's sea", "white sharks", "reef fish", "marine resources", "shark species diversity", "oysters", "living shorelines", "aquaculture"], "type": "cluster", "node_size": 45, "label": "Marine Species Resources"}};
        const conceptData = {"protected species": {"concepts": "protected species", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "protected species"}, "single species management": {"concepts": "single species management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "single species management"}, "ecosystem approaches": {"concepts": "ecosystem approaches", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "ecosystem approaches"}, "food-web supporting species": {"concepts": "food-web supporting species", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "food-web supporting species"}, "spatial scales": {"concepts": "spatial scales", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "spatial scales"}, "geographic scale diversity": {"concepts": "geographic scale diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "geographic scale diversity"}, "sampling difficulty": {"concepts": "sampling difficulty", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "sampling difficulty"}, "species conservation concern": {"concepts": "species conservation concern", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species conservation concern"}, "species abundance": {"concepts": "species abundance", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species abundance"}, "meso-predators": {"concepts": "meso-predators", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "meso-predators"}, "mid-level predators": {"concepts": "mid-level predators", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "mid-level predators"}, "single-species approach": {"concepts": "single-species approach", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "single-species approach"}, "upper trophic level predators": {"concepts": "upper trophic level predators", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "upper trophic level predators"}, "population increases": {"concepts": "population increases", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "population increases"}, "human-wildlife conflict": {"concepts": "human-wildlife conflict", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "human-wildlife conflict"}, "population recovery": {"concepts": "population recovery", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "population recovery"}, "multi-species management": {"concepts": "multi-species management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "multi-species management"}, "ecosystem-based management": {"concepts": "ecosystem-based management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "ecosystem-based management"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "harmful organisms"}, "elasmobranch diversity": {"concepts": "elasmobranch diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "elasmobranch diversity"}, "negative interactions": {"concepts": "negative interactions", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "negative interactions"}, "biodiversity conservation": {"concepts": "biodiversity conservation", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "biodiversity conservation"}, "northern gulf of mexico": {"concepts": "northern gulf of mexico", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "northern gulf of mexico"}, "gamma diversity": {"concepts": "gamma diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "gamma diversity"}, "conservation concern": {"concepts": "conservation concern", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "conservation concern"}, "geographic diversity": {"concepts": "geographic diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "geographic diversity"}, "trophic ecology": {"concepts": "trophic ecology", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "trophic ecology"}, "species complexes": {"concepts": "species complexes", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species complexes"}, "species management": {"concepts": "species management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species management"}, "species interactions": {"concepts": "species interactions", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species interactions"}, "food-web": {"concepts": "food-web", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "food-web"}, "cascading effects": {"concepts": "cascading effects", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "cascading effects"}, "north central gulf": {"concepts": "north central gulf", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "north central gulf"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "biodiversity"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species diversity"}, "ecosystem diversity": {"concepts": "ecosystem diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "ecosystem diversity"}, "fisheries ecology": {"concepts": "fisheries ecology", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fisheries ecology"}, "fishermen": {"concepts": "fishermen", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fishermen"}, "fishing industry": {"concepts": "fishing industry", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fishing industry"}, "recreational fishing": {"concepts": "recreational fishing", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "recreational fishing"}, "commercial fishermen": {"concepts": "commercial fishermen", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "commercial fishermen"}, "recreational harvest": {"concepts": "recreational harvest", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "recreational harvest"}, "ecosystem-based fishery management": {"concepts": "ecosystem-based fishery management", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "ecosystem-based fishery management"}, "fisheries management": {"concepts": "fisheries management", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fisheries management"}, "decision making framework": {"concepts": "decision making framework", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "decision making framework"}, "conceptual model": {"concepts": "conceptual model", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "conceptual model"}, "assessment priority": {"concepts": "assessment priority", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "assessment priority"}, "resource managers": {"concepts": "resource managers", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "resource managers"}, "harvest moratorium": {"concepts": "harvest moratorium", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "harvest moratorium"}, "report cards": {"concepts": "report cards", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "report cards"}, "mental modeler": {"concepts": "mental modeler", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "mental modeler"}, "movement patterns": {"concepts": "movement patterns", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "movement patterns"}, "management plans": {"concepts": "management plans", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "management plans"}, "stock assessment": {"concepts": "stock assessment", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "stock assessment"}, "scenario simulations": {"concepts": "scenario simulations", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "scenario simulations"}, "charter fishing": {"concepts": "charter fishing", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "charter fishing"}, "management interventions": {"concepts": "management interventions", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "management interventions"}, "extension work": {"concepts": "extension work", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "extension work"}, "sedar 77": {"concepts": "sedar 77", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sedar 77"}, "regional managers": {"concepts": "regional managers", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "regional managers"}, "chesapeake bay": {"concepts": "chesapeake bay", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "chesapeake bay"}, "overfishing": {"concepts": "overfishing", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "overfishing"}, "noaa": {"concepts": "noaa", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "noaa"}, "tourism operators": {"concepts": "tourism operators", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "tourism operators"}, "life histories": {"concepts": "life histories", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "life histories"}, "case studies": {"concepts": "case studies", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "case studies"}, "australia": {"concepts": "australia", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "australia"}, "sawfish": {"concepts": "sawfish", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sawfish"}, "life history": {"concepts": "life history", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "life history"}, "stakeholder groups": {"concepts": "stakeholder groups", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "stakeholder groups"}, "stakeholders": {"concepts": "stakeholders", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "stakeholders"}, "ebfm": {"concepts": "ebfm", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "ebfm"}, "sedar process": {"concepts": "sedar process", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sedar process"}, "dolphins": {"concepts": "dolphins", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "dolphins"}, "hammerhead species": {"concepts": "hammerhead species", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "hammerhead species"}, "telemetry": {"concepts": "telemetry", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "telemetry"}, "shark deprivation": {"concepts": "shark deprivation", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "shark deprivation"}, "workshop": {"concepts": "workshop", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "workshop"}, "tradeoffs": {"concepts": "tradeoffs", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "tradeoffs"}, "hammerheads": {"concepts": "hammerheads", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "hammerheads"}, "sedar report cards": {"concepts": "sedar report cards", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sedar report cards"}, "shark populations": {"concepts": "shark populations", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "shark populations"}, "coastal sharks": {"concepts": "coastal sharks", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "coastal sharks"}, "sailor's sea": {"concepts": "sailor's sea", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "sailor's sea"}, "white sharks": {"concepts": "white sharks", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "white sharks"}, "reef fish": {"concepts": "reef fish", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "reef fish"}, "marine resources": {"concepts": "marine resources", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "marine resources"}, "shark species diversity": {"concepts": "shark species diversity", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "shark species diversity"}, "oysters": {"concepts": "oysters", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "oysters"}, "living shorelines": {"concepts": "living shorelines", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "living shorelines"}, "aquaculture": {"concepts": "aquaculture", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "aquaculture"}};
        const interClusterEdges = [["commercial harvest", "Ecosystem Conservation Management", {"weight": -0.6, "confidence": 0.82, "type": "inter_cluster", "style": "solid"}], ["commercial harvest", "Marine Species Resources", {"weight": -1.0, "confidence": 0.78, "type": "inter_cluster", "style": "solid"}], ["commercial harvest", "Fishing Industry Dynamics", {"weight": 0.6, "confidence": 0.7999999999999999, "type": "inter_cluster", "style": "solid"}], ["commercial harvest", "Management Tools & Stakeholders", {"weight": 0.25, "confidence": 0.7125, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Conservation Management", "Marine Species Resources", {"weight": 1.0, "confidence": 0.8800000000000001, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Conservation Management", "Fishing Industry Dynamics", {"weight": 0.2, "confidence": 0.82, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Conservation Management", "commercial harvest", {"weight": -1.0, "confidence": 0.79, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Conservation Management", "Management Tools & Stakeholders", {"weight": 0.8, "confidence": 0.6599999999999999, "type": "inter_cluster", "style": "solid"}], ["Fishing Industry Dynamics", "Ecosystem Conservation Management", {"weight": 1.0, "confidence": 0.8099999999999999, "type": "inter_cluster", "style": "solid"}], ["Fishing Industry Dynamics", "Marine Species Resources", {"weight": 0.6, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Fishing Industry Dynamics", "commercial harvest", {"weight": 0.4, "confidence": 0.8300000000000001, "type": "inter_cluster", "style": "solid"}], ["Fishing Industry Dynamics", "Management Tools & Stakeholders", {"weight": 0.75, "confidence": 0.8250000000000001, "type": "inter_cluster", "style": "solid"}], ["Management Tools & Stakeholders", "commercial harvest", {"weight": -1.0, "confidence": 0.89, "type": "inter_cluster", "style": "solid"}], ["Management Tools & Stakeholders", "Fishing Industry Dynamics", {"weight": 0.8, "confidence": 0.8700000000000001, "type": "inter_cluster", "style": "solid"}], ["Management Tools & Stakeholders", "Ecosystem Conservation Management", {"weight": 1.0, "confidence": 0.825, "type": "inter_cluster", "style": "solid"}], ["Management Tools & Stakeholders", "Marine Species Resources", {"weight": 0.75, "confidence": 0.825, "type": "inter_cluster", "style": "solid"}], ["Marine Species Resources", "Ecosystem Conservation Management", {"weight": 1.0, "confidence": 0.8800000000000001, "type": "inter_cluster", "style": "solid"}], ["Marine Species Resources", "Management Tools & Stakeholders", {"weight": 1.0, "confidence": 0.8099999999999999, "type": "inter_cluster", "style": "solid"}], ["Marine Species Resources", "Fishing Industry Dynamics", {"weight": 0.8, "confidence": 0.82, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Ecosystem Conservation Management": [["protected species", {"concepts": "protected species", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "protected species"}], ["single species management", {"concepts": "single species management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "single species management"}], ["ecosystem approaches", {"concepts": "ecosystem approaches", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "ecosystem approaches"}], ["food-web supporting species", {"concepts": "food-web supporting species", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "food-web supporting species"}], ["spatial scales", {"concepts": "spatial scales", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "spatial scales"}], ["geographic scale diversity", {"concepts": "geographic scale diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "geographic scale diversity"}], ["sampling difficulty", {"concepts": "sampling difficulty", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "sampling difficulty"}], ["species conservation concern", {"concepts": "species conservation concern", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species conservation concern"}], ["species abundance", {"concepts": "species abundance", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species abundance"}], ["meso-predators", {"concepts": "meso-predators", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "meso-predators"}], ["mid-level predators", {"concepts": "mid-level predators", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "mid-level predators"}], ["single-species approach", {"concepts": "single-species approach", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "single-species approach"}], ["upper trophic level predators", {"concepts": "upper trophic level predators", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "upper trophic level predators"}], ["population increases", {"concepts": "population increases", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "population increases"}], ["human-wildlife conflict", {"concepts": "human-wildlife conflict", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "human-wildlife conflict"}], ["population recovery", {"concepts": "population recovery", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "population recovery"}], ["multi-species management", {"concepts": "multi-species management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "multi-species management"}], ["ecosystem-based management", {"concepts": "ecosystem-based management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "ecosystem-based management"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "harmful organisms"}], ["elasmobranch diversity", {"concepts": "elasmobranch diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "elasmobranch diversity"}], ["negative interactions", {"concepts": "negative interactions", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "negative interactions"}], ["biodiversity conservation", {"concepts": "biodiversity conservation", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "biodiversity conservation"}], ["northern gulf of mexico", {"concepts": "northern gulf of mexico", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "northern gulf of mexico"}], ["gamma diversity", {"concepts": "gamma diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "gamma diversity"}], ["conservation concern", {"concepts": "conservation concern", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "conservation concern"}], ["geographic diversity", {"concepts": "geographic diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "geographic diversity"}], ["trophic ecology", {"concepts": "trophic ecology", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "trophic ecology"}], ["species complexes", {"concepts": "species complexes", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species complexes"}], ["species management", {"concepts": "species management", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species management"}], ["species interactions", {"concepts": "species interactions", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species interactions"}], ["food-web", {"concepts": "food-web", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "food-web"}], ["cascading effects", {"concepts": "cascading effects", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "cascading effects"}], ["north central gulf", {"concepts": "north central gulf", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "north central gulf"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "biodiversity"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "species diversity"}], ["ecosystem diversity", {"concepts": "ecosystem diversity", "type": "concept", "cluster": "Ecosystem Conservation Management", "node_size": 10, "label": "ecosystem diversity"}]], "Fishing Industry Dynamics": [["fisheries ecology", {"concepts": "fisheries ecology", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fisheries ecology"}], ["fishermen", {"concepts": "fishermen", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fishermen"}], ["fishing industry", {"concepts": "fishing industry", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fishing industry"}], ["recreational fishing", {"concepts": "recreational fishing", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "recreational fishing"}], ["commercial fishermen", {"concepts": "commercial fishermen", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "commercial fishermen"}], ["recreational harvest", {"concepts": "recreational harvest", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "recreational harvest"}], ["ecosystem-based fishery management", {"concepts": "ecosystem-based fishery management", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "ecosystem-based fishery management"}], ["fisheries management", {"concepts": "fisheries management", "type": "concept", "cluster": "Fishing Industry Dynamics", "node_size": 10, "label": "fisheries management"}]], "Management Tools & Stakeholders": [["decision making framework", {"concepts": "decision making framework", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "decision making framework"}], ["conceptual model", {"concepts": "conceptual model", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "conceptual model"}], ["assessment priority", {"concepts": "assessment priority", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "assessment priority"}], ["resource managers", {"concepts": "resource managers", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "resource managers"}], ["harvest moratorium", {"concepts": "harvest moratorium", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "harvest moratorium"}], ["report cards", {"concepts": "report cards", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "report cards"}], ["mental modeler", {"concepts": "mental modeler", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "mental modeler"}], ["movement patterns", {"concepts": "movement patterns", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "movement patterns"}], ["management plans", {"concepts": "management plans", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "management plans"}], ["stock assessment", {"concepts": "stock assessment", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "stock assessment"}], ["scenario simulations", {"concepts": "scenario simulations", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "scenario simulations"}], ["charter fishing", {"concepts": "charter fishing", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "charter fishing"}], ["management interventions", {"concepts": "management interventions", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "management interventions"}], ["extension work", {"concepts": "extension work", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "extension work"}], ["sedar 77", {"concepts": "sedar 77", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sedar 77"}], ["regional managers", {"concepts": "regional managers", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "regional managers"}], ["chesapeake bay", {"concepts": "chesapeake bay", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "chesapeake bay"}], ["overfishing", {"concepts": "overfishing", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "overfishing"}], ["noaa", {"concepts": "noaa", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "noaa"}], ["tourism operators", {"concepts": "tourism operators", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "tourism operators"}], ["life histories", {"concepts": "life histories", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "life histories"}], ["case studies", {"concepts": "case studies", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "case studies"}], ["australia", {"concepts": "australia", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "australia"}], ["sawfish", {"concepts": "sawfish", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sawfish"}], ["life history", {"concepts": "life history", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "life history"}], ["stakeholder groups", {"concepts": "stakeholder groups", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "stakeholder groups"}], ["stakeholders", {"concepts": "stakeholders", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "stakeholders"}], ["ebfm", {"concepts": "ebfm", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "ebfm"}], ["sedar process", {"concepts": "sedar process", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sedar process"}], ["dolphins", {"concepts": "dolphins", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "dolphins"}], ["hammerhead species", {"concepts": "hammerhead species", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "hammerhead species"}], ["telemetry", {"concepts": "telemetry", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "telemetry"}], ["shark deprivation", {"concepts": "shark deprivation", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "shark deprivation"}], ["workshop", {"concepts": "workshop", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "workshop"}], ["tradeoffs", {"concepts": "tradeoffs", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "tradeoffs"}], ["hammerheads", {"concepts": "hammerheads", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "hammerheads"}], ["sedar report cards", {"concepts": "sedar report cards", "type": "concept", "cluster": "Management Tools & Stakeholders", "node_size": 10, "label": "sedar report cards"}]], "Marine Species Resources": [["shark populations", {"concepts": "shark populations", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "shark populations"}], ["coastal sharks", {"concepts": "coastal sharks", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "coastal sharks"}], ["sailor's sea", {"concepts": "sailor's sea", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "sailor's sea"}], ["white sharks", {"concepts": "white sharks", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "white sharks"}], ["reef fish", {"concepts": "reef fish", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "reef fish"}], ["marine resources", {"concepts": "marine resources", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "marine resources"}], ["shark species diversity", {"concepts": "shark species diversity", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "shark species diversity"}], ["oysters", {"concepts": "oysters", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "oysters"}], ["living shorelines", {"concepts": "living shorelines", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "living shorelines"}], ["aquaculture", {"concepts": "aquaculture", "type": "concept", "cluster": "Marine Species Resources", "node_size": 10, "label": "aquaculture"}]]};
        const clusterEdges = {"Ecosystem Conservation Management": [], "Fishing Industry Dynamics": [], "Management Tools & Stakeholders": [], "Marine Species Resources": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

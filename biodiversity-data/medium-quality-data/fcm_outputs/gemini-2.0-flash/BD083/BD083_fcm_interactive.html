
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Government Management": {"concepts": "gillnetters, tribal longliners, tribal gillnets, tribal factor, tribal interests, gillnets, tribal long liners, tribal money, sockeye", "concept_list": ["gillnetters", "tribal longliners", "tribal gillnets", "tribal factor", "tribal interests", "gillnets", "tribal long liners", "tribal money", "sockeye"], "type": "cluster", "node_size": 42, "label": "Government Management"}, "Societal Impacts": {"concepts": "government entity, game department, management, political views, management policies, courts", "concept_list": ["government entity", "game department", "management", "political views", "management policies", "courts"], "type": "cluster", "node_size": 33, "label": "Societal Impacts"}, "Marine Ecosystem": {"concepts": "public appreciation, extreme gaming, family impact, taste, new reality, environmental stressors, infighting, generational differences, backdoor dealings, harmful organisms, biodiversity, special interests, competition, slade gordon, propaganda war, ethical concerns, human proximity, public overreaction, childhood experience, fishing, workaholics, conservation, politics, kayaker impact, habitat, research hypocrisy, covid impact, captivity impact, bank money, work-life balance, orca networks, media influence, species, research misconduct, covid, food web, economic factors, license sales, marketing, young people, hypocrisy research, misinformation, infighting elders", "concept_list": ["public appreciation", "extreme gaming", "family impact", "taste", "new reality", "environmental stressors", "infighting", "generational differences", "backdoor dealings", "harmful organisms", "biodiversity", "special interests", "competition", "slade gordon", "propaganda war", "ethical concerns", "human proximity", "public overreaction", "childhood experience", "fishing", "workaholics", "conservation", "politics", "kayaker impact", "habitat", "research hypocrisy", "covid impact", "captivity impact", "bank money", "work-life balance", "orca networks", "media influence", "species", "research misconduct", "covid", "food web", "economic factors", "license sales", "marketing", "young people", "hypocrisy research", "misinformation", "infighting elders"], "type": "cluster", "node_size": 144, "label": "Marine Ecosystem"}, "Seafood Varieties": {"concepts": "boat launch, halibut charters, kelp collection, predators, san juan islands, true cod, eelgrass, sports fit, charter boat, chinook, halibut, sardines, herring, kelp beds, halibut season", "concept_list": ["boat launch", "halibut charters", "kelp collection", "predators", "san juan islands", "true cod", "eelgrass", "sports fit", "charter boat", "chinook", "halibut", "sardines", "herring", "kelp beds", "halibut season"], "type": "cluster", "node_size": 60, "label": "Seafood Varieties"}, "Tribal Fishing Rights": {"concepts": "seafood, salmon, atlantic salmon, codfish, salmon taste, white king salmon", "concept_list": ["seafood", "salmon", "atlantic salmon", "codfish", "salmon taste", "white king salmon"], "type": "cluster", "node_size": 33, "label": "Tribal Fishing Rights"}, "Marine Predators": {"concepts": "salmon predators, seal predation, sea lions, orca whales", "concept_list": ["salmon predators", "seal predation", "sea lions", "orca whales"], "type": "cluster", "node_size": 27, "label": "Marine Predators"}, "Fishing and Industry": {"concepts": "fishing fleets, recreational fishing, ocean poundage, flounder fishing, salmon charter, salmon fishing, sports fishermen, fishing industry, tribal fishing, halibut fishing, commercial fisherman, bait fishing, fishing licenses, fish farms, whale watching industry", "concept_list": ["fishing fleets", "recreational fishing", "ocean poundage", "flounder fishing", "salmon charter", "salmon fishing", "sports fishermen", "fishing industry", "tribal fishing", "halibut fishing", "commercial fisherman", "bait fishing", "fishing licenses", "fish farms", "whale watching industry"], "type": "cluster", "node_size": 60, "label": "Fishing and Industry"}};
        const conceptData = {"gillnetters": {"concepts": "gillnetters", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "gillnetters"}, "tribal longliners": {"concepts": "tribal longliners", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal longliners"}, "tribal gillnets": {"concepts": "tribal gillnets", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal gillnets"}, "tribal factor": {"concepts": "tribal factor", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal factor"}, "tribal interests": {"concepts": "tribal interests", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal interests"}, "gillnets": {"concepts": "gillnets", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "gillnets"}, "tribal long liners": {"concepts": "tribal long liners", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal long liners"}, "tribal money": {"concepts": "tribal money", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal money"}, "sockeye": {"concepts": "sockeye", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "sockeye"}, "government entity": {"concepts": "government entity", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "government entity"}, "game department": {"concepts": "game department", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "game department"}, "management": {"concepts": "management", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "management"}, "political views": {"concepts": "political views", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "political views"}, "management policies": {"concepts": "management policies", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "management policies"}, "courts": {"concepts": "courts", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "courts"}, "public appreciation": {"concepts": "public appreciation", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "public appreciation"}, "extreme gaming": {"concepts": "extreme gaming", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "extreme gaming"}, "family impact": {"concepts": "family impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "family impact"}, "taste": {"concepts": "taste", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "taste"}, "new reality": {"concepts": "new reality", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "new reality"}, "environmental stressors": {"concepts": "environmental stressors", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "environmental stressors"}, "infighting": {"concepts": "infighting", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "infighting"}, "generational differences": {"concepts": "generational differences", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "generational differences"}, "backdoor dealings": {"concepts": "backdoor dealings", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "backdoor dealings"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "harmful organisms"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "biodiversity"}, "special interests": {"concepts": "special interests", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "special interests"}, "competition": {"concepts": "competition", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "competition"}, "slade gordon": {"concepts": "slade gordon", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "slade gordon"}, "propaganda war": {"concepts": "propaganda war", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "propaganda war"}, "ethical concerns": {"concepts": "ethical concerns", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "ethical concerns"}, "human proximity": {"concepts": "human proximity", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "human proximity"}, "public overreaction": {"concepts": "public overreaction", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "public overreaction"}, "childhood experience": {"concepts": "childhood experience", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "childhood experience"}, "fishing": {"concepts": "fishing", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "fishing"}, "workaholics": {"concepts": "workaholics", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "workaholics"}, "conservation": {"concepts": "conservation", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "conservation"}, "politics": {"concepts": "politics", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "politics"}, "kayaker impact": {"concepts": "kayaker impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "kayaker impact"}, "habitat": {"concepts": "habitat", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "habitat"}, "research hypocrisy": {"concepts": "research hypocrisy", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "research hypocrisy"}, "covid impact": {"concepts": "covid impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "covid impact"}, "captivity impact": {"concepts": "captivity impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "captivity impact"}, "bank money": {"concepts": "bank money", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "bank money"}, "work-life balance": {"concepts": "work-life balance", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "work-life balance"}, "orca networks": {"concepts": "orca networks", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "orca networks"}, "media influence": {"concepts": "media influence", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "media influence"}, "species": {"concepts": "species", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "species"}, "research misconduct": {"concepts": "research misconduct", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "research misconduct"}, "covid": {"concepts": "covid", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "covid"}, "food web": {"concepts": "food web", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "food web"}, "economic factors": {"concepts": "economic factors", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "economic factors"}, "license sales": {"concepts": "license sales", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "license sales"}, "marketing": {"concepts": "marketing", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "marketing"}, "young people": {"concepts": "young people", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "young people"}, "hypocrisy research": {"concepts": "hypocrisy research", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "hypocrisy research"}, "misinformation": {"concepts": "misinformation", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "misinformation"}, "infighting elders": {"concepts": "infighting elders", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "infighting elders"}, "boat launch": {"concepts": "boat launch", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "boat launch"}, "halibut charters": {"concepts": "halibut charters", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "halibut charters"}, "kelp collection": {"concepts": "kelp collection", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "kelp collection"}, "predators": {"concepts": "predators", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "predators"}, "san juan islands": {"concepts": "san juan islands", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "san juan islands"}, "true cod": {"concepts": "true cod", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "true cod"}, "eelgrass": {"concepts": "eelgrass", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "eelgrass"}, "sports fit": {"concepts": "sports fit", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "sports fit"}, "charter boat": {"concepts": "charter boat", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "charter boat"}, "chinook": {"concepts": "chinook", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "chinook"}, "halibut": {"concepts": "halibut", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "halibut"}, "sardines": {"concepts": "sardines", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "sardines"}, "herring": {"concepts": "herring", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "herring"}, "kelp beds": {"concepts": "kelp beds", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "kelp beds"}, "halibut season": {"concepts": "halibut season", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "halibut season"}, "seafood": {"concepts": "seafood", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "seafood"}, "salmon": {"concepts": "salmon", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "salmon"}, "atlantic salmon": {"concepts": "atlantic salmon", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "atlantic salmon"}, "codfish": {"concepts": "codfish", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "codfish"}, "salmon taste": {"concepts": "salmon taste", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "salmon taste"}, "white king salmon": {"concepts": "white king salmon", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "white king salmon"}, "salmon predators": {"concepts": "salmon predators", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "salmon predators"}, "seal predation": {"concepts": "seal predation", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "seal predation"}, "sea lions": {"concepts": "sea lions", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "sea lions"}, "orca whales": {"concepts": "orca whales", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "orca whales"}, "fishing fleets": {"concepts": "fishing fleets", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fishing fleets"}, "recreational fishing": {"concepts": "recreational fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "recreational fishing"}, "ocean poundage": {"concepts": "ocean poundage", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "ocean poundage"}, "flounder fishing": {"concepts": "flounder fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "flounder fishing"}, "salmon charter": {"concepts": "salmon charter", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "salmon charter"}, "salmon fishing": {"concepts": "salmon fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "salmon fishing"}, "sports fishermen": {"concepts": "sports fishermen", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "sports fishermen"}, "fishing industry": {"concepts": "fishing industry", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fishing industry"}, "tribal fishing": {"concepts": "tribal fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "tribal fishing"}, "halibut fishing": {"concepts": "halibut fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "halibut fishing"}, "commercial fisherman": {"concepts": "commercial fisherman", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "commercial fisherman"}, "bait fishing": {"concepts": "bait fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "bait fishing"}, "fishing licenses": {"concepts": "fishing licenses", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fishing licenses"}, "fish farms": {"concepts": "fish farms", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fish farms"}, "whale watching industry": {"concepts": "whale watching industry", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "whale watching industry"}};
        const interClusterEdges = [["Government Management", "Societal Impacts", {"weight": 0.6, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Government Management", "Marine Predators", {"weight": 1.0, "confidence": 0.38, "type": "inter_cluster", "style": "solid"}], ["Government Management", "Tribal Fishing Rights", {"weight": 0.25, "confidence": 0.275, "type": "inter_cluster", "style": "solid"}], ["Government Management", "Seafood Varieties", {"weight": -0.6666666666666666, "confidence": 0.2333333333333333, "type": "inter_cluster", "style": "solid"}], ["Societal Impacts", "Fishing and Industry", {"weight": 0.6, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Societal Impacts", "Seafood Varieties", {"weight": 0.6, "confidence": 0.43, "type": "inter_cluster", "style": "solid"}], ["Societal Impacts", "Marine Predators", {"weight": 0.2, "confidence": 0.2, "type": "inter_cluster", "style": "solid"}], ["Marine Ecosystem", "Seafood Varieties", {"weight": 1.0, "confidence": 0.39, "type": "inter_cluster", "style": "solid"}], ["Marine Ecosystem", "Government Management", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Seafood Varieties", "Fishing and Industry", {"weight": 1.0, "confidence": 0.63, "type": "inter_cluster", "style": "solid"}], ["Seafood Varieties", "Tribal Fishing Rights", {"weight": 1.0, "confidence": 0.58, "type": "inter_cluster", "style": "solid"}], ["Seafood Varieties", "Societal Impacts", {"weight": 1.0, "confidence": 0.39, "type": "inter_cluster", "style": "solid"}], ["Seafood Varieties", "Marine Ecosystem", {"weight": 1.0, "confidence": 0.3875, "type": "inter_cluster", "style": "solid"}], ["Tribal Fishing Rights", "Societal Impacts", {"weight": 0.5, "confidence": 0.1, "type": "inter_cluster", "style": "solid"}], ["Marine Predators", "Tribal Fishing Rights", {"weight": -1.0, "confidence": 0.7000000000000001, "type": "inter_cluster", "style": "solid"}], ["Marine Predators", "Seafood Varieties", {"weight": -0.8, "confidence": 0.31999999999999995, "type": "inter_cluster", "style": "solid"}], ["Marine Predators", "Societal Impacts", {"weight": 0.75, "confidence": 0.22499999999999998, "type": "inter_cluster", "style": "solid"}], ["Fishing and Industry", "Societal Impacts", {"weight": 1.0, "confidence": 0.51, "type": "inter_cluster", "style": "solid"}], ["Fishing and Industry", "Government Management", {"weight": 1.0, "confidence": 0.45999999999999996, "type": "inter_cluster", "style": "solid"}], ["Fishing and Industry", "Marine Ecosystem", {"weight": 1.0, "confidence": 0.41, "type": "inter_cluster", "style": "solid"}], ["Fishing and Industry", "Marine Predators", {"weight": -0.6, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Government Management": [["gillnetters", {"concepts": "gillnetters", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "gillnetters"}], ["tribal longliners", {"concepts": "tribal longliners", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal longliners"}], ["tribal gillnets", {"concepts": "tribal gillnets", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal gillnets"}], ["tribal factor", {"concepts": "tribal factor", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal factor"}], ["tribal interests", {"concepts": "tribal interests", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal interests"}], ["gillnets", {"concepts": "gillnets", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "gillnets"}], ["tribal long liners", {"concepts": "tribal long liners", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal long liners"}], ["tribal money", {"concepts": "tribal money", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "tribal money"}], ["sockeye", {"concepts": "sockeye", "type": "concept", "cluster": "Government Management", "node_size": 10, "label": "sockeye"}]], "Societal Impacts": [["government entity", {"concepts": "government entity", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "government entity"}], ["game department", {"concepts": "game department", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "game department"}], ["management", {"concepts": "management", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "management"}], ["political views", {"concepts": "political views", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "political views"}], ["management policies", {"concepts": "management policies", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "management policies"}], ["courts", {"concepts": "courts", "type": "concept", "cluster": "Societal Impacts", "node_size": 10, "label": "courts"}]], "Marine Ecosystem": [["public appreciation", {"concepts": "public appreciation", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "public appreciation"}], ["extreme gaming", {"concepts": "extreme gaming", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "extreme gaming"}], ["family impact", {"concepts": "family impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "family impact"}], ["taste", {"concepts": "taste", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "taste"}], ["new reality", {"concepts": "new reality", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "new reality"}], ["environmental stressors", {"concepts": "environmental stressors", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "environmental stressors"}], ["infighting", {"concepts": "infighting", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "infighting"}], ["generational differences", {"concepts": "generational differences", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "generational differences"}], ["backdoor dealings", {"concepts": "backdoor dealings", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "backdoor dealings"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "harmful organisms"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "biodiversity"}], ["special interests", {"concepts": "special interests", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "special interests"}], ["competition", {"concepts": "competition", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "competition"}], ["slade gordon", {"concepts": "slade gordon", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "slade gordon"}], ["propaganda war", {"concepts": "propaganda war", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "propaganda war"}], ["ethical concerns", {"concepts": "ethical concerns", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "ethical concerns"}], ["human proximity", {"concepts": "human proximity", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "human proximity"}], ["public overreaction", {"concepts": "public overreaction", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "public overreaction"}], ["childhood experience", {"concepts": "childhood experience", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "childhood experience"}], ["fishing", {"concepts": "fishing", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "fishing"}], ["workaholics", {"concepts": "workaholics", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "workaholics"}], ["conservation", {"concepts": "conservation", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "conservation"}], ["politics", {"concepts": "politics", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "politics"}], ["kayaker impact", {"concepts": "kayaker impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "kayaker impact"}], ["habitat", {"concepts": "habitat", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "habitat"}], ["research hypocrisy", {"concepts": "research hypocrisy", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "research hypocrisy"}], ["covid impact", {"concepts": "covid impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "covid impact"}], ["captivity impact", {"concepts": "captivity impact", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "captivity impact"}], ["bank money", {"concepts": "bank money", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "bank money"}], ["work-life balance", {"concepts": "work-life balance", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "work-life balance"}], ["orca networks", {"concepts": "orca networks", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "orca networks"}], ["media influence", {"concepts": "media influence", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "media influence"}], ["species", {"concepts": "species", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "species"}], ["research misconduct", {"concepts": "research misconduct", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "research misconduct"}], ["covid", {"concepts": "covid", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "covid"}], ["food web", {"concepts": "food web", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "food web"}], ["economic factors", {"concepts": "economic factors", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "economic factors"}], ["license sales", {"concepts": "license sales", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "license sales"}], ["marketing", {"concepts": "marketing", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "marketing"}], ["young people", {"concepts": "young people", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "young people"}], ["hypocrisy research", {"concepts": "hypocrisy research", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "hypocrisy research"}], ["misinformation", {"concepts": "misinformation", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "misinformation"}], ["infighting elders", {"concepts": "infighting elders", "type": "concept", "cluster": "Marine Ecosystem", "node_size": 10, "label": "infighting elders"}]], "Seafood Varieties": [["boat launch", {"concepts": "boat launch", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "boat launch"}], ["halibut charters", {"concepts": "halibut charters", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "halibut charters"}], ["kelp collection", {"concepts": "kelp collection", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "kelp collection"}], ["predators", {"concepts": "predators", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "predators"}], ["san juan islands", {"concepts": "san juan islands", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "san juan islands"}], ["true cod", {"concepts": "true cod", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "true cod"}], ["eelgrass", {"concepts": "eelgrass", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "eelgrass"}], ["sports fit", {"concepts": "sports fit", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "sports fit"}], ["charter boat", {"concepts": "charter boat", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "charter boat"}], ["chinook", {"concepts": "chinook", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "chinook"}], ["halibut", {"concepts": "halibut", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "halibut"}], ["sardines", {"concepts": "sardines", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "sardines"}], ["herring", {"concepts": "herring", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "herring"}], ["kelp beds", {"concepts": "kelp beds", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "kelp beds"}], ["halibut season", {"concepts": "halibut season", "type": "concept", "cluster": "Seafood Varieties", "node_size": 10, "label": "halibut season"}]], "Tribal Fishing Rights": [["seafood", {"concepts": "seafood", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "seafood"}], ["salmon", {"concepts": "salmon", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "salmon"}], ["atlantic salmon", {"concepts": "atlantic salmon", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "atlantic salmon"}], ["codfish", {"concepts": "codfish", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "codfish"}], ["salmon taste", {"concepts": "salmon taste", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "salmon taste"}], ["white king salmon", {"concepts": "white king salmon", "type": "concept", "cluster": "Tribal Fishing Rights", "node_size": 10, "label": "white king salmon"}]], "Marine Predators": [["salmon predators", {"concepts": "salmon predators", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "salmon predators"}], ["seal predation", {"concepts": "seal predation", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "seal predation"}], ["sea lions", {"concepts": "sea lions", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "sea lions"}], ["orca whales", {"concepts": "orca whales", "type": "concept", "cluster": "Marine Predators", "node_size": 10, "label": "orca whales"}]], "Fishing and Industry": [["fishing fleets", {"concepts": "fishing fleets", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fishing fleets"}], ["recreational fishing", {"concepts": "recreational fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "recreational fishing"}], ["ocean poundage", {"concepts": "ocean poundage", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "ocean poundage"}], ["flounder fishing", {"concepts": "flounder fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "flounder fishing"}], ["salmon charter", {"concepts": "salmon charter", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "salmon charter"}], ["salmon fishing", {"concepts": "salmon fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "salmon fishing"}], ["sports fishermen", {"concepts": "sports fishermen", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "sports fishermen"}], ["fishing industry", {"concepts": "fishing industry", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fishing industry"}], ["tribal fishing", {"concepts": "tribal fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "tribal fishing"}], ["halibut fishing", {"concepts": "halibut fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "halibut fishing"}], ["commercial fisherman", {"concepts": "commercial fisherman", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "commercial fisherman"}], ["bait fishing", {"concepts": "bait fishing", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "bait fishing"}], ["fishing licenses", {"concepts": "fishing licenses", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fishing licenses"}], ["fish farms", {"concepts": "fish farms", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "fish farms"}], ["whale watching industry", {"concepts": "whale watching industry", "type": "concept", "cluster": "Fishing and Industry", "node_size": 10, "label": "whale watching industry"}]]};
        const clusterEdges = {"Government Management": [], "Societal Impacts": [], "Marine Ecosystem": [], "Seafood Varieties": [], "Tribal Fishing Rights": [], "Marine Predators": [], "Fishing and Industry": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

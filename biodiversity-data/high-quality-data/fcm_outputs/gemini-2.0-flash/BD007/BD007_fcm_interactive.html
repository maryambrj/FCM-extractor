
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"oil exploration": {"concepts": "oil exploration", "concept_list": ["oil exploration"], "type": "cluster", "node_size": 18, "label": "oil exploration"}, "Fishing Industry": {"concepts": "marine sanctuary, marine protected area, marine resource management, marine science, seafloor mapping, oceanographic habitats, marine biodiversity, deep sea corals", "concept_list": ["marine sanctuary", "marine protected area", "marine resource management", "marine science", "seafloor mapping", "oceanographic habitats", "marine biodiversity", "deep sea corals"], "type": "cluster", "node_size": 39, "label": "Fishing Industry"}, "Maritime Industry": {"concepts": "fishing communities, fishery, fishing industry, fish gear, fishing gear, shallow water", "concept_list": ["fishing communities", "fishery", "fishing industry", "fish gear", "fishing gear", "shallow water"], "type": "cluster", "node_size": 33, "label": "Maritime Industry"}, "Marine Threats": {"concepts": "oil and gas, gas exploration, shipping lanes, shipping industry, ship strikes", "concept_list": ["oil and gas", "gas exploration", "shipping lanes", "shipping industry", "ship strikes"], "type": "cluster", "node_size": 30, "label": "Marine Threats"}, "Ocean Ecosystem Health": {"concepts": "marine debris, harmful algal bloom, coral reefs, cetaceans, whale cetaceans, deep ocean, ocean acidification, benthic disturbance, benthic habitats", "concept_list": ["marine debris", "harmful algal bloom", "coral reefs", "cetaceans", "whale cetaceans", "deep ocean", "ocean acidification", "benthic disturbance", "benthic habitats"], "type": "cluster", "node_size": 42, "label": "Ocean Ecosystem Health"}, "Species Biodiversity": {"concepts": "plankton, species diversity, threatened species, food web, species range, species, species evenness, biodiversity, biogeography, diversity components, shannon diversity, at-risk species, endangered species, species distribution, biodiversity definition", "concept_list": ["plankton", "species diversity", "threatened species", "food web", "species range", "species", "species evenness", "biodiversity", "biogeography", "diversity components", "shannon diversity", "at-risk species", "endangered species", "species distribution", "biodiversity definition"], "type": "cluster", "node_size": 60, "label": "Species Biodiversity"}, "Environmental Stressors": {"concepts": "microplastics, noise pollution, negative impact, hypoxia, negative impacts, stressors, micro plastics, climate change, storm frequency, increased temperatures", "concept_list": ["microplastics", "noise pollution", "negative impact", "hypoxia", "negative impacts", "stressors", "micro plastics", "climate change", "storm frequency", "increased temperatures"], "type": "cluster", "node_size": 45, "label": "Environmental Stressors"}, "Invasive Species Impact": {"concepts": "species richness, invading species, harmful organisms, invasive species", "concept_list": ["species richness", "invading species", "harmful organisms", "invasive species"], "type": "cluster", "node_size": 27, "label": "Invasive Species Impact"}, "Coastal Resource Management": {"concepts": "science, cultural concern, cultural interests, transmission cable, advisory council, potential actions, policymakers, keystone species, software, positive relationship, mpas, indigenous population, research management, hotspots, upwelling, resource management, management approaches, decision making, climate, biogeographic break, human use, commercial interest, area-based tools, regulations, observation network, species lists, renewable energy, mental model, communicating science, local tribe, military, temperature, semi quantitative, system, key concepts, system components, mental modeling, management decisions, conservation, stakeholders, no take areas, conservation concern, area based management, place-based management, cold spots, wind farm, management, commercial interests, education", "concept_list": ["science", "cultural concern", "cultural interests", "transmission cable", "advisory council", "potential actions", "policymakers", "keystone species", "software", "positive relationship", "mpas", "indigenous population", "research management", "hotspots", "upwelling", "resource management", "management approaches", "decision making", "climate", "biogeographic break", "human use", "commercial interest", "area-based tools", "regulations", "observation network", "species lists", "renewable energy", "mental model", "communicating science", "local tribe", "military", "temperature", "semi quantitative", "system", "key concepts", "system components", "mental modeling", "management decisions", "conservation", "stakeholders", "no take areas", "conservation concern", "area based management", "place-based management", "cold spots", "wind farm", "management", "commercial interests", "education"], "type": "cluster", "node_size": 162, "label": "Coastal Resource Management"}, "Kelp Forest Habitat": {"concepts": "habitat forming species, habitat species, carbon sequestration, kelp forests, habitat", "concept_list": ["habitat forming species", "habitat species", "carbon sequestration", "kelp forests", "habitat"], "type": "cluster", "node_size": 30, "label": "Kelp Forest Habitat"}, "Ecosystem & Habitat": {"concepts": "ecosystem management, ecosystem services, habitat use", "concept_list": ["ecosystem management", "ecosystem services", "habitat use"], "type": "cluster", "node_size": 24, "label": "Ecosystem & Habitat"}, "Recreational Interests": {"concepts": "recreational interests, recreational opportunities, recreational interest", "concept_list": ["recreational interests", "recreational opportunities", "recreational interest"], "type": "cluster", "node_size": 24, "label": "Recreational Interests"}};
        const conceptData = {"marine sanctuary": {"concepts": "marine sanctuary", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine sanctuary"}, "marine protected area": {"concepts": "marine protected area", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine protected area"}, "marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine resource management"}, "marine science": {"concepts": "marine science", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine science"}, "seafloor mapping": {"concepts": "seafloor mapping", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "seafloor mapping"}, "oceanographic habitats": {"concepts": "oceanographic habitats", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "oceanographic habitats"}, "marine biodiversity": {"concepts": "marine biodiversity", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine biodiversity"}, "deep sea corals": {"concepts": "deep sea corals", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "deep sea corals"}, "fishing communities": {"concepts": "fishing communities", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishing communities"}, "fishery": {"concepts": "fishery", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishery"}, "fishing industry": {"concepts": "fishing industry", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishing industry"}, "fish gear": {"concepts": "fish gear", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fish gear"}, "fishing gear": {"concepts": "fishing gear", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishing gear"}, "shallow water": {"concepts": "shallow water", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "shallow water"}, "oil and gas": {"concepts": "oil and gas", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "oil and gas"}, "gas exploration": {"concepts": "gas exploration", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "gas exploration"}, "shipping lanes": {"concepts": "shipping lanes", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "shipping lanes"}, "shipping industry": {"concepts": "shipping industry", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "shipping industry"}, "ship strikes": {"concepts": "ship strikes", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "ship strikes"}, "marine debris": {"concepts": "marine debris", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "marine debris"}, "harmful algal bloom": {"concepts": "harmful algal bloom", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "harmful algal bloom"}, "coral reefs": {"concepts": "coral reefs", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "coral reefs"}, "cetaceans": {"concepts": "cetaceans", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "cetaceans"}, "whale cetaceans": {"concepts": "whale cetaceans", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "whale cetaceans"}, "deep ocean": {"concepts": "deep ocean", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "deep ocean"}, "ocean acidification": {"concepts": "ocean acidification", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "ocean acidification"}, "benthic disturbance": {"concepts": "benthic disturbance", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "benthic disturbance"}, "benthic habitats": {"concepts": "benthic habitats", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "benthic habitats"}, "plankton": {"concepts": "plankton", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "plankton"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species diversity"}, "threatened species": {"concepts": "threatened species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "threatened species"}, "food web": {"concepts": "food web", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "food web"}, "species range": {"concepts": "species range", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species range"}, "species": {"concepts": "species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species"}, "species evenness": {"concepts": "species evenness", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species evenness"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "biodiversity"}, "biogeography": {"concepts": "biogeography", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "biogeography"}, "diversity components": {"concepts": "diversity components", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "diversity components"}, "shannon diversity": {"concepts": "shannon diversity", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "shannon diversity"}, "at-risk species": {"concepts": "at-risk species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "at-risk species"}, "endangered species": {"concepts": "endangered species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "endangered species"}, "species distribution": {"concepts": "species distribution", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species distribution"}, "biodiversity definition": {"concepts": "biodiversity definition", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "biodiversity definition"}, "microplastics": {"concepts": "microplastics", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "microplastics"}, "noise pollution": {"concepts": "noise pollution", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "noise pollution"}, "negative impact": {"concepts": "negative impact", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "negative impact"}, "hypoxia": {"concepts": "hypoxia", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "hypoxia"}, "negative impacts": {"concepts": "negative impacts", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "negative impacts"}, "stressors": {"concepts": "stressors", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "stressors"}, "micro plastics": {"concepts": "micro plastics", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "micro plastics"}, "climate change": {"concepts": "climate change", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "climate change"}, "storm frequency": {"concepts": "storm frequency", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "storm frequency"}, "increased temperatures": {"concepts": "increased temperatures", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "increased temperatures"}, "species richness": {"concepts": "species richness", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "species richness"}, "invading species": {"concepts": "invading species", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "invading species"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "harmful organisms"}, "invasive species": {"concepts": "invasive species", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "invasive species"}, "science": {"concepts": "science", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "science"}, "cultural concern": {"concepts": "cultural concern", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "cultural concern"}, "cultural interests": {"concepts": "cultural interests", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "cultural interests"}, "transmission cable": {"concepts": "transmission cable", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "transmission cable"}, "advisory council": {"concepts": "advisory council", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "advisory council"}, "potential actions": {"concepts": "potential actions", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "potential actions"}, "policymakers": {"concepts": "policymakers", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "policymakers"}, "keystone species": {"concepts": "keystone species", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "keystone species"}, "software": {"concepts": "software", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "software"}, "positive relationship": {"concepts": "positive relationship", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "positive relationship"}, "mpas": {"concepts": "mpas", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "mpas"}, "indigenous population": {"concepts": "indigenous population", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "indigenous population"}, "research management": {"concepts": "research management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "research management"}, "hotspots": {"concepts": "hotspots", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "hotspots"}, "upwelling": {"concepts": "upwelling", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "upwelling"}, "resource management": {"concepts": "resource management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "resource management"}, "management approaches": {"concepts": "management approaches", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "management approaches"}, "decision making": {"concepts": "decision making", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "decision making"}, "climate": {"concepts": "climate", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "climate"}, "biogeographic break": {"concepts": "biogeographic break", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "biogeographic break"}, "human use": {"concepts": "human use", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "human use"}, "commercial interest": {"concepts": "commercial interest", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "commercial interest"}, "area-based tools": {"concepts": "area-based tools", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "area-based tools"}, "regulations": {"concepts": "regulations", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "regulations"}, "observation network": {"concepts": "observation network", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "observation network"}, "species lists": {"concepts": "species lists", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "species lists"}, "renewable energy": {"concepts": "renewable energy", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "renewable energy"}, "mental model": {"concepts": "mental model", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "mental model"}, "communicating science": {"concepts": "communicating science", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "communicating science"}, "local tribe": {"concepts": "local tribe", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "local tribe"}, "military": {"concepts": "military", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "military"}, "temperature": {"concepts": "temperature", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "temperature"}, "semi quantitative": {"concepts": "semi quantitative", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "semi quantitative"}, "system": {"concepts": "system", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "system"}, "key concepts": {"concepts": "key concepts", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "key concepts"}, "system components": {"concepts": "system components", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "system components"}, "mental modeling": {"concepts": "mental modeling", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "mental modeling"}, "management decisions": {"concepts": "management decisions", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "management decisions"}, "conservation": {"concepts": "conservation", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "conservation"}, "stakeholders": {"concepts": "stakeholders", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "stakeholders"}, "no take areas": {"concepts": "no take areas", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "no take areas"}, "conservation concern": {"concepts": "conservation concern", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "conservation concern"}, "area based management": {"concepts": "area based management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "area based management"}, "place-based management": {"concepts": "place-based management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "place-based management"}, "cold spots": {"concepts": "cold spots", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "cold spots"}, "wind farm": {"concepts": "wind farm", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "wind farm"}, "management": {"concepts": "management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "management"}, "commercial interests": {"concepts": "commercial interests", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "commercial interests"}, "education": {"concepts": "education", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "education"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "habitat forming species"}, "habitat species": {"concepts": "habitat species", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "habitat species"}, "carbon sequestration": {"concepts": "carbon sequestration", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "carbon sequestration"}, "kelp forests": {"concepts": "kelp forests", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "kelp forests"}, "habitat": {"concepts": "habitat", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "habitat"}, "ecosystem management": {"concepts": "ecosystem management", "type": "concept", "cluster": "Ecosystem & Habitat", "node_size": 10, "label": "ecosystem management"}, "ecosystem services": {"concepts": "ecosystem services", "type": "concept", "cluster": "Ecosystem & Habitat", "node_size": 10, "label": "ecosystem services"}, "habitat use": {"concepts": "habitat use", "type": "concept", "cluster": "Ecosystem & Habitat", "node_size": 10, "label": "habitat use"}, "recreational interests": {"concepts": "recreational interests", "type": "concept", "cluster": "Recreational Interests", "node_size": 10, "label": "recreational interests"}, "recreational opportunities": {"concepts": "recreational opportunities", "type": "concept", "cluster": "Recreational Interests", "node_size": 10, "label": "recreational opportunities"}, "recreational interest": {"concepts": "recreational interest", "type": "concept", "cluster": "Recreational Interests", "node_size": 10, "label": "recreational interest"}};
        const interClusterEdges = [["oil exploration", "Marine Threats", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["Fishing Industry", "Species Biodiversity", {"weight": 1.0, "confidence": 0.76, "type": "inter_cluster", "style": "solid"}], ["Fishing Industry", "Coastal Resource Management", {"weight": 1.0, "confidence": 0.7333333333333334, "type": "inter_cluster", "style": "solid"}], ["Maritime Industry", "Environmental Stressors", {"weight": 0.3333333333333333, "confidence": 0.3666666666666667, "type": "inter_cluster", "style": "solid"}], ["Maritime Industry", "Marine Threats", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Maritime Industry", "Fishing Industry", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Ocean Ecosystem Health", "Invasive Species Impact", {"weight": 0.8, "confidence": 0.47000000000000003, "type": "inter_cluster", "style": "solid"}], ["Ocean Ecosystem Health", "Environmental Stressors", {"weight": 1.0, "confidence": 0.5625, "type": "inter_cluster", "style": "solid"}], ["Ocean Ecosystem Health", "Coastal Resource Management", {"weight": -0.2, "confidence": 0.41, "type": "inter_cluster", "style": "solid"}], ["Species Biodiversity", "Recreational Interests", {"weight": 1.0, "confidence": 0.6799999999999999, "type": "inter_cluster", "style": "solid"}], ["Species Biodiversity", "Maritime Industry", {"weight": 1.0, "confidence": 0.45999999999999996, "type": "inter_cluster", "style": "solid"}], ["Species Biodiversity", "Ocean Ecosystem Health", {"weight": -0.6, "confidence": 0.38, "type": "inter_cluster", "style": "solid"}], ["Species Biodiversity", "Marine Threats", {"weight": -1.0, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Environmental Stressors", "Kelp Forest Habitat", {"weight": -1.0, "confidence": 0.8374999999999999, "type": "inter_cluster", "style": "solid"}], ["Environmental Stressors", "Maritime Industry", {"weight": -1.0, "confidence": 0.64, "type": "inter_cluster", "style": "solid"}], ["Environmental Stressors", "Fishing Industry", {"weight": -1.0, "confidence": 0.54, "type": "inter_cluster", "style": "solid"}], ["Environmental Stressors", "Ocean Ecosystem Health", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Environmental Stressors", "Coastal Resource Management", {"weight": -0.75, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["Invasive Species Impact", "Recreational Interests", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Invasive Species Impact", "Fishing Industry", {"weight": -1.0, "confidence": 0.38749999999999996, "type": "inter_cluster", "style": "solid"}], ["Coastal Resource Management", "Fishing Industry", {"weight": 0.8, "confidence": 0.5399999999999999, "type": "inter_cluster", "style": "solid"}], ["Coastal Resource Management", "Environmental Stressors", {"weight": -0.6, "confidence": 0.42000000000000004, "type": "inter_cluster", "style": "solid"}], ["Kelp Forest Habitat", "Recreational Interests", {"weight": 1.0, "confidence": 0.6799999999999999, "type": "inter_cluster", "style": "solid"}], ["Kelp Forest Habitat", "Ecosystem & Habitat", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["Ecosystem & Habitat", "Fishing Industry", {"weight": 1.0, "confidence": 0.77, "type": "inter_cluster", "style": "solid"}], ["Ecosystem & Habitat", "Species Biodiversity", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Ecosystem & Habitat", "Environmental Stressors", {"weight": -1.0, "confidence": 0.4833333333333334, "type": "inter_cluster", "style": "solid"}], ["Ecosystem & Habitat", "oil exploration", {"weight": -1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Recreational Interests", "Maritime Industry", {"weight": 1.0, "confidence": 0.5700000000000001, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Fishing Industry": [["marine sanctuary", {"concepts": "marine sanctuary", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine sanctuary"}], ["marine protected area", {"concepts": "marine protected area", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine protected area"}], ["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine resource management"}], ["marine science", {"concepts": "marine science", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine science"}], ["seafloor mapping", {"concepts": "seafloor mapping", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "seafloor mapping"}], ["oceanographic habitats", {"concepts": "oceanographic habitats", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "oceanographic habitats"}], ["marine biodiversity", {"concepts": "marine biodiversity", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "marine biodiversity"}], ["deep sea corals", {"concepts": "deep sea corals", "type": "concept", "cluster": "Fishing Industry", "node_size": 10, "label": "deep sea corals"}]], "Maritime Industry": [["fishing communities", {"concepts": "fishing communities", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishing communities"}], ["fishery", {"concepts": "fishery", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishery"}], ["fishing industry", {"concepts": "fishing industry", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishing industry"}], ["fish gear", {"concepts": "fish gear", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fish gear"}], ["fishing gear", {"concepts": "fishing gear", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "fishing gear"}], ["shallow water", {"concepts": "shallow water", "type": "concept", "cluster": "Maritime Industry", "node_size": 10, "label": "shallow water"}]], "Marine Threats": [["oil and gas", {"concepts": "oil and gas", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "oil and gas"}], ["gas exploration", {"concepts": "gas exploration", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "gas exploration"}], ["shipping lanes", {"concepts": "shipping lanes", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "shipping lanes"}], ["shipping industry", {"concepts": "shipping industry", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "shipping industry"}], ["ship strikes", {"concepts": "ship strikes", "type": "concept", "cluster": "Marine Threats", "node_size": 10, "label": "ship strikes"}]], "Ocean Ecosystem Health": [["marine debris", {"concepts": "marine debris", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "marine debris"}], ["harmful algal bloom", {"concepts": "harmful algal bloom", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "harmful algal bloom"}], ["coral reefs", {"concepts": "coral reefs", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "coral reefs"}], ["cetaceans", {"concepts": "cetaceans", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "cetaceans"}], ["whale cetaceans", {"concepts": "whale cetaceans", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "whale cetaceans"}], ["deep ocean", {"concepts": "deep ocean", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "deep ocean"}], ["ocean acidification", {"concepts": "ocean acidification", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "ocean acidification"}], ["benthic disturbance", {"concepts": "benthic disturbance", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "benthic disturbance"}], ["benthic habitats", {"concepts": "benthic habitats", "type": "concept", "cluster": "Ocean Ecosystem Health", "node_size": 10, "label": "benthic habitats"}]], "Species Biodiversity": [["plankton", {"concepts": "plankton", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "plankton"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species diversity"}], ["threatened species", {"concepts": "threatened species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "threatened species"}], ["food web", {"concepts": "food web", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "food web"}], ["species range", {"concepts": "species range", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species range"}], ["species", {"concepts": "species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species"}], ["species evenness", {"concepts": "species evenness", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species evenness"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "biodiversity"}], ["biogeography", {"concepts": "biogeography", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "biogeography"}], ["diversity components", {"concepts": "diversity components", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "diversity components"}], ["shannon diversity", {"concepts": "shannon diversity", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "shannon diversity"}], ["at-risk species", {"concepts": "at-risk species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "at-risk species"}], ["endangered species", {"concepts": "endangered species", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "endangered species"}], ["species distribution", {"concepts": "species distribution", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "species distribution"}], ["biodiversity definition", {"concepts": "biodiversity definition", "type": "concept", "cluster": "Species Biodiversity", "node_size": 10, "label": "biodiversity definition"}]], "Environmental Stressors": [["microplastics", {"concepts": "microplastics", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "microplastics"}], ["noise pollution", {"concepts": "noise pollution", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "noise pollution"}], ["negative impact", {"concepts": "negative impact", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "negative impact"}], ["hypoxia", {"concepts": "hypoxia", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "hypoxia"}], ["negative impacts", {"concepts": "negative impacts", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "negative impacts"}], ["stressors", {"concepts": "stressors", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "stressors"}], ["micro plastics", {"concepts": "micro plastics", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "micro plastics"}], ["climate change", {"concepts": "climate change", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "climate change"}], ["storm frequency", {"concepts": "storm frequency", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "storm frequency"}], ["increased temperatures", {"concepts": "increased temperatures", "type": "concept", "cluster": "Environmental Stressors", "node_size": 10, "label": "increased temperatures"}]], "Invasive Species Impact": [["species richness", {"concepts": "species richness", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "species richness"}], ["invading species", {"concepts": "invading species", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "invading species"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "harmful organisms"}], ["invasive species", {"concepts": "invasive species", "type": "concept", "cluster": "Invasive Species Impact", "node_size": 10, "label": "invasive species"}]], "Coastal Resource Management": [["science", {"concepts": "science", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "science"}], ["cultural concern", {"concepts": "cultural concern", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "cultural concern"}], ["cultural interests", {"concepts": "cultural interests", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "cultural interests"}], ["transmission cable", {"concepts": "transmission cable", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "transmission cable"}], ["advisory council", {"concepts": "advisory council", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "advisory council"}], ["potential actions", {"concepts": "potential actions", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "potential actions"}], ["policymakers", {"concepts": "policymakers", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "policymakers"}], ["keystone species", {"concepts": "keystone species", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "keystone species"}], ["software", {"concepts": "software", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "software"}], ["positive relationship", {"concepts": "positive relationship", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "positive relationship"}], ["mpas", {"concepts": "mpas", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "mpas"}], ["indigenous population", {"concepts": "indigenous population", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "indigenous population"}], ["research management", {"concepts": "research management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "research management"}], ["hotspots", {"concepts": "hotspots", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "hotspots"}], ["upwelling", {"concepts": "upwelling", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "upwelling"}], ["resource management", {"concepts": "resource management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "resource management"}], ["management approaches", {"concepts": "management approaches", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "management approaches"}], ["decision making", {"concepts": "decision making", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "decision making"}], ["climate", {"concepts": "climate", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "climate"}], ["biogeographic break", {"concepts": "biogeographic break", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "biogeographic break"}], ["human use", {"concepts": "human use", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "human use"}], ["commercial interest", {"concepts": "commercial interest", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "commercial interest"}], ["area-based tools", {"concepts": "area-based tools", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "area-based tools"}], ["regulations", {"concepts": "regulations", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "regulations"}], ["observation network", {"concepts": "observation network", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "observation network"}], ["species lists", {"concepts": "species lists", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "species lists"}], ["renewable energy", {"concepts": "renewable energy", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "renewable energy"}], ["mental model", {"concepts": "mental model", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "mental model"}], ["communicating science", {"concepts": "communicating science", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "communicating science"}], ["local tribe", {"concepts": "local tribe", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "local tribe"}], ["military", {"concepts": "military", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "military"}], ["temperature", {"concepts": "temperature", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "temperature"}], ["semi quantitative", {"concepts": "semi quantitative", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "semi quantitative"}], ["system", {"concepts": "system", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "system"}], ["key concepts", {"concepts": "key concepts", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "key concepts"}], ["system components", {"concepts": "system components", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "system components"}], ["mental modeling", {"concepts": "mental modeling", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "mental modeling"}], ["management decisions", {"concepts": "management decisions", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "management decisions"}], ["conservation", {"concepts": "conservation", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "conservation"}], ["stakeholders", {"concepts": "stakeholders", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "stakeholders"}], ["no take areas", {"concepts": "no take areas", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "no take areas"}], ["conservation concern", {"concepts": "conservation concern", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "conservation concern"}], ["area based management", {"concepts": "area based management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "area based management"}], ["place-based management", {"concepts": "place-based management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "place-based management"}], ["cold spots", {"concepts": "cold spots", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "cold spots"}], ["wind farm", {"concepts": "wind farm", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "wind farm"}], ["management", {"concepts": "management", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "management"}], ["commercial interests", {"concepts": "commercial interests", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "commercial interests"}], ["education", {"concepts": "education", "type": "concept", "cluster": "Coastal Resource Management", "node_size": 10, "label": "education"}]], "Kelp Forest Habitat": [["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "habitat forming species"}], ["habitat species", {"concepts": "habitat species", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "habitat species"}], ["carbon sequestration", {"concepts": "carbon sequestration", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "carbon sequestration"}], ["kelp forests", {"concepts": "kelp forests", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "kelp forests"}], ["habitat", {"concepts": "habitat", "type": "concept", "cluster": "Kelp Forest Habitat", "node_size": 10, "label": "habitat"}]], "Ecosystem & Habitat": [["ecosystem management", {"concepts": "ecosystem management", "type": "concept", "cluster": "Ecosystem & Habitat", "node_size": 10, "label": "ecosystem management"}], ["ecosystem services", {"concepts": "ecosystem services", "type": "concept", "cluster": "Ecosystem & Habitat", "node_size": 10, "label": "ecosystem services"}], ["habitat use", {"concepts": "habitat use", "type": "concept", "cluster": "Ecosystem & Habitat", "node_size": 10, "label": "habitat use"}]], "Recreational Interests": [["recreational interests", {"concepts": "recreational interests", "type": "concept", "cluster": "Recreational Interests", "node_size": 10, "label": "recreational interests"}], ["recreational opportunities", {"concepts": "recreational opportunities", "type": "concept", "cluster": "Recreational Interests", "node_size": 10, "label": "recreational opportunities"}], ["recreational interest", {"concepts": "recreational interest", "type": "concept", "cluster": "Recreational Interests", "node_size": 10, "label": "recreational interest"}]]};
        const clusterEdges = {"Fishing Industry": [], "Maritime Industry": [], "Marine Threats": [], "Ocean Ecosystem Health": [], "Species Biodiversity": [], "Environmental Stressors": [], "Invasive Species Impact": [], "Coastal Resource Management": [], "Kelp Forest Habitat": [], "Ecosystem & Habitat": [], "Recreational Interests": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

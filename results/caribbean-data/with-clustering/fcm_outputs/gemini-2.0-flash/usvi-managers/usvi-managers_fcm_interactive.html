
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"license limits": {"concepts": "license limits", "concept_list": ["license limits"], "type": "cluster", "node_size": 18, "label": "license limits"}, "fish buoys": {"concepts": "fish buoys", "concept_list": ["fish buoys"], "type": "cluster", "node_size": 18, "label": "fish buoys"}, "local vs federal": {"concepts": "local vs federal", "concept_list": ["local vs federal"], "type": "cluster", "node_size": 18, "label": "local vs federal"}, "recreational fisheries": {"concepts": "recreational fisheries", "concept_list": ["recreational fisheries"], "type": "cluster", "node_size": 18, "label": "recreational fisheries"}, "trip tickets": {"concepts": "trip tickets", "concept_list": ["trip tickets"], "type": "cluster", "node_size": 18, "label": "trip tickets"}, "restaurants": {"concepts": "restaurants", "concept_list": ["restaurants"], "type": "cluster", "node_size": 18, "label": "restaurants"}, "advocacy": {"concepts": "advocacy", "concept_list": ["advocacy"], "type": "cluster", "node_size": 18, "label": "advocacy"}, "dangerous conditions": {"concepts": "dangerous conditions, contingency plan", "concept_list": ["dangerous conditions", "contingency plan"], "type": "cluster", "node_size": 21, "label": "dangerous conditions"}, "environmental sciences": {"concepts": "environmental sciences", "concept_list": ["environmental sciences"], "type": "cluster", "node_size": 18, "label": "environmental sciences"}, "fishermen conflicts": {"concepts": "fishermen conflicts, fisher cooperation", "concept_list": ["fishermen conflicts", "fisher cooperation"], "type": "cluster", "node_size": 21, "label": "fishermen conflicts"}, "hurricane assessments": {"concepts": "hurricane assessments, hurricanes, hurricane recovery, hurricane recovery act, hurricane impact", "concept_list": ["hurricane assessments", "hurricanes", "hurricane recovery", "hurricane recovery act", "hurricane impact"], "type": "cluster", "node_size": 30, "label": "hurricane assessments"}, "data models": {"concepts": "data models, data justification, data deficient, data sheet", "concept_list": ["data models", "data justification", "data deficient", "data sheet"], "type": "cluster", "node_size": 27, "label": "data models"}, "decline fishers": {"concepts": "decline fishers", "concept_list": ["decline fishers"], "type": "cluster", "node_size": 18, "label": "decline fishers"}, "commercial fisheries": {"concepts": "commercial fisheries, net fishery", "concept_list": ["commercial fisheries", "net fishery"], "type": "cluster", "node_size": 21, "label": "commercial fisheries"}, "equipment use": {"concepts": "equipment use", "concept_list": ["equipment use"], "type": "cluster", "node_size": 18, "label": "equipment use"}, "water-based activities": {"concepts": "water-based activities", "concept_list": ["water-based activities"], "type": "cluster", "node_size": 18, "label": "water-based activities"}, "trap reduction": {"concepts": "trap reduction", "concept_list": ["trap reduction"], "type": "cluster", "node_size": 18, "label": "trap reduction"}, "silt": {"concepts": "silt, personal issues, major problems, ongoing issues, refinery, wahoo, alexis, puerto rico, st. thomas, st. croix, red tape, check and balance, catch reports, alumina plant, mesh size, us virgin islands, spawning closure, certified diver, unified group, unity, first preferences, snorkeling", "concept_list": ["silt", "personal issues", "major problems", "ongoing issues", "refinery", "wahoo", "alexis", "puerto rico", "st. thomas", "st. croix", "red tape", "check and balance", "catch reports", "alumina plant", "mesh size", "us virgin islands", "spawning closure", "certified diver", "unified group", "unity", "first preferences", "snorkeling"], "type": "cluster", "node_size": 81, "label": "silt"}, "island-based management": {"concepts": "island-based management, resource aggregation, resource protection, resource management, resource preservation, power dynamics, power structures", "concept_list": ["island-based management", "resource aggregation", "resource protection", "resource management", "resource preservation", "power dynamics", "power structures"], "type": "cluster", "node_size": 36, "label": "island-based management"}, "coastal zone management": {"concepts": "coastal zone management, coastal communities, coastal development, mango lagoon, coastal ponds, mangrove ecosystems, mangrove estuary", "concept_list": ["coastal zone management", "coastal communities", "coastal development", "mango lagoon", "coastal ponds", "mangrove ecosystems", "mangrove estuary"], "type": "cluster", "node_size": 36, "label": "coastal zone management"}, "violent conflicts": {"concepts": "violent conflicts, public conflict, social dynamics, social interaction, social circle, u.s. military, family dynamics, youth behavior, social events, social sphere", "concept_list": ["violent conflicts", "public conflict", "social dynamics", "social interaction", "social circle", "u.s. military", "family dynamics", "youth behavior", "social events", "social sphere"], "type": "cluster", "node_size": 45, "label": "violent conflicts"}, "Meeting Administration": {"concepts": "thomas, tissue loss", "concept_list": ["thomas", "tissue loss"], "type": "cluster", "node_size": 21, "label": "Meeting Administration"}, "Unfairness & Distrust": {"concepts": "commercial fisherman, diving fishery, dive fishery, line fishermen", "concept_list": ["commercial fisherman", "diving fishery", "dive fishery", "line fishermen"], "type": "cluster", "node_size": 27, "label": "Unfairness & Distrust"}, "Fishing Activities": {"concepts": "ice, diving, foreign vessels", "concept_list": ["ice", "diving", "foreign vessels"], "type": "cluster", "node_size": 24, "label": "Fishing Activities"}, "Federal Grants": {"concepts": "federal funding, grant money, federal laws, federal government, federal agencies, federal level", "concept_list": ["federal funding", "grant money", "federal laws", "federal government", "federal agencies", "federal level"], "type": "cluster", "node_size": 33, "label": "Federal Grants"}, "Statistical Professionals": {"concepts": "statistician, statisticians, bio statistical unit, judges, department commissioner, commissioner, town hall meetings, annual meetings, chairperson, annual registration", "concept_list": ["statistician", "statisticians", "bio statistical unit", "judges", "department commissioner", "commissioner", "town hall meetings", "annual meetings", "chairperson", "annual registration"], "type": "cluster", "node_size": 45, "label": "Statistical Professionals"}, "Building Trust": {"concepts": "honest communication, misinformation, trust, trust building, perceived unfairness, distrust", "concept_list": ["honest communication", "misinformation", "trust", "trust building", "perceived unfairness", "distrust"], "type": "cluster", "node_size": 33, "label": "Building Trust"}, "Community Engagement": {"concepts": "outreach events, participatory process", "concept_list": ["outreach events", "participatory process"], "type": "cluster", "node_size": 21, "label": "Community Engagement"}, "License Types": {"concepts": "commercial license, business license, voluntary licenses, mandatory licenses, licensing, license sharing, license transfer, license availability", "concept_list": ["commercial license", "business license", "voluntary licenses", "mandatory licenses", "licensing", "license sharing", "license transfer", "license availability"], "type": "cluster", "node_size": 39, "label": "License Types"}, "Regulatory Licensing": {"concepts": "regulatory compliance, licensing program", "concept_list": ["regulatory compliance", "licensing program"], "type": "cluster", "node_size": 21, "label": "Regulatory Licensing"}, "Trap Fishing": {"concepts": "trap fishing, trap fishery, traps, trammel nets, gill nets", "concept_list": ["trap fishing", "trap fishery", "traps", "trammel nets", "gill nets"], "type": "cluster", "node_size": 30, "label": "Trap Fishing"}, "Trap Management": {"concepts": "fish trap reduction, fish trap management", "concept_list": ["fish trap reduction", "fish trap management"], "type": "cluster", "node_size": 21, "label": "Trap Management"}, "Recreational Fishing": {"concepts": "recreational fishers, recreational fishery, recreational fishery regulation", "concept_list": ["recreational fishers", "recreational fishery", "recreational fishery regulation"], "type": "cluster", "node_size": 24, "label": "Recreational Fishing"}, "Ecosystem Health": {"concepts": "ecosystem, overfishing, rising temperatures, bleaching events, extinction, climate change, carbon footprint, reproducing populations, tissue loss disease, climate change awareness, migration patterns, migratory species, ecosystem-based fisheries, ecosystem services, sea turtle habitat, climate resiliency, sunscreens", "concept_list": ["ecosystem", "overfishing", "rising temperatures", "bleaching events", "extinction", "climate change", "carbon footprint", "reproducing populations", "tissue loss disease", "climate change awareness", "migration patterns", "migratory species", "ecosystem-based fisheries", "ecosystem services", "sea turtle habitat", "climate resiliency", "sunscreens"], "type": "cluster", "node_size": 66, "label": "Ecosystem Health"}, "Fisheries Management": {"concepts": "fishery management, fisheries management, fisheries", "concept_list": ["fishery management", "fisheries management", "fisheries"], "type": "cluster", "node_size": 24, "label": "Fisheries Management"}, "Fishing Traps & Impacts": {"concepts": "generational factors, size restrictions, organizational structures, weight limitations, fishing traps, fish traps, by-catch, trap reductions, pelagic species, tuna, organizational dynamics, social gatherings", "concept_list": ["generational factors", "size restrictions", "organizational structures", "weight limitations", "fishing traps", "fish traps", "by-catch", "trap reductions", "pelagic species", "tuna", "organizational dynamics", "social gatherings"], "type": "cluster", "node_size": 51, "label": "Fishing Traps & Impacts"}, "Recreational Fisheries Management": {"concepts": "wildlife fisheries, king mackerel tournament, recreational licensing, fishers relationship, stock assessment, wildlife biologist, wildlife outreach, fish and wildlife", "concept_list": ["wildlife fisheries", "king mackerel tournament", "recreational licensing", "fishers relationship", "stock assessment", "wildlife biologist", "wildlife outreach", "fish and wildlife"], "type": "cluster", "node_size": 39, "label": "Recreational Fisheries Management"}, "Parrotfish Herbivores": {"concepts": "parrotfish, parrot fish, herbivorous fishes", "concept_list": ["parrotfish", "parrot fish", "herbivorous fishes"], "type": "cluster", "node_size": 24, "label": "Parrotfish Herbivores"}, "Aquatic Food Web": {"concepts": "algae growth, bait fish populations, fish populations", "concept_list": ["algae growth", "bait fish populations", "fish populations"], "type": "cluster", "node_size": 24, "label": "Aquatic Food Web"}, "Fish and Seafood": {"concepts": "sea urchin, division of fish, fresh fish", "concept_list": ["sea urchin", "division of fish", "fresh fish"], "type": "cluster", "node_size": 24, "label": "Fish and Seafood"}, "Justice System": {"concepts": "courts, law enforcement", "concept_list": ["courts", "law enforcement"], "type": "cluster", "node_size": 21, "label": "Justice System"}, "Enforcement Challenges": {"concepts": "illegal activity, enforcement problem, enforcement, enforcement funding, enforcement practices, environmental enforcement, enforcement officers", "concept_list": ["illegal activity", "enforcement problem", "enforcement", "enforcement funding", "enforcement practices", "environmental enforcement", "enforcement officers"], "type": "cluster", "node_size": 36, "label": "Enforcement Challenges"}, "Fishing Community": {"concepts": "fishing communities, fishing families, fishing community, fishing tournaments, shoreline fishing, responsible fishing, fishing gear, marine industry, fishing industry, fishing grounds, fishing effort, fishing quotas, fishing rules, fishing license, fishing policies, fishing licenses, fishing partners, fishing die off, fishing activities, fishing regulations, charter anglers, charter fishing, charter people", "concept_list": ["fishing communities", "fishing families", "fishing community", "fishing tournaments", "shoreline fishing", "responsible fishing", "fishing gear", "marine industry", "fishing industry", "fishing grounds", "fishing effort", "fishing quotas", "fishing rules", "fishing license", "fishing policies", "fishing licenses", "fishing partners", "fishing die off", "fishing activities", "fishing regulations", "charter anglers", "charter fishing", "charter people"], "type": "cluster", "node_size": 84, "label": "Fishing Community"}, "Coral Health": {"concepts": "coral destruction, live corals, coral population, reef fish, coral reefs, reef condition, reefs changing, public reefs", "concept_list": ["coral destruction", "live corals", "coral population", "reef fish", "coral reefs", "reef condition", "reefs changing", "public reefs"], "type": "cluster", "node_size": 39, "label": "Coral Health"}, "Coral Reef Threats": {"concepts": "coral loss, sargassum seaweed, coral diseases, coral tissue loss, coral disease, stony coral tissue loss, coral bleaching", "concept_list": ["coral loss", "sargassum seaweed", "coral diseases", "coral tissue loss", "coral disease", "stony coral tissue loss", "coral bleaching"], "type": "cluster", "node_size": 36, "label": "Coral Reef Threats"}, "Collaborative Science Network": {"concepts": "scientific cooperation, nonprofit organizations, information sharing, collaboration, respect, key players", "concept_list": ["scientific cooperation", "nonprofit organizations", "information sharing", "collaboration", "respect", "key players"], "type": "cluster", "node_size": 33, "label": "Collaborative Science Network"}, "Relationship Conflict": {"concepts": "adversarial relationships, envy, association feuds, loopholes, over exploitation", "concept_list": ["adversarial relationships", "envy", "association feuds", "loopholes", "over exploitation"], "type": "cluster", "node_size": 30, "label": "Relationship Conflict"}, "Information Partnerships": {"concepts": "partnership, information access", "concept_list": ["partnership", "information access"], "type": "cluster", "node_size": 21, "label": "Information Partnerships"}, "Harbor Resources Conflict": {"concepts": "free benefits, adversarial relationship, christiansted harbor, resources", "concept_list": ["free benefits", "adversarial relationship", "christiansted harbor", "resources"], "type": "cluster", "node_size": 27, "label": "Harbor Resources Conflict"}, "Federal Management": {"concepts": "federal managers, federal branch, federal management, federal personnel", "concept_list": ["federal managers", "federal branch", "federal management", "federal personnel"], "type": "cluster", "node_size": 27, "label": "Federal Management"}, "Ecotourism & Charters": {"concepts": "ecotourism industry, recreational charters, tournaments, tourism-based, tourist industry, tourism, tourism dependence", "concept_list": ["ecotourism industry", "recreational charters", "tournaments", "tourism-based", "tourist industry", "tourism", "tourism dependence"], "type": "cluster", "node_size": 36, "label": "Ecotourism & Charters"}, "Local Focus": {"concepts": "local consumption, local hire, local level, local actions, local branch, local community, local displacement, local people, local knowledge, localized decisions, nursery grounds, national park service, local specialists, moving parts", "concept_list": ["local consumption", "local hire", "local level", "local actions", "local branch", "local community", "local displacement", "local people", "local knowledge", "localized decisions", "nursery grounds", "national park service", "local specialists", "moving parts"], "type": "cluster", "node_size": 57, "label": "Local Focus"}, "Ecosystem Decline": {"concepts": "habitat destruction, species decline, species limitation, invasive sea grass", "concept_list": ["habitat destruction", "species decline", "species limitation", "invasive sea grass"], "type": "cluster", "node_size": 27, "label": "Ecosystem Decline"}, "Agricultural Conservation": {"concepts": "department of agriculture, conservation success, conservation focus, conservation-focused, nursery habitat, protected areas", "concept_list": ["department of agriculture", "conservation success", "conservation focus", "conservation-focused", "nursery habitat", "protected areas"], "type": "cluster", "node_size": 33, "label": "Agricultural Conservation"}, "Land & Species": {"concepts": "landed species, land development, endangered species, ecosystem management, habitat support", "concept_list": ["landed species", "land development", "endangered species", "ecosystem management", "habitat support"], "type": "cluster", "node_size": 30, "label": "Land & Species"}, "Rules & Regulations": {"concepts": "rules, rules and regulations, regulations", "concept_list": ["rules", "rules and regulations", "regulations"], "type": "cluster", "node_size": 24, "label": "Rules & Regulations"}, "Regulation Types": {"concepts": "compatible regulation, federal regulations, local regulations, new regulations", "concept_list": ["compatible regulation", "federal regulations", "local regulations", "new regulations"], "type": "cluster", "node_size": 27, "label": "Regulation Types"}, "Permit Regulations": {"concepts": "regulatory process, permits", "concept_list": ["regulatory process", "permits"], "type": "cluster", "node_size": 21, "label": "Permit Regulations"}, "Government Initiatives": {"concepts": "government planning, government program, government, government support, local government, state government, politicians, government representatives, political appointees, territorial committees, government meetings, policy implementation, government regulation, overpopulated countries, political action, lobsters, government contact", "concept_list": ["government planning", "government program", "government", "government support", "local government", "state government", "politicians", "government representatives", "political appointees", "territorial committees", "government meetings", "policy implementation", "government regulation", "overpopulated countries", "political action", "lobsters", "government contact"], "type": "cluster", "node_size": 66, "label": "Government Initiatives"}, "Government Distrust": {"concepts": "government distrust, government mistrust, government control, government failure", "concept_list": ["government distrust", "government mistrust", "government control", "government failure"], "type": "cluster", "node_size": 27, "label": "Government Distrust"}, "Environmental Professionals": {"concepts": "environmental stewards, environmental managers, environmental specialists", "concept_list": ["environmental stewards", "environmental managers", "environmental specialists"], "type": "cluster", "node_size": 24, "label": "Environmental Professionals"}, "Human Pollution": {"concepts": "pollution, human impacts", "concept_list": ["pollution", "human impacts"], "type": "cluster", "node_size": 21, "label": "Human Pollution"}, "Fish Landings": {"concepts": "landings data, species landings, landings", "concept_list": ["landings data", "species landings", "landings"], "type": "cluster", "node_size": 24, "label": "Fish Landings"}, "Fishery Problems": {"concepts": "fishery impacts, fisheries issues, local fishers, fisheries data", "concept_list": ["fishery impacts", "fisheries issues", "local fishers", "fisheries data"], "type": "cluster", "node_size": 27, "label": "Fishery Problems"}, "Fisher Conflicts": {"concepts": "fisher conflicts, fishermen conflict, fisher conflict", "concept_list": ["fisher conflicts", "fishermen conflict", "fisher conflict"], "type": "cluster", "node_size": 24, "label": "Fisher Conflicts"}, "Fishery Disaster Aid": {"concepts": "fishery disaster aid, fishery disaster, disaster funding, disaster aid", "concept_list": ["fishery disaster aid", "fishery disaster", "disaster funding", "disaster aid"], "type": "cluster", "node_size": 27, "label": "Fishery Disaster Aid"}, "Co-op Structure": {"concepts": "co-op, 501(3)(c) status, buy-back program, labor-intensive, part-time basis", "concept_list": ["co-op", "501(3)(c) status", "buy-back program", "labor-intensive", "part-time basis"], "type": "cluster", "node_size": 30, "label": "Co-op Structure"}, "No-Take Decisions": {"concepts": "no-take bill, decision-making", "concept_list": ["no-take bill", "decision-making"], "type": "cluster", "node_size": 21, "label": "No-Take Decisions"}, "Market Access": {"concepts": "market access, market", "concept_list": ["market access", "market"], "type": "cluster", "node_size": 21, "label": "Market Access"}, "Economic Considerations": {"concepts": "economic factors, socioeconomics, economic investment", "concept_list": ["economic factors", "socioeconomics", "economic investment"], "type": "cluster", "node_size": 24, "label": "Economic Considerations"}, "Price Influences": {"concepts": "price control, price fixing, taxes, consumer affairs", "concept_list": ["price control", "price fixing", "taxes", "consumer affairs"], "type": "cluster", "node_size": 27, "label": "Price Influences"}, "Data Collection Planning": {"concepts": "data gaps, data collection, spend plan, random sampling", "concept_list": ["data gaps", "data collection", "spend plan", "random sampling"], "type": "cluster", "node_size": 27, "label": "Data Collection Planning"}, "Declining Fisheries": {"concepts": "fishery, fishery recovery, fishers decline", "concept_list": ["fishery", "fishery recovery", "fishers decline"], "type": "cluster", "node_size": 24, "label": "Declining Fisheries"}, "Storm Events": {"concepts": "weather changes, storms, storm events, weather vs climate, climate data", "concept_list": ["weather changes", "storms", "storm events", "weather vs climate", "climate data"], "type": "cluster", "node_size": 30, "label": "Storm Events"}, "Environmental Change": {"concepts": "climate change guru, environmental changes, climate changes, temperature change, weather, climate, seasonality", "concept_list": ["climate change guru", "environmental changes", "climate changes", "temperature change", "weather", "climate", "seasonality"], "type": "cluster", "node_size": 36, "label": "Environmental Change"}, "Gear Basics": {"concepts": "gear, gear types, gear costs, longline gear", "concept_list": ["gear", "gear types", "gear costs", "longline gear"], "type": "cluster", "node_size": 27, "label": "Gear Basics"}, "Island Communities": {"concepts": "older community, island communities", "concept_list": ["older community", "island communities"], "type": "cluster", "node_size": 21, "label": "Island Communities"}, "Public Forums": {"concepts": "public forums, community uproar, forums, quotas, cultural norm, community, community displacement, community access, participation, community dynamics, community norms, community dependence", "concept_list": ["public forums", "community uproar", "forums", "quotas", "cultural norm", "community", "community displacement", "community access", "participation", "community dynamics", "community norms", "community dependence"], "type": "cluster", "node_size": 51, "label": "Public Forums"}, "Runoff & Degradation": {"concepts": "runoff, land-based runoff, runoff pollution, sewage, rum effluent, sewage dumping, environmental degradation, watersheds degradation, water quality", "concept_list": ["runoff", "land-based runoff", "runoff pollution", "sewage", "rum effluent", "sewage dumping", "environmental degradation", "watersheds degradation", "water quality"], "type": "cluster", "node_size": 42, "label": "Runoff & Degradation"}, "Water Resources": {"concepts": "fishable waters, groundwater resources, water temperatures, water clarity, water temperature, ocean temperature, ocean water, ocean floor, federal waters, ocean debris, protecting ocean, protected waters", "concept_list": ["fishable waters", "groundwater resources", "water temperatures", "water clarity", "water temperature", "ocean temperature", "ocean water", "ocean floor", "federal waters", "ocean debris", "protecting ocean", "protected waters"], "type": "cluster", "node_size": 51, "label": "Water Resources"}, "Port Sampling & Representation": {"concepts": "port sample, port sampling, fisher representation, fisher tracker devices", "concept_list": ["port sample", "port sampling", "fisher representation", "fisher tracker devices"], "type": "cluster", "node_size": 27, "label": "Port Sampling & Representation"}, "Decision Making": {"concepts": "decision makers, decision clarity, decision making, decision fairness, fairness perceptions, participatory fairness, fairness", "concept_list": ["decision makers", "decision clarity", "decision making", "decision fairness", "fairness perceptions", "participatory fairness", "fairness"], "type": "cluster", "node_size": 36, "label": "Decision Making"}, "Fishermen Participation": {"concepts": "active fishermen, fishermen meetings, fishermen participation, fishermen's association, fishermen association, fishermen involvement, younger fishermen, fishermen, fishermen education, older fishermen, licensed fishermen, aging fishermen", "concept_list": ["active fishermen", "fishermen meetings", "fishermen participation", "fishermen's association", "fishermen association", "fishermen involvement", "younger fishermen", "fishermen", "fishermen education", "older fishermen", "licensed fishermen", "aging fishermen"], "type": "cluster", "node_size": 51, "label": "Fishermen Participation"}, "Fishermen Concerns": {"concepts": "fishermen struggles, fishermen concerns, fisherman livelihood, fisher livelihood, fishermen livelihood, fisher understanding, fishermen perception", "concept_list": ["fishermen struggles", "fishermen concerns", "fisherman livelihood", "fisher livelihood", "fishermen livelihood", "fisher understanding", "fishermen perception"], "type": "cluster", "node_size": 36, "label": "Fishermen Concerns"}, "NOAA Acronym": {"concepts": "noah, noaa", "concept_list": ["noah", "noaa"], "type": "cluster", "node_size": 21, "label": "NOAA Acronym"}, "Management Planning": {"concepts": "management plans, management program, management plan, management process, management decisions, management involvement, upper management, state level, bottom up", "concept_list": ["management plans", "management program", "management plan", "management process", "management decisions", "management involvement", "upper management", "state level", "bottom up"], "type": "cluster", "node_size": 42, "label": "Management Planning"}, "Fishing Impacts": {"concepts": "anchor damage, bag limits", "concept_list": ["anchor damage", "bag limits"], "type": "cluster", "node_size": 21, "label": "Fishing Impacts"}, "Conflict Management": {"concepts": "conflict resolution, informal conflict, internal conflict, negotiation, conflict, conflicts, informal resolution, compromise, discussion, communication", "concept_list": ["conflict resolution", "informal conflict", "internal conflict", "negotiation", "conflict", "conflicts", "informal resolution", "compromise", "discussion", "communication"], "type": "cluster", "node_size": 45, "label": "Conflict Management"}, "Advice Groups": {"concepts": "constructive advice, working groups, diverse committee, committee diversity, advisory committees, advisory committee, district advisory panel, advisory panel, advisory panels, general attitude, criticism, increased effort, wellbeing, strong personality, attitudes, personality", "concept_list": ["constructive advice", "working groups", "diverse committee", "committee diversity", "advisory committees", "advisory committee", "district advisory panel", "advisory panel", "advisory panels", "general attitude", "criticism", "increased effort", "wellbeing", "strong personality", "attitudes", "personality"], "type": "cluster", "node_size": 63, "label": "Advice Groups"}, "Education Levels": {"concepts": "education gap, educational attainment, education, breeding schools, education division, and educational practices:, educational practices:, climate change education, computer literacy", "concept_list": ["education gap", "educational attainment", "education", "breeding schools", "education division", "and educational practices:", "educational practices:", "climate change education", "computer literacy"], "type": "cluster", "node_size": 42, "label": "Education Levels"}, "Marine Ecology": {"concepts": "benthic community, marine ecology, pelagic fish, yellowtail snapper, lionfish, mysid shrimp", "concept_list": ["benthic community", "marine ecology", "pelagic fish", "yellowtail snapper", "lionfish", "mysid shrimp"], "type": "cluster", "node_size": 33, "label": "Marine Ecology"}, "Legislative Body": {"concepts": "legislators, legislator, legislature, senate testimony", "concept_list": ["legislators", "legislator", "legislature", "senate testimony"], "type": "cluster", "node_size": 27, "label": "Legislative Body"}, "Legislative Decisions": {"concepts": "legislative decisions, legislative decision", "concept_list": ["legislative decisions", "legislative decision"], "type": "cluster", "node_size": 21, "label": "Legislative Decisions"}};
        const conceptData = {};
        const interClusterEdges = [["license limits", "trap reduction", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["fish buoys", "water-based activities", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["local vs federal", "Local Focus", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["recreational fisheries", "Ecotourism & Charters", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["trip tickets", "Enforcement Challenges", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["restaurants", "Unfairness & Distrust", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["restaurants", "Community Engagement", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["advocacy", "Management Planning", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["advocacy", "Price Influences", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["dangerous conditions", "hurricane assessments", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["environmental sciences", "Legislative Body", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["hurricane assessments", "Legislative Decisions", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["hurricane assessments", "Community Engagement", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["decline fishers", "Fisheries Management", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["commercial fisheries", "No-Take Decisions", {"weight": 1.0, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["commercial fisheries", "hurricane assessments", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["commercial fisheries", "Environmental Professionals", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["equipment use", "Human Pollution", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["water-based activities", "coastal zone management", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["coastal zone management", "Ecosystem Decline", {"weight": -1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Meeting Administration", "Coral Reef Threats", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Fishing Activities", "Fishery Problems", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Statistical Professionals", "Data Collection Planning", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Building Trust", "Island Communities", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["License Types", "Information Partnerships", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Trap Fishing", "Federal Management", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Trap Management", "Government Distrust", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Recreational Fishing", "License Types", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Health", "Education Levels", {"weight": 1.0, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Health", "Federal Grants", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Health", "Unfairness & Distrust", {"weight": -1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fishing Traps & Impacts", "No-Take Decisions", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Recreational Fisheries Management", "Community Engagement", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Parrotfish Herbivores", "Human Pollution", {"weight": -1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Aquatic Food Web", "Unfairness & Distrust", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Fish and Seafood", "Ecosystem Decline", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fishing Community", "Fishermen Participation", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Coral Health", "Fishermen Concerns", {"weight": 1.0, "confidence": 0.625, "type": "inter_cluster", "style": "solid"}], ["Coral Health", "silt", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Collaborative Science Network", "advocacy", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Collaborative Science Network", "Fish and Seafood", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Collaborative Science Network", "data models", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Relationship Conflict", "Fishery Disaster Aid", {"weight": -1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Harbor Resources Conflict", "Fisher Conflicts", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Agricultural Conservation", "Marine Ecology", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Land & Species", "Water Resources", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Permit Regulations", "Justice System", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Permit Regulations", "Rules & Regulations", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Government Initiatives", "commercial fisheries", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Government Initiatives", "Agricultural Conservation", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Government Distrust", "commercial fisheries", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Fish Landings", "Education Levels", {"weight": 0.5, "confidence": 0.2, "type": "inter_cluster", "style": "solid"}], ["Fishery Disaster Aid", "Data Collection Planning", {"weight": 1.0, "confidence": 0.525, "type": "inter_cluster", "style": "solid"}], ["Co-op Structure", "Fishermen Concerns", {"weight": -1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Market Access", "violent conflicts", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Economic Considerations", "fishermen conflicts", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Declining Fisheries", "Recreational Fishing", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Storm Events", "Data Collection Planning", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Environmental Change", "Legislative Body", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Gear Basics", "Marine Ecology", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Gear Basics", "trap reduction", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Public Forums", "Fisheries Management", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Runoff & Degradation", "Building Trust", {"weight": -1.0, "confidence": 0.475, "type": "inter_cluster", "style": "solid"}], ["Water Resources", "decline fishers", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Port Sampling & Representation", "Building Trust", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Decision Making", "Recreational Fishing", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Fishermen Participation", "Advice Groups", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Fishermen Concerns", "Federal Grants", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Fishermen Concerns", "violent conflicts", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["NOAA Acronym", "Government Initiatives", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Management Planning", "Regulation Types", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Management Planning", "trap reduction", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Management Planning", "Recreational Fishing", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Fishing Impacts", "Regulatory Licensing", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Conflict Management", "Building Trust", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Education Levels", "island-based management", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"dangerous conditions": [], "fishermen conflicts": [], "hurricane assessments": [], "data models": [], "commercial fisheries": [], "silt": [], "island-based management": [], "coastal zone management": [], "violent conflicts": [], "Meeting Administration": [], "Unfairness & Distrust": [], "Fishing Activities": [], "Federal Grants": [], "Statistical Professionals": [], "Building Trust": [], "Community Engagement": [], "License Types": [], "Regulatory Licensing": [], "Trap Fishing": [], "Trap Management": [], "Recreational Fishing": [], "Ecosystem Health": [], "Fisheries Management": [], "Fishing Traps & Impacts": [], "Recreational Fisheries Management": [], "Parrotfish Herbivores": [], "Aquatic Food Web": [], "Fish and Seafood": [], "Justice System": [], "Enforcement Challenges": [], "Fishing Community": [], "Coral Health": [], "Coral Reef Threats": [], "Collaborative Science Network": [], "Relationship Conflict": [], "Information Partnerships": [], "Harbor Resources Conflict": [], "Federal Management": [], "Ecotourism & Charters": [], "Local Focus": [], "Ecosystem Decline": [], "Agricultural Conservation": [], "Land & Species": [], "Rules & Regulations": [], "Regulation Types": [], "Permit Regulations": [], "Government Initiatives": [], "Government Distrust": [], "Environmental Professionals": [], "Human Pollution": [], "Fish Landings": [], "Fishery Problems": [], "Fisher Conflicts": [], "Fishery Disaster Aid": [], "Co-op Structure": [], "No-Take Decisions": [], "Market Access": [], "Economic Considerations": [], "Price Influences": [], "Data Collection Planning": [], "Declining Fisheries": [], "Storm Events": [], "Environmental Change": [], "Gear Basics": [], "Island Communities": [], "Public Forums": [], "Runoff & Degradation": [], "Water Resources": [], "Port Sampling & Representation": [], "Decision Making": [], "Fishermen Participation": [], "Fishermen Concerns": [], "NOAA Acronym": [], "Management Planning": [], "Fishing Impacts": [], "Conflict Management": [], "Advice Groups": [], "Education Levels": [], "Marine Ecology": [], "Legislative Body": [], "Legislative Decisions": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>


<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Exploit Development & Mitigations": {"concepts": "control flow, execution instructions, forward flow, backward flow, static analysis, decompilation, execution, binary analysis, disassembler, file headers, decompilers, decompiler, decompilation readability, readability, usability, emulation, program emulation, emulation techniques, signed graph, fuzzy cognitive map, arm, powerpc, architecture, architectures", "concept_list": ["control flow", "execution instructions", "forward flow", "backward flow", "static analysis", "decompilation", "execution", "binary analysis", "disassembler", "file headers", "decompilers", "decompiler", "decompilation readability", "readability", "usability", "emulation", "program emulation", "emulation techniques", "signed graph", "fuzzy cognitive map", "arm", "powerpc", "architecture", "architectures"], "type": "cluster", "node_size": 87, "label": "Exploit Development & Mitigations"}, "Development Challenges & Attacks": {"concepts": "vulnerability, vulnerability input, user input, exploit primitives, primitives, primitive availability, exploit building, bypassing mitigations, defensive mitigations, mitigation steps, mitigation discovery, code obfuscation, polyglot binaries, polyglot, tool support, other tools, discovery tools, common tools", "concept_list": ["vulnerability", "vulnerability input", "user input", "exploit primitives", "primitives", "primitive availability", "exploit building", "bypassing mitigations", "defensive mitigations", "mitigation steps", "mitigation discovery", "code obfuscation", "polyglot binaries", "polyglot", "tool support", "other tools", "discovery tools", "common tools"], "type": "cluster", "node_size": 69, "label": "Development Challenges & Attacks"}, "Binary Understanding & Context": {"concepts": "open-ended process, iterative process, development, development process, success factors, knowledge, challenge, challenge understanding, misunderstanding, incorrect assumptions, challenge confirmation, misleading information, beliefs, lack of time, connection failure, fail to connect, cyber attackers, cyber attacks, remote exploit, local exploit", "concept_list": ["open-ended process", "iterative process", "development", "development process", "success factors", "knowledge", "challenge", "challenge understanding", "misunderstanding", "incorrect assumptions", "challenge confirmation", "misleading information", "beliefs", "lack of time", "connection failure", "fail to connect", "cyber attackers", "cyber attacks", "remote exploit", "local exploit"], "type": "cluster", "node_size": 75, "label": "Binary Understanding & Context"}, "Setup & Support Issues": {"concepts": "operating system, os, virtual machines, red herring, computer visualization, proof of concept, poc exercising, static variables, dynamic variables, register context, remote context, local context, time wasters, semi-structured, vulnerability understanding, binary", "concept_list": ["operating system", "os", "virtual machines", "red herring", "computer visualization", "proof of concept", "poc exercising", "static variables", "dynamic variables", "register context", "remote context", "local context", "time wasters", "semi-structured", "vulnerability understanding", "binary"], "type": "cluster", "node_size": 63, "label": "Setup & Support Issues"}, "Binary Code Analysis": {"concepts": "permissions issues, distractions, failure causes, local setup, decisions, ctf, system support", "concept_list": ["permissions issues", "distractions", "failure causes", "local setup", "decisions", "ctf", "system support"], "type": "cluster", "node_size": 36, "label": "Binary Code Analysis"}, "Debugging Tools": {"concepts": "debug symbols, debugging ability, debugger, debugger use", "concept_list": ["debug symbols", "debugging ability", "debugger", "debugger use"], "type": "cluster", "node_size": 27, "label": "Debugging Tools"}, "Debugging Challenges": {"concepts": "bug classes, anti-debugger techniques", "concept_list": ["bug classes", "anti-debugger techniques"], "type": "cluster", "node_size": 21, "label": "Debugging Challenges"}};
        const conceptData = {};
        const interClusterEdges = [["Exploit Development & Mitigations", "Debugging Tools", {"weight": 0.5, "confidence": 0.3625, "type": "inter_cluster", "style": "solid"}], ["Exploit Development & Mitigations", "Binary Code Analysis", {"weight": -0.5, "confidence": 0.225, "type": "inter_cluster", "style": "solid"}], ["Development Challenges & Attacks", "Binary Understanding & Context", {"weight": 1.0, "confidence": 0.63, "type": "inter_cluster", "style": "solid"}], ["Development Challenges & Attacks", "Setup & Support Issues", {"weight": 0.25, "confidence": 0.075, "type": "inter_cluster", "style": "solid"}], ["Development Challenges & Attacks", "Debugging Tools", {"weight": 0.25, "confidence": 0.075, "type": "inter_cluster", "style": "solid"}], ["Binary Understanding & Context", "Exploit Development & Mitigations", {"weight": 0.6666666666666666, "confidence": 0.3333333333333333, "type": "inter_cluster", "style": "solid"}], ["Binary Understanding & Context", "Setup & Support Issues", {"weight": 0.4, "confidence": 0.19, "type": "inter_cluster", "style": "solid"}], ["Binary Understanding & Context", "Development Challenges & Attacks", {"weight": 0.3333333333333333, "confidence": 0.19999999999999998, "type": "inter_cluster", "style": "solid"}], ["Binary Understanding & Context", "Debugging Tools", {"weight": 0.2, "confidence": 0.06999999999999999, "type": "inter_cluster", "style": "solid"}], ["Setup & Support Issues", "Development Challenges & Attacks", {"weight": 0.6666666666666666, "confidence": 0.31666666666666665, "type": "inter_cluster", "style": "solid"}], ["Setup & Support Issues", "Debugging Challenges", {"weight": -0.2, "confidence": 0.05, "type": "inter_cluster", "style": "solid"}], ["Binary Code Analysis", "Development Challenges & Attacks", {"weight": -0.5, "confidence": 0.23750000000000002, "type": "inter_cluster", "style": "solid"}], ["Binary Code Analysis", "Setup & Support Issues", {"weight": -0.3333333333333333, "confidence": 0.09999999999999999, "type": "inter_cluster", "style": "solid"}], ["Binary Code Analysis", "Debugging Tools", {"weight": -0.25, "confidence": 0.05, "type": "inter_cluster", "style": "solid"}], ["Debugging Tools", "Exploit Development & Mitigations", {"weight": 0.8, "confidence": 0.5800000000000001, "type": "inter_cluster", "style": "solid"}], ["Debugging Tools", "Debugging Challenges", {"weight": -0.3333333333333333, "confidence": 0.13333333333333333, "type": "inter_cluster", "style": "solid"}], ["Debugging Tools", "Setup & Support Issues", {"weight": 0.25, "confidence": 0.075, "type": "inter_cluster", "style": "solid"}], ["Debugging Tools", "Binary Code Analysis", {"weight": -0.25, "confidence": 0.075, "type": "inter_cluster", "style": "solid"}], ["Debugging Challenges", "Binary Code Analysis", {"weight": 0.2, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Debugging Challenges", "Debugging Tools", {"weight": -0.4, "confidence": 0.22000000000000003, "type": "inter_cluster", "style": "solid"}], ["Debugging Challenges", "Binary Understanding & Context", {"weight": 0.25, "confidence": 0.1, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"Exploit Development & Mitigations": [], "Development Challenges & Attacks": [], "Binary Understanding & Context": [], "Setup & Support Issues": [], "Binary Code Analysis": [], "Debugging Tools": [], "Debugging Challenges": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

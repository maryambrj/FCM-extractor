
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"security vulnerabilities": {"concepts": "security vulnerabilities", "concept_list": ["security vulnerabilities"], "type": "cluster", "node_size": 18, "label": "security vulnerabilities"}, "security recovery": {"concepts": "security recovery", "concept_list": ["security recovery"], "type": "cluster", "node_size": 18, "label": "security recovery"}, "firmware level": {"concepts": "firmware level", "concept_list": ["firmware level"], "type": "cluster", "node_size": 18, "label": "firmware level"}, "security intelligence": {"concepts": "security intelligence", "concept_list": ["security intelligence"], "type": "cluster", "node_size": 18, "label": "security intelligence"}, "identification process": {"concepts": "identification process", "concept_list": ["identification process"], "type": "cluster", "node_size": 18, "label": "identification process"}, "security perspective": {"concepts": "security perspective", "concept_list": ["security perspective"], "type": "cluster", "node_size": 18, "label": "security perspective"}, "solution": {"concepts": "solution", "concept_list": ["solution"], "type": "cluster", "node_size": 18, "label": "solution"}, "security identification": {"concepts": "security identification", "concept_list": ["security identification"], "type": "cluster", "node_size": 18, "label": "security identification"}, "access control": {"concepts": "access control", "concept_list": ["access control"], "type": "cluster", "node_size": 18, "label": "access control"}, "documentation challenges": {"concepts": "documentation challenges", "concept_list": ["documentation challenges"], "type": "cluster", "node_size": 18, "label": "documentation challenges"}, "full access": {"concepts": "full access", "concept_list": ["full access"], "type": "cluster", "node_size": 18, "label": "full access"}, "security defenses": {"concepts": "security defenses", "concept_list": ["security defenses"], "type": "cluster", "node_size": 18, "label": "security defenses"}, "bespoke systems": {"concepts": "bespoke systems", "concept_list": ["bespoke systems"], "type": "cluster", "node_size": 18, "label": "bespoke systems"}, "security environment": {"concepts": "security environment", "concept_list": ["security environment"], "type": "cluster", "node_size": 18, "label": "security environment"}, "data protocol": {"concepts": "data protocol", "concept_list": ["data protocol"], "type": "cluster", "node_size": 18, "label": "data protocol"}, "security management": {"concepts": "security management", "concept_list": ["security management"], "type": "cluster", "node_size": 18, "label": "security management"}, "software features": {"concepts": "software features", "concept_list": ["software features"], "type": "cluster", "node_size": 18, "label": "software features"}, "exploitation strategies": {"concepts": "exploitation strategies", "concept_list": ["exploitation strategies"], "type": "cluster", "node_size": 18, "label": "exploitation strategies"}, "software level": {"concepts": "software level", "concept_list": ["software level"], "type": "cluster", "node_size": 18, "label": "software level"}, "security analysis": {"concepts": "security analysis", "concept_list": ["security analysis"], "type": "cluster", "node_size": 18, "label": "security analysis"}, "security verification": {"concepts": "security verification", "concept_list": ["security verification"], "type": "cluster", "node_size": 18, "label": "security verification"}, "security strategy": {"concepts": "security strategy", "concept_list": ["security strategy"], "type": "cluster", "node_size": 18, "label": "security strategy"}, "security standards": {"concepts": "security standards", "concept_list": ["security standards"], "type": "cluster", "node_size": 18, "label": "security standards"}, "security process": {"concepts": "security process", "concept_list": ["security process"], "type": "cluster", "node_size": 18, "label": "security process"}, "access barriers": {"concepts": "access barriers", "concept_list": ["access barriers"], "type": "cluster", "node_size": 18, "label": "access barriers"}, "security protocols": {"concepts": "security protocols", "concept_list": ["security protocols"], "type": "cluster", "node_size": 18, "label": "security protocols"}, "computer visualization tool": {"concepts": "computer visualization tool", "concept_list": ["computer visualization tool"], "type": "cluster", "node_size": 18, "label": "computer visualization tool"}, "prior knowledge": {"concepts": "prior knowledge", "concept_list": ["prior knowledge"], "type": "cluster", "node_size": 18, "label": "prior knowledge"}, "communication interface": {"concepts": "communication interface", "concept_list": ["communication interface"], "type": "cluster", "node_size": 18, "label": "communication interface"}, "exploitation": {"concepts": "exploitation", "concept_list": ["exploitation"], "type": "cluster", "node_size": 18, "label": "exploitation"}, "security planning": {"concepts": "security planning", "concept_list": ["security planning"], "type": "cluster", "node_size": 18, "label": "security planning"}, "data sheet availability": {"concepts": "data sheet availability", "concept_list": ["data sheet availability"], "type": "cluster", "node_size": 18, "label": "data sheet availability"}, "physical interface": {"concepts": "physical interface", "concept_list": ["physical interface"], "type": "cluster", "node_size": 18, "label": "physical interface"}, "exploit process": {"concepts": "exploit process", "concept_list": ["exploit process"], "type": "cluster", "node_size": 18, "label": "exploit process"}, "decisions": {"concepts": "decisions", "concept_list": ["decisions"], "type": "cluster", "node_size": 18, "label": "decisions"}, "security coordination": {"concepts": "security coordination", "concept_list": ["security coordination"], "type": "cluster", "node_size": 18, "label": "security coordination"}, "security controls": {"concepts": "security controls", "concept_list": ["security controls"], "type": "cluster", "node_size": 18, "label": "security controls"}, "security documentation": {"concepts": "security documentation", "concept_list": ["security documentation"], "type": "cluster", "node_size": 18, "label": "security documentation"}, "security measures": {"concepts": "security measures", "concept_list": ["security measures"], "type": "cluster", "node_size": 18, "label": "security measures"}, "data sheets": {"concepts": "data sheets", "concept_list": ["data sheets"], "type": "cluster", "node_size": 18, "label": "data sheets"}, "security operations": {"concepts": "security operations", "concept_list": ["security operations"], "type": "cluster", "node_size": 18, "label": "security operations"}, "security layers": {"concepts": "security layers", "concept_list": ["security layers"], "type": "cluster", "node_size": 18, "label": "security layers"}, "software security": {"concepts": "software security", "concept_list": ["software security"], "type": "cluster", "node_size": 18, "label": "software security"}, "software languages": {"concepts": "software languages", "concept_list": ["software languages"], "type": "cluster", "node_size": 18, "label": "software languages"}, "security knowledge": {"concepts": "security knowledge", "concept_list": ["security knowledge"], "type": "cluster", "node_size": 18, "label": "security knowledge"}, "schedules": {"concepts": "schedules", "concept_list": ["schedules"], "type": "cluster", "node_size": 18, "label": "schedules"}, "system overview": {"concepts": "system overview", "concept_list": ["system overview"], "type": "cluster", "node_size": 18, "label": "system overview"}, "security information": {"concepts": "security information", "concept_list": ["security information"], "type": "cluster", "node_size": 18, "label": "security information"}, "security risks": {"concepts": "security risks", "concept_list": ["security risks"], "type": "cluster", "node_size": 18, "label": "security risks"}, "access obstacles": {"concepts": "access obstacles", "concept_list": ["access obstacles"], "type": "cluster", "node_size": 18, "label": "access obstacles"}, "documentation": {"concepts": "documentation", "concept_list": ["documentation"], "type": "cluster", "node_size": 18, "label": "documentation"}, "security impediments": {"concepts": "security impediments", "concept_list": ["security impediments"], "type": "cluster", "node_size": 18, "label": "security impediments"}, "security framework": {"concepts": "security framework", "concept_list": ["security framework"], "type": "cluster", "node_size": 18, "label": "security framework"}, "security testing": {"concepts": "security testing", "concept_list": ["security testing"], "type": "cluster", "node_size": 18, "label": "security testing"}, "security access": {"concepts": "security access", "concept_list": ["security access"], "type": "cluster", "node_size": 18, "label": "security access"}, "security design": {"concepts": "security design", "concept_list": ["security design"], "type": "cluster", "node_size": 18, "label": "security design"}, "security incidents": {"concepts": "security incidents", "concept_list": ["security incidents"], "type": "cluster", "node_size": 18, "label": "security incidents"}, "reverse engineering": {"concepts": "reverse engineering", "concept_list": ["reverse engineering"], "type": "cluster", "node_size": 18, "label": "reverse engineering"}, "system documentation": {"concepts": "system documentation", "concept_list": ["system documentation"], "type": "cluster", "node_size": 18, "label": "system documentation"}, "hardware exploitation": {"concepts": "hardware exploitation", "concept_list": ["hardware exploitation"], "type": "cluster", "node_size": 18, "label": "hardware exploitation"}, "security features": {"concepts": "security features", "concept_list": ["security features"], "type": "cluster", "node_size": 18, "label": "security features"}, "data collection": {"concepts": "data collection", "concept_list": ["data collection"], "type": "cluster", "node_size": 18, "label": "data collection"}, "system security": {"concepts": "system security", "concept_list": ["system security"], "type": "cluster", "node_size": 18, "label": "system security"}, "security bypass": {"concepts": "security bypass", "concept_list": ["security bypass"], "type": "cluster", "node_size": 18, "label": "security bypass"}, "security strategies": {"concepts": "security strategies", "concept_list": ["security strategies"], "type": "cluster", "node_size": 18, "label": "security strategies"}, "mislabeling": {"concepts": "mislabeling", "concept_list": ["mislabeling"], "type": "cluster", "node_size": 18, "label": "mislabeling"}, "security hardening": {"concepts": "security hardening", "concept_list": ["security hardening"], "type": "cluster", "node_size": 18, "label": "security hardening"}, "tool usability": {"concepts": "tool usability", "concept_list": ["tool usability"], "type": "cluster", "node_size": 18, "label": "tool usability"}, "security techniques": {"concepts": "security techniques", "concept_list": ["security techniques"], "type": "cluster", "node_size": 18, "label": "security techniques"}, "security mitigation": {"concepts": "security mitigation", "concept_list": ["security mitigation"], "type": "cluster", "node_size": 18, "label": "security mitigation"}, "exploitation knowledge": {"concepts": "exploitation knowledge", "concept_list": ["exploitation knowledge"], "type": "cluster", "node_size": 18, "label": "exploitation knowledge"}, "security monitoring": {"concepts": "security monitoring", "concept_list": ["security monitoring"], "type": "cluster", "node_size": 18, "label": "security monitoring"}, "security iteration": {"concepts": "security iteration", "concept_list": ["security iteration"], "type": "cluster", "node_size": 18, "label": "security iteration"}, "access goals": {"concepts": "access goals", "concept_list": ["access goals"], "type": "cluster", "node_size": 18, "label": "access goals"}, "security barriers": {"concepts": "security barriers", "concept_list": ["security barriers"], "type": "cluster", "node_size": 18, "label": "security barriers"}, "obtaining primitives": {"concepts": "obtaining primitives", "concept_list": ["obtaining primitives"], "type": "cluster", "node_size": 18, "label": "obtaining primitives"}, "security experience": {"concepts": "security experience", "concept_list": ["security experience"], "type": "cluster", "node_size": 18, "label": "security experience"}, "security education": {"concepts": "security education", "concept_list": ["security education"], "type": "cluster", "node_size": 18, "label": "security education"}, "security best practices": {"concepts": "security best practices", "concept_list": ["security best practices"], "type": "cluster", "node_size": 18, "label": "security best practices"}, "data availability": {"concepts": "data availability", "concept_list": ["data availability"], "type": "cluster", "node_size": 18, "label": "data availability"}, "successful access": {"concepts": "successful access", "concept_list": ["successful access"], "type": "cluster", "node_size": 18, "label": "successful access"}, "testing device": {"concepts": "testing device", "concept_list": ["testing device"], "type": "cluster", "node_size": 18, "label": "testing device"}, "security assessment": {"concepts": "security assessment", "concept_list": ["security assessment"], "type": "cluster", "node_size": 18, "label": "security assessment"}, "connection establishment": {"concepts": "connection establishment", "concept_list": ["connection establishment"], "type": "cluster", "node_size": 18, "label": "connection establishment"}, "protection mechanisms": {"concepts": "protection mechanisms", "concept_list": ["protection mechanisms"], "type": "cluster", "node_size": 18, "label": "protection mechanisms"}, "security feature": {"concepts": "security feature", "concept_list": ["security feature"], "type": "cluster", "node_size": 18, "label": "security feature"}, "security research": {"concepts": "security research", "concept_list": ["security research"], "type": "cluster", "node_size": 18, "label": "security research"}, "software libraries": {"concepts": "software libraries", "concept_list": ["software libraries"], "type": "cluster", "node_size": 18, "label": "software libraries"}, "security stages": {"concepts": "security stages", "concept_list": ["security stages"], "type": "cluster", "node_size": 18, "label": "security stages"}, "partial failure": {"concepts": "partial failure", "concept_list": ["partial failure"], "type": "cluster", "node_size": 18, "label": "partial failure"}, "success steps": {"concepts": "success steps", "concept_list": ["success steps"], "type": "cluster", "node_size": 18, "label": "success steps"}, "software component": {"concepts": "software component", "concept_list": ["software component"], "type": "cluster", "node_size": 18, "label": "software component"}, "success factors": {"concepts": "success factors", "concept_list": ["success factors"], "type": "cluster", "node_size": 18, "label": "success factors"}, "security data": {"concepts": "security data", "concept_list": ["security data"], "type": "cluster", "node_size": 18, "label": "security data"}, "data sheet": {"concepts": "data sheet", "concept_list": ["data sheet"], "type": "cluster", "node_size": 18, "label": "data sheet"}, "knowledge repository": {"concepts": "knowledge repository", "concept_list": ["knowledge repository"], "type": "cluster", "node_size": 18, "label": "knowledge repository"}, "security troubleshooting": {"concepts": "security troubleshooting", "concept_list": ["security troubleshooting"], "type": "cluster", "node_size": 18, "label": "security troubleshooting"}, "server interaction": {"concepts": "server interaction", "concept_list": ["server interaction"], "type": "cluster", "node_size": 18, "label": "server interaction"}, "security protections": {"concepts": "security protections", "concept_list": ["security protections"], "type": "cluster", "node_size": 18, "label": "security protections"}, "security incident": {"concepts": "security incident", "concept_list": ["security incident"], "type": "cluster", "node_size": 18, "label": "security incident"}, "access attainment": {"concepts": "access attainment", "concept_list": ["access attainment"], "type": "cluster", "node_size": 18, "label": "access attainment"}, "exploitation target": {"concepts": "exploitation target", "concept_list": ["exploitation target"], "type": "cluster", "node_size": 18, "label": "exploitation target"}, "exploitation avenues": {"concepts": "exploitation avenues", "concept_list": ["exploitation avenues"], "type": "cluster", "node_size": 18, "label": "exploitation avenues"}, "standardized interfaces": {"concepts": "standardized interfaces", "concept_list": ["standardized interfaces"], "type": "cluster", "node_size": 18, "label": "standardized interfaces"}, "strategies": {"concepts": "strategies", "concept_list": ["strategies"], "type": "cluster", "node_size": 18, "label": "strategies"}, "access enablement": {"concepts": "access enablement", "concept_list": ["access enablement"], "type": "cluster", "node_size": 18, "label": "access enablement"}, "exploit enablement": {"concepts": "exploit enablement", "concept_list": ["exploit enablement"], "type": "cluster", "node_size": 18, "label": "exploit enablement"}, "countersecurity activities": {"concepts": "countersecurity activities", "concept_list": ["countersecurity activities"], "type": "cluster", "node_size": 18, "label": "countersecurity activities"}, "system access": {"concepts": "system access", "concept_list": ["system access"], "type": "cluster", "node_size": 18, "label": "system access"}, "security compliance": {"concepts": "security compliance", "concept_list": ["security compliance"], "type": "cluster", "node_size": 18, "label": "security compliance"}, "security validation": {"concepts": "security validation", "concept_list": ["security validation"], "type": "cluster", "node_size": 18, "label": "security validation"}, "hardware access": {"concepts": "hardware access", "concept_list": ["hardware access"], "type": "cluster", "node_size": 18, "label": "hardware access"}, "undocumented systems": {"concepts": "undocumented systems", "concept_list": ["undocumented systems"], "type": "cluster", "node_size": 18, "label": "undocumented systems"}, "capture the flag": {"concepts": "capture the flag", "concept_list": ["capture the flag"], "type": "cluster", "node_size": 18, "label": "capture the flag"}, "communication protocols": {"concepts": "communication protocols", "concept_list": ["communication protocols"], "type": "cluster", "node_size": 18, "label": "communication protocols"}, "protocol decoding": {"concepts": "protocol decoding", "concept_list": ["protocol decoding"], "type": "cluster", "node_size": 18, "label": "protocol decoding"}, "security frameworks": {"concepts": "security frameworks", "concept_list": ["security frameworks"], "type": "cluster", "node_size": 18, "label": "security frameworks"}, "system exploitation": {"concepts": "system exploitation", "concept_list": ["system exploitation"], "type": "cluster", "node_size": 18, "label": "system exploitation"}, "security list": {"concepts": "security list", "concept_list": ["security list"], "type": "cluster", "node_size": 18, "label": "security list"}, "security workflow": {"concepts": "security workflow", "concept_list": ["security workflow"], "type": "cluster", "node_size": 18, "label": "security workflow"}, "security risk": {"concepts": "security risk", "concept_list": ["security risk"], "type": "cluster", "node_size": 18, "label": "security risk"}, "security integration": {"concepts": "security integration", "concept_list": ["security integration"], "type": "cluster", "node_size": 18, "label": "security integration"}, "encryption": {"concepts": "encryption", "concept_list": ["encryption"], "type": "cluster", "node_size": 18, "label": "encryption"}, "data translation": {"concepts": "data translation", "concept_list": ["data translation"], "type": "cluster", "node_size": 18, "label": "data translation"}, "access success": {"concepts": "access success", "concept_list": ["access success"], "type": "cluster", "node_size": 18, "label": "access success"}, "security expertise": {"concepts": "security expertise", "concept_list": ["security expertise"], "type": "cluster", "node_size": 18, "label": "security expertise"}, "file read primitive": {"concepts": "file read primitive", "concept_list": ["file read primitive"], "type": "cluster", "node_size": 18, "label": "file read primitive"}, "positive influence": {"concepts": "positive influence", "concept_list": ["positive influence"], "type": "cluster", "node_size": 18, "label": "positive influence"}, "access levels": {"concepts": "access levels", "concept_list": ["access levels"], "type": "cluster", "node_size": 18, "label": "access levels"}, "security obstacles": {"concepts": "security obstacles", "concept_list": ["security obstacles"], "type": "cluster", "node_size": 18, "label": "security obstacles"}, "security measure": {"concepts": "security measure", "concept_list": ["security measure"], "type": "cluster", "node_size": 18, "label": "security measure"}, "task diagramming": {"concepts": "task diagramming", "concept_list": ["task diagramming"], "type": "cluster", "node_size": 18, "label": "task diagramming"}, "security challenges": {"concepts": "security challenges", "concept_list": ["security challenges"], "type": "cluster", "node_size": 18, "label": "security challenges"}, "security architecture": {"concepts": "security architecture", "concept_list": ["security architecture"], "type": "cluster", "node_size": 18, "label": "security architecture"}, "security evaluation": {"concepts": "security evaluation", "concept_list": ["security evaluation"], "type": "cluster", "node_size": 18, "label": "security evaluation"}, "tool availability": {"concepts": "tool availability", "concept_list": ["tool availability"], "type": "cluster", "node_size": 18, "label": "tool availability"}, "security checkpoints": {"concepts": "security checkpoints", "concept_list": ["security checkpoints"], "type": "cluster", "node_size": 18, "label": "security checkpoints"}, "security implementation": {"concepts": "security implementation", "concept_list": ["security implementation"], "type": "cluster", "node_size": 18, "label": "security implementation"}, "security mechanisms": {"concepts": "security mechanisms", "concept_list": ["security mechanisms"], "type": "cluster", "node_size": 18, "label": "security mechanisms"}, "security recovery plan": {"concepts": "security recovery plan", "concept_list": ["security recovery plan"], "type": "cluster", "node_size": 18, "label": "security recovery plan"}, "bespoke tools": {"concepts": "bespoke tools", "concept_list": ["bespoke tools"], "type": "cluster", "node_size": 18, "label": "bespoke tools"}, "security responsibilities": {"concepts": "security responsibilities", "concept_list": ["security responsibilities"], "type": "cluster", "node_size": 18, "label": "security responsibilities"}, "subcomponent identification": {"concepts": "subcomponent identification", "concept_list": ["subcomponent identification"], "type": "cluster", "node_size": 18, "label": "subcomponent identification"}, "iterative process": {"concepts": "iterative process", "concept_list": ["iterative process"], "type": "cluster", "node_size": 18, "label": "iterative process"}, "physical interfacing": {"concepts": "physical interfacing", "concept_list": ["physical interfacing"], "type": "cluster", "node_size": 18, "label": "physical interfacing"}, "security enforcement": {"concepts": "security enforcement", "concept_list": ["security enforcement"], "type": "cluster", "node_size": 18, "label": "security enforcement"}, "tool software": {"concepts": "tool software", "concept_list": ["tool software"], "type": "cluster", "node_size": 18, "label": "tool software"}, "protocols": {"concepts": "protocols", "concept_list": ["protocols"], "type": "cluster", "node_size": 18, "label": "protocols"}, "knowledge": {"concepts": "knowledge", "concept_list": ["knowledge"], "type": "cluster", "node_size": 18, "label": "knowledge"}, "system components": {"concepts": "system components", "concept_list": ["system components"], "type": "cluster", "node_size": 18, "label": "system components"}, "data analysis": {"concepts": "data analysis", "concept_list": ["data analysis"], "type": "cluster", "node_size": 18, "label": "data analysis"}, "firmware security": {"concepts": "firmware security", "concept_list": ["firmware security"], "type": "cluster", "node_size": 18, "label": "firmware security"}, "bespoke physical tools": {"concepts": "bespoke physical tools", "concept_list": ["bespoke physical tools"], "type": "cluster", "node_size": 18, "label": "bespoke physical tools"}, "access progression": {"concepts": "access progression", "concept_list": ["access progression"], "type": "cluster", "node_size": 18, "label": "access progression"}, "access": {"concepts": "access", "concept_list": ["access"], "type": "cluster", "node_size": 18, "label": "access"}, "security configuration": {"concepts": "security configuration", "concept_list": ["security configuration"], "type": "cluster", "node_size": 18, "label": "security configuration"}, "exploit components": {"concepts": "exploit components", "concept_list": ["exploit components"], "type": "cluster", "node_size": 18, "label": "exploit components"}, "security escalation": {"concepts": "security escalation", "concept_list": ["security escalation"], "type": "cluster", "node_size": 18, "label": "security escalation"}, "intuition": {"concepts": "intuition", "concept_list": ["intuition"], "type": "cluster", "node_size": 18, "label": "intuition"}, "access difficulty": {"concepts": "access difficulty", "concept_list": ["access difficulty"], "type": "cluster", "node_size": 18, "label": "access difficulty"}, "language identification": {"concepts": "language identification", "concept_list": ["language identification"], "type": "cluster", "node_size": 18, "label": "language identification"}, "subcomponents identification": {"concepts": "subcomponents identification", "concept_list": ["subcomponents identification"], "type": "cluster", "node_size": 18, "label": "subcomponents identification"}};
        const conceptData = {};
        const interClusterEdges = [["security vulnerabilities", "security research", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security vulnerabilities", "software component", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["firmware level", "security integration", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security intelligence", "physical interface", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["identification process", "security checkpoints", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security perspective", "security knowledge", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security perspective", "data protocol", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["solution", "bespoke physical tools", {"weight": 0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["security identification", "security obstacles", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security identification", "security planning", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security identification", "security expertise", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["documentation challenges", "schedules", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["full access", "security vulnerabilities", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["full access", "tool software", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security defenses", "security techniques", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["bespoke systems", "exploit components", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security environment", "security obstacles", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["security management", "hardware exploitation", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["software features", "security evaluation", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["exploitation strategies", "security workflow", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["software level", "security impediments", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security analysis", "security knowledge", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["security verification", "exploit enablement", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security verification", "access goals", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security standards", "security hardening", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security standards", "access success", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["access barriers", "security challenges", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["security protocols", "security layers", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["prior knowledge", "security mechanisms", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["prior knowledge", "knowledge repository", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["prior knowledge", "partial failure", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["communication interface", "exploit enablement", {"weight": 1.0, "confidence": 0.875, "type": "inter_cluster", "style": "solid"}], ["communication interface", "security challenges", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["exploitation", "system access", {"weight": 1.0, "confidence": 0.95, "type": "inter_cluster", "style": "solid"}], ["physical interface", "security barriers", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["exploit process", "security iteration", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security coordination", "security process", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security controls", "knowledge", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security controls", "security strategy", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security controls", "file read primitive", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security documentation", "security management", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security operations", "tool usability", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security layers", "security monitoring", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["software security", "communication interface", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["software languages", "encryption", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security knowledge", "access attainment", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["schedules", "tool availability", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security risks", "security architecture", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security risks", "security mechanisms", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["access obstacles", "encryption", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["documentation", "access", {"weight": 1.0, "confidence": 0.875, "type": "inter_cluster", "style": "solid"}], ["security framework", "security evaluation", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security testing", "security protections", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security testing", "security controls", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security access", "encryption", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security design", "reverse engineering", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security incidents", "security responsibilities", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "prior knowledge", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "security best practices", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["system documentation", "exploitation avenues", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["hardware exploitation", "security workflow", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security features", "solution", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security features", "hardware access", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["security features", "subcomponent identification", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["data collection", "testing device", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security strategies", "security process", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security strategies", "countersecurity activities", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["mislabeling", "security environment", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["tool usability", "bespoke tools", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["tool usability", "data translation", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security mitigation", "documentation challenges", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["exploitation knowledge", "security troubleshooting", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security experience", "security assessment", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security education", "security experience", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["data availability", "data protocol", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["testing device", "exploitation", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["protection mechanisms", "security feature", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security feature", "exploitation", {"weight": -1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["security feature", "tool software", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security feature", "security configuration", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["software libraries", "security perspective", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security stages", "protocol decoding", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["success steps", "language identification", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["success steps", "iterative process", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["success factors", "data sheets", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["security data", "security recovery", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security troubleshooting", "access enablement", {"weight": 1.0, "confidence": 0.6833333333333332, "type": "inter_cluster", "style": "solid"}], ["server interaction", "positive influence", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security protections", "access control", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["security incident", "full access", {"weight": -1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["security incident", "security feature", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security incident", "firmware security", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security incident", "access difficulty", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["exploitation target", "protocol decoding", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["exploitation target", "data protocol", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["exploitation target", "system overview", {"weight": 0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["exploitation avenues", "security configuration", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["exploitation avenues", "security information", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["standardized interfaces", "decisions", {"weight": 1.0, "confidence": 0.7250000000000001, "type": "inter_cluster", "style": "solid"}], ["strategies", "successful access", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["exploit enablement", "exploit components", {"weight": 1.0, "confidence": 0.825, "type": "inter_cluster", "style": "solid"}], ["system access", "connection establishment", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["system access", "software features", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["system access", "standardized interfaces", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security compliance", "prior knowledge", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security compliance", "security protections", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security validation", "access goals", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["hardware access", "security measure", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["undocumented systems", "access control", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["undocumented systems", "security intelligence", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["capture the flag", "system security", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["communication protocols", "data sheets", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security frameworks", "security planning", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security frameworks", "firmware security", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["system exploitation", "security bypass", {"weight": 1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["system exploitation", "security techniques", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["security list", "data analysis", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security risk", "security challenges", {"weight": 1.0, "confidence": 0.6499999999999999, "type": "inter_cluster", "style": "solid"}], ["security integration", "access control", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security integration", "system documentation", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["encryption", "exploitation avenues", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["encryption", "hardware access", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["data translation", "security measures", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["data translation", "physical interfacing", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["positive influence", "connection establishment", {"weight": 1.0, "confidence": 0.95, "type": "inter_cluster", "style": "solid"}], ["access levels", "data sheet", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security measure", "data sheet availability", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security measure", "obtaining primitives", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["task diagramming", "computer visualization tool", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["tool availability", "reverse engineering", {"weight": -1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["security implementation", "security measure", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["security mechanisms", "security challenges", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["security recovery plan", "security obstacles", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["security enforcement", "server interaction", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["protocols", "physical interface", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["system components", "security strategies", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["access progression", "security incidents", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security escalation", "security protections", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["intuition", "security enforcement", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["language identification", "software languages", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["subcomponents identification", "access", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

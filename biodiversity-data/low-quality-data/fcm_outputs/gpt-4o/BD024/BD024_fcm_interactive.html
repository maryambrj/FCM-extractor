
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Biodiversity & Ecosystems": {"concepts": "ecosystem services, biogeochemistry, species of conservation concern, species data, functional diversity, nutrient cycling, ecological interactions, habitat, species diversity, ecosystem service valuation, harmful organisms, biodiversity, species information, habitat-forming species, species richness, biogeochemist, food web-supporting species, ecologist", "concept_list": ["ecosystem services", "biogeochemistry", "species of conservation concern", "species data", "functional diversity", "nutrient cycling", "ecological interactions", "habitat", "species diversity", "ecosystem service valuation", "harmful organisms", "biodiversity", "species information", "habitat-forming species", "species richness", "biogeochemist", "food web-supporting species", "ecologist"], "type": "cluster", "node_size": 69, "label": "Biodiversity & Ecosystems"}, "Policy & Management": {"concepts": "considerations, nature-based solutions, decision points, contexts, america the beautiful initiative, nature portfolio, public repository, schedule, collaboration, policy side, phd researcher, ngo management, effectiveness, planning processes, barriers, prioritizes, grant programs, work, weekend, science-based framework, green management, functional data, natural science, boundary organizations, nature, functional policy, carbon, ngo partnership, facilitation functions, private sector, climate, genetics, white house office of science and technology policy, dunes, usg perspective, science side, assistant director, indicators, g7, infrastructure funding, wind attenuation, risk models, environment team, rapid insight mechanisms, research communities, multilateral negotiations, problem-oriented engagement, target outcomes, motivates, universities, decision makers, ngo research, federal benefit cost analysis, noaa, private sector risk models., g20, resource management., farm bill programs, cbe, resource management, social scientists, expertise, academic research, management, applied research, system-based management, management practices", "concept_list": ["considerations", "nature-based solutions", "decision points", "contexts", "america the beautiful initiative", "nature portfolio", "public repository", "schedule", "collaboration", "policy side", "phd researcher", "ngo management", "effectiveness", "planning processes", "barriers", "prioritizes", "grant programs", "work", "weekend", "science-based framework", "green management", "functional data", "natural science", "boundary organizations", "nature", "functional policy", "carbon", "ngo partnership", "facilitation functions", "private sector", "climate", "genetics", "white house office of science and technology policy", "dunes", "usg perspective", "science side", "assistant director", "indicators", "g7", "infrastructure funding", "wind attenuation", "risk models", "environment team", "rapid insight mechanisms", "research communities", "multilateral negotiations", "problem-oriented engagement", "target outcomes", "motivates", "universities", "decision makers", "ngo research", "federal benefit cost analysis", "noaa", "private sector risk models.", "g20", "resource management.", "farm bill programs", "cbe", "resource management", "social scientists", "expertise", "academic research", "management", "applied research", "system-based management", "management practices"], "type": "cluster", "node_size": 216, "label": "Policy & Management"}, "Marine Conservation": {"concepts": "conservation practices, marine system, flood risk reduction, marine outcomes, oyster reefs, mangroves, estuary, water quality, conservation sciences, marine resource management, conservation actions, coastal ecosystem restoration, marshes, marine management, coral reefs, fishery landings, coastal wetlands, conservation organizations", "concept_list": ["conservation practices", "marine system", "flood risk reduction", "marine outcomes", "oyster reefs", "mangroves", "estuary", "water quality", "conservation sciences", "marine resource management", "conservation actions", "coastal ecosystem restoration", "marshes", "marine management", "coral reefs", "fishery landings", "coastal wetlands", "conservation organizations"], "type": "cluster", "node_size": 69, "label": "Marine Conservation"}};
        const conceptData = {"ecosystem services": {"concepts": "ecosystem services", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecosystem services"}, "biogeochemistry": {"concepts": "biogeochemistry", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "biogeochemistry"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species of conservation concern"}, "species data": {"concepts": "species data", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species data"}, "functional diversity": {"concepts": "functional diversity", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "functional diversity"}, "nutrient cycling": {"concepts": "nutrient cycling", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "nutrient cycling"}, "ecological interactions": {"concepts": "ecological interactions", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecological interactions"}, "habitat": {"concepts": "habitat", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "habitat"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species diversity"}, "ecosystem service valuation": {"concepts": "ecosystem service valuation", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecosystem service valuation"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "harmful organisms"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "biodiversity"}, "species information": {"concepts": "species information", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species information"}, "habitat-forming species": {"concepts": "habitat-forming species", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "habitat-forming species"}, "species richness": {"concepts": "species richness", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species richness"}, "biogeochemist": {"concepts": "biogeochemist", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "biogeochemist"}, "food web-supporting species": {"concepts": "food web-supporting species", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "food web-supporting species"}, "ecologist": {"concepts": "ecologist", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecologist"}, "considerations": {"concepts": "considerations", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "considerations"}, "nature-based solutions": {"concepts": "nature-based solutions", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "nature-based solutions"}, "decision points": {"concepts": "decision points", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "decision points"}, "contexts": {"concepts": "contexts", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "contexts"}, "america the beautiful initiative": {"concepts": "america the beautiful initiative", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "america the beautiful initiative"}, "nature portfolio": {"concepts": "nature portfolio", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "nature portfolio"}, "public repository": {"concepts": "public repository", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "public repository"}, "schedule": {"concepts": "schedule", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "schedule"}, "collaboration": {"concepts": "collaboration", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "collaboration"}, "policy side": {"concepts": "policy side", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "policy side"}, "phd researcher": {"concepts": "phd researcher", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "phd researcher"}, "ngo management": {"concepts": "ngo management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "ngo management"}, "effectiveness": {"concepts": "effectiveness", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "effectiveness"}, "planning processes": {"concepts": "planning processes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "planning processes"}, "barriers": {"concepts": "barriers", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "barriers"}, "prioritizes": {"concepts": "prioritizes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "prioritizes"}, "grant programs": {"concepts": "grant programs", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "grant programs"}, "work": {"concepts": "work", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "work"}, "weekend": {"concepts": "weekend", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "weekend"}, "science-based framework": {"concepts": "science-based framework", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "science-based framework"}, "green management": {"concepts": "green management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "green management"}, "functional data": {"concepts": "functional data", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "functional data"}, "natural science": {"concepts": "natural science", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "natural science"}, "boundary organizations": {"concepts": "boundary organizations", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "boundary organizations"}, "nature": {"concepts": "nature", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "nature"}, "functional policy": {"concepts": "functional policy", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "functional policy"}, "carbon": {"concepts": "carbon", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "carbon"}, "ngo partnership": {"concepts": "ngo partnership", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "ngo partnership"}, "facilitation functions": {"concepts": "facilitation functions", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "facilitation functions"}, "private sector": {"concepts": "private sector", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "private sector"}, "climate": {"concepts": "climate", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "climate"}, "genetics": {"concepts": "genetics", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "genetics"}, "white house office of science and technology policy": {"concepts": "white house office of science and technology policy", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "white house office of science and technology policy"}, "dunes": {"concepts": "dunes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "dunes"}, "usg perspective": {"concepts": "usg perspective", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "usg perspective"}, "science side": {"concepts": "science side", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "science side"}, "assistant director": {"concepts": "assistant director", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "assistant director"}, "indicators": {"concepts": "indicators", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "indicators"}, "g7": {"concepts": "g7", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "g7"}, "infrastructure funding": {"concepts": "infrastructure funding", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "infrastructure funding"}, "wind attenuation": {"concepts": "wind attenuation", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "wind attenuation"}, "risk models": {"concepts": "risk models", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "risk models"}, "environment team": {"concepts": "environment team", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "environment team"}, "rapid insight mechanisms": {"concepts": "rapid insight mechanisms", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "rapid insight mechanisms"}, "research communities": {"concepts": "research communities", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "research communities"}, "multilateral negotiations": {"concepts": "multilateral negotiations", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "multilateral negotiations"}, "problem-oriented engagement": {"concepts": "problem-oriented engagement", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "problem-oriented engagement"}, "target outcomes": {"concepts": "target outcomes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "target outcomes"}, "motivates": {"concepts": "motivates", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "motivates"}, "universities": {"concepts": "universities", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "universities"}, "decision makers": {"concepts": "decision makers", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "decision makers"}, "ngo research": {"concepts": "ngo research", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "ngo research"}, "federal benefit cost analysis": {"concepts": "federal benefit cost analysis", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "federal benefit cost analysis"}, "noaa": {"concepts": "noaa", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "noaa"}, "private sector risk models.": {"concepts": "private sector risk models.", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "private sector risk models."}, "g20": {"concepts": "g20", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "g20"}, "resource management.": {"concepts": "resource management.", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "resource management."}, "farm bill programs": {"concepts": "farm bill programs", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "farm bill programs"}, "cbe": {"concepts": "cbe", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "cbe"}, "resource management": {"concepts": "resource management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "resource management"}, "social scientists": {"concepts": "social scientists", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "social scientists"}, "expertise": {"concepts": "expertise", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "expertise"}, "academic research": {"concepts": "academic research", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "academic research"}, "management": {"concepts": "management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "management"}, "applied research": {"concepts": "applied research", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "applied research"}, "system-based management": {"concepts": "system-based management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "system-based management"}, "management practices": {"concepts": "management practices", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "management practices"}, "conservation practices": {"concepts": "conservation practices", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation practices"}, "marine system": {"concepts": "marine system", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine system"}, "flood risk reduction": {"concepts": "flood risk reduction", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "flood risk reduction"}, "marine outcomes": {"concepts": "marine outcomes", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine outcomes"}, "oyster reefs": {"concepts": "oyster reefs", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "oyster reefs"}, "mangroves": {"concepts": "mangroves", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "mangroves"}, "estuary": {"concepts": "estuary", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "estuary"}, "water quality": {"concepts": "water quality", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "water quality"}, "conservation sciences": {"concepts": "conservation sciences", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation sciences"}, "marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine resource management"}, "conservation actions": {"concepts": "conservation actions", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation actions"}, "coastal ecosystem restoration": {"concepts": "coastal ecosystem restoration", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "coastal ecosystem restoration"}, "marshes": {"concepts": "marshes", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marshes"}, "marine management": {"concepts": "marine management", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine management"}, "coral reefs": {"concepts": "coral reefs", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "coral reefs"}, "fishery landings": {"concepts": "fishery landings", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "fishery landings"}, "coastal wetlands": {"concepts": "coastal wetlands", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "coastal wetlands"}, "conservation organizations": {"concepts": "conservation organizations", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation organizations"}};
        const interClusterEdges = [["Biodiversity & Ecosystems", "Policy & Management", {"weight": 1.0, "confidence": 0.73, "type": "inter_cluster", "style": "solid"}], ["Biodiversity & Ecosystems", "Marine Conservation", {"weight": 0.4, "confidence": 0.32, "type": "inter_cluster", "style": "solid"}], ["Policy & Management", "Marine Conservation", {"weight": 0.6, "confidence": 0.43, "type": "inter_cluster", "style": "solid"}], ["Policy & Management", "Biodiversity & Ecosystems", {"weight": 0.6, "confidence": 0.44000000000000006, "type": "inter_cluster", "style": "solid"}], ["Marine Conservation", "Policy & Management", {"weight": 0.8, "confidence": 0.63, "type": "inter_cluster", "style": "solid"}], ["Marine Conservation", "Biodiversity & Ecosystems", {"weight": 0.2, "confidence": 0.18, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Biodiversity & Ecosystems": [["ecosystem services", {"concepts": "ecosystem services", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecosystem services"}], ["biogeochemistry", {"concepts": "biogeochemistry", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "biogeochemistry"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species of conservation concern"}], ["species data", {"concepts": "species data", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species data"}], ["functional diversity", {"concepts": "functional diversity", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "functional diversity"}], ["nutrient cycling", {"concepts": "nutrient cycling", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "nutrient cycling"}], ["ecological interactions", {"concepts": "ecological interactions", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecological interactions"}], ["habitat", {"concepts": "habitat", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "habitat"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species diversity"}], ["ecosystem service valuation", {"concepts": "ecosystem service valuation", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecosystem service valuation"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "harmful organisms"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "biodiversity"}], ["species information", {"concepts": "species information", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species information"}], ["habitat-forming species", {"concepts": "habitat-forming species", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "habitat-forming species"}], ["species richness", {"concepts": "species richness", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "species richness"}], ["biogeochemist", {"concepts": "biogeochemist", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "biogeochemist"}], ["food web-supporting species", {"concepts": "food web-supporting species", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "food web-supporting species"}], ["ecologist", {"concepts": "ecologist", "type": "concept", "cluster": "Biodiversity & Ecosystems", "node_size": 10, "label": "ecologist"}]], "Policy & Management": [["considerations", {"concepts": "considerations", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "considerations"}], ["nature-based solutions", {"concepts": "nature-based solutions", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "nature-based solutions"}], ["decision points", {"concepts": "decision points", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "decision points"}], ["contexts", {"concepts": "contexts", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "contexts"}], ["america the beautiful initiative", {"concepts": "america the beautiful initiative", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "america the beautiful initiative"}], ["nature portfolio", {"concepts": "nature portfolio", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "nature portfolio"}], ["public repository", {"concepts": "public repository", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "public repository"}], ["schedule", {"concepts": "schedule", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "schedule"}], ["collaboration", {"concepts": "collaboration", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "collaboration"}], ["policy side", {"concepts": "policy side", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "policy side"}], ["phd researcher", {"concepts": "phd researcher", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "phd researcher"}], ["ngo management", {"concepts": "ngo management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "ngo management"}], ["effectiveness", {"concepts": "effectiveness", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "effectiveness"}], ["planning processes", {"concepts": "planning processes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "planning processes"}], ["barriers", {"concepts": "barriers", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "barriers"}], ["prioritizes", {"concepts": "prioritizes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "prioritizes"}], ["grant programs", {"concepts": "grant programs", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "grant programs"}], ["work", {"concepts": "work", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "work"}], ["weekend", {"concepts": "weekend", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "weekend"}], ["science-based framework", {"concepts": "science-based framework", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "science-based framework"}], ["green management", {"concepts": "green management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "green management"}], ["functional data", {"concepts": "functional data", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "functional data"}], ["natural science", {"concepts": "natural science", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "natural science"}], ["boundary organizations", {"concepts": "boundary organizations", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "boundary organizations"}], ["nature", {"concepts": "nature", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "nature"}], ["functional policy", {"concepts": "functional policy", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "functional policy"}], ["carbon", {"concepts": "carbon", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "carbon"}], ["ngo partnership", {"concepts": "ngo partnership", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "ngo partnership"}], ["facilitation functions", {"concepts": "facilitation functions", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "facilitation functions"}], ["private sector", {"concepts": "private sector", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "private sector"}], ["climate", {"concepts": "climate", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "climate"}], ["genetics", {"concepts": "genetics", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "genetics"}], ["white house office of science and technology policy", {"concepts": "white house office of science and technology policy", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "white house office of science and technology policy"}], ["dunes", {"concepts": "dunes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "dunes"}], ["usg perspective", {"concepts": "usg perspective", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "usg perspective"}], ["science side", {"concepts": "science side", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "science side"}], ["assistant director", {"concepts": "assistant director", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "assistant director"}], ["indicators", {"concepts": "indicators", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "indicators"}], ["g7", {"concepts": "g7", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "g7"}], ["infrastructure funding", {"concepts": "infrastructure funding", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "infrastructure funding"}], ["wind attenuation", {"concepts": "wind attenuation", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "wind attenuation"}], ["risk models", {"concepts": "risk models", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "risk models"}], ["environment team", {"concepts": "environment team", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "environment team"}], ["rapid insight mechanisms", {"concepts": "rapid insight mechanisms", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "rapid insight mechanisms"}], ["research communities", {"concepts": "research communities", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "research communities"}], ["multilateral negotiations", {"concepts": "multilateral negotiations", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "multilateral negotiations"}], ["problem-oriented engagement", {"concepts": "problem-oriented engagement", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "problem-oriented engagement"}], ["target outcomes", {"concepts": "target outcomes", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "target outcomes"}], ["motivates", {"concepts": "motivates", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "motivates"}], ["universities", {"concepts": "universities", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "universities"}], ["decision makers", {"concepts": "decision makers", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "decision makers"}], ["ngo research", {"concepts": "ngo research", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "ngo research"}], ["federal benefit cost analysis", {"concepts": "federal benefit cost analysis", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "federal benefit cost analysis"}], ["noaa", {"concepts": "noaa", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "noaa"}], ["private sector risk models.", {"concepts": "private sector risk models.", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "private sector risk models."}], ["g20", {"concepts": "g20", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "g20"}], ["resource management.", {"concepts": "resource management.", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "resource management."}], ["farm bill programs", {"concepts": "farm bill programs", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "farm bill programs"}], ["cbe", {"concepts": "cbe", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "cbe"}], ["resource management", {"concepts": "resource management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "resource management"}], ["social scientists", {"concepts": "social scientists", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "social scientists"}], ["expertise", {"concepts": "expertise", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "expertise"}], ["academic research", {"concepts": "academic research", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "academic research"}], ["management", {"concepts": "management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "management"}], ["applied research", {"concepts": "applied research", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "applied research"}], ["system-based management", {"concepts": "system-based management", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "system-based management"}], ["management practices", {"concepts": "management practices", "type": "concept", "cluster": "Policy & Management", "node_size": 10, "label": "management practices"}]], "Marine Conservation": [["conservation practices", {"concepts": "conservation practices", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation practices"}], ["marine system", {"concepts": "marine system", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine system"}], ["flood risk reduction", {"concepts": "flood risk reduction", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "flood risk reduction"}], ["marine outcomes", {"concepts": "marine outcomes", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine outcomes"}], ["oyster reefs", {"concepts": "oyster reefs", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "oyster reefs"}], ["mangroves", {"concepts": "mangroves", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "mangroves"}], ["estuary", {"concepts": "estuary", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "estuary"}], ["water quality", {"concepts": "water quality", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "water quality"}], ["conservation sciences", {"concepts": "conservation sciences", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation sciences"}], ["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine resource management"}], ["conservation actions", {"concepts": "conservation actions", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation actions"}], ["coastal ecosystem restoration", {"concepts": "coastal ecosystem restoration", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "coastal ecosystem restoration"}], ["marshes", {"concepts": "marshes", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marshes"}], ["marine management", {"concepts": "marine management", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "marine management"}], ["coral reefs", {"concepts": "coral reefs", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "coral reefs"}], ["fishery landings", {"concepts": "fishery landings", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "fishery landings"}], ["coastal wetlands", {"concepts": "coastal wetlands", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "coastal wetlands"}], ["conservation organizations", {"concepts": "conservation organizations", "type": "concept", "cluster": "Marine Conservation", "node_size": 10, "label": "conservation organizations"}]]};
        const clusterEdges = {"Biodiversity & Ecosystems": [], "Policy & Management": [], "Marine Conservation": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

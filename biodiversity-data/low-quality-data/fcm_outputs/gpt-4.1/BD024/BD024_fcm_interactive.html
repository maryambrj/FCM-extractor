
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Private Sector Analysis": {"concepts": "private sector risk models, private sector, benefit cost analysis", "concept_list": ["private sector risk models", "private sector", "benefit cost analysis"], "type": "cluster", "node_size": 24, "label": "Private Sector Analysis"}, "Marine Biodiversity Management": {"concepts": "community structure, marine outcomes, biodiversity, mangroves, conservation organizations, functional understanding, species richness, marshes, habitat-forming species, individual species management, ecosystem interactions, coastal ecosystem restoration, conservation actions, functional data, ecosystem service valuation, oyster reefs, conservation concern species, food web-supporting species, biogeochemistry, estuary manager, habitat function, facilitation functions, water quality, fishery manager, natural resource management, estuary, marine resource management, biodiversity information, fishery landings, species of conservation concern, functional mechanism, habitat-associated function, functional diversity, harmful organisms, coral reefs, species diversity, marine management, diversity-function relationship, ecological information, nutrient cycling, coastal wetlands, flood risk reduction, species data, ecosystem services", "concept_list": ["community structure", "marine outcomes", "biodiversity", "mangroves", "conservation organizations", "functional understanding", "species richness", "marshes", "habitat-forming species", "individual species management", "ecosystem interactions", "coastal ecosystem restoration", "conservation actions", "functional data", "ecosystem service valuation", "oyster reefs", "conservation concern species", "food web-supporting species", "biogeochemistry", "estuary manager", "habitat function", "facilitation functions", "water quality", "fishery manager", "natural resource management", "estuary", "marine resource management", "biodiversity information", "fishery landings", "species of conservation concern", "functional mechanism", "habitat-associated function", "functional diversity", "harmful organisms", "coral reefs", "species diversity", "marine management", "diversity-function relationship", "ecological information", "nutrient cycling", "coastal wetlands", "flood risk reduction", "species data", "ecosystem services"], "type": "cluster", "node_size": 147, "label": "Marine Biodiversity Management"}, "Research Collaboration": {"concepts": "state water board, agency, researchers, barriers, considerations, us eez, rapid insight mechanisms, outcomes, impacts, parameters, risk models, problem-oriented engagement, organizational narrative, nature-based solutions, expertise, ngo research, conservation, academic research, public repository, ngo management, practitioners, science-based framework, analysis, synthesis, collaboration, wind attenuation, carbon, funding, science perspective, dunes, sectors, noaa, effectiveness, phd researcher, science side, organizational interface, boundary organizations, universities, evidence-based interpretation, applied research, data limitations, research communities, silos, indicators, models", "concept_list": ["state water board", "agency", "researchers", "barriers", "considerations", "us eez", "rapid insight mechanisms", "outcomes", "impacts", "parameters", "risk models", "problem-oriented engagement", "organizational narrative", "nature-based solutions", "expertise", "ngo research", "conservation", "academic research", "public repository", "ngo management", "practitioners", "science-based framework", "analysis", "synthesis", "collaboration", "wind attenuation", "carbon", "funding", "science perspective", "dunes", "sectors", "noaa", "effectiveness", "phd researcher", "science side", "organizational interface", "boundary organizations", "universities", "evidence-based interpretation", "applied research", "data limitations", "research communities", "silos", "indicators", "models"], "type": "cluster", "node_size": 150, "label": "Research Collaboration"}, "Policy Implementation": {"concepts": "policy side, federal policy, policy implementation, policy intention, policy language, grant programs, multilateral negotiations, farm bill programs, science-policy interface, policy", "concept_list": ["policy side", "federal policy", "policy implementation", "policy intention", "policy language", "grant programs", "multilateral negotiations", "farm bill programs", "science-policy interface", "policy"], "type": "cluster", "node_size": 45, "label": "Policy Implementation"}, "Management Practices": {"concepts": "system-based management, decision makers, managers, stock management, management decisions, prioritization, partnership management, management objectives, capacity constraints, green management, planning process, resource management, management context, system-oriented management, planning processes, management capacity, management interventions, management processes, management practices", "concept_list": ["system-based management", "decision makers", "managers", "stock management", "management decisions", "prioritization", "partnership management", "management objectives", "capacity constraints", "green management", "planning process", "resource management", "management context", "system-oriented management", "planning processes", "management capacity", "management interventions", "management processes", "management practices"], "type": "cluster", "node_size": 72, "label": "Management Practices"}};
        const conceptData = {"private sector risk models": {"concepts": "private sector risk models", "type": "concept", "cluster": "Private Sector Analysis", "node_size": 10, "label": "private sector risk models"}, "private sector": {"concepts": "private sector", "type": "concept", "cluster": "Private Sector Analysis", "node_size": 10, "label": "private sector"}, "benefit cost analysis": {"concepts": "benefit cost analysis", "type": "concept", "cluster": "Private Sector Analysis", "node_size": 10, "label": "benefit cost analysis"}, "community structure": {"concepts": "community structure", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "community structure"}, "marine outcomes": {"concepts": "marine outcomes", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marine outcomes"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "biodiversity"}, "mangroves": {"concepts": "mangroves", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "mangroves"}, "conservation organizations": {"concepts": "conservation organizations", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "conservation organizations"}, "functional understanding": {"concepts": "functional understanding", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional understanding"}, "species richness": {"concepts": "species richness", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species richness"}, "marshes": {"concepts": "marshes", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marshes"}, "habitat-forming species": {"concepts": "habitat-forming species", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "habitat-forming species"}, "individual species management": {"concepts": "individual species management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "individual species management"}, "ecosystem interactions": {"concepts": "ecosystem interactions", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecosystem interactions"}, "coastal ecosystem restoration": {"concepts": "coastal ecosystem restoration", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "coastal ecosystem restoration"}, "conservation actions": {"concepts": "conservation actions", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "conservation actions"}, "functional data": {"concepts": "functional data", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional data"}, "ecosystem service valuation": {"concepts": "ecosystem service valuation", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecosystem service valuation"}, "oyster reefs": {"concepts": "oyster reefs", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "oyster reefs"}, "conservation concern species": {"concepts": "conservation concern species", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "conservation concern species"}, "food web-supporting species": {"concepts": "food web-supporting species", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "food web-supporting species"}, "biogeochemistry": {"concepts": "biogeochemistry", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "biogeochemistry"}, "estuary manager": {"concepts": "estuary manager", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "estuary manager"}, "habitat function": {"concepts": "habitat function", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "habitat function"}, "facilitation functions": {"concepts": "facilitation functions", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "facilitation functions"}, "water quality": {"concepts": "water quality", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "water quality"}, "fishery manager": {"concepts": "fishery manager", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "fishery manager"}, "natural resource management": {"concepts": "natural resource management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "natural resource management"}, "estuary": {"concepts": "estuary", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "estuary"}, "marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marine resource management"}, "biodiversity information": {"concepts": "biodiversity information", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "biodiversity information"}, "fishery landings": {"concepts": "fishery landings", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "fishery landings"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species of conservation concern"}, "functional mechanism": {"concepts": "functional mechanism", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional mechanism"}, "habitat-associated function": {"concepts": "habitat-associated function", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "habitat-associated function"}, "functional diversity": {"concepts": "functional diversity", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional diversity"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "harmful organisms"}, "coral reefs": {"concepts": "coral reefs", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "coral reefs"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species diversity"}, "marine management": {"concepts": "marine management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marine management"}, "diversity-function relationship": {"concepts": "diversity-function relationship", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "diversity-function relationship"}, "ecological information": {"concepts": "ecological information", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecological information"}, "nutrient cycling": {"concepts": "nutrient cycling", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "nutrient cycling"}, "coastal wetlands": {"concepts": "coastal wetlands", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "coastal wetlands"}, "flood risk reduction": {"concepts": "flood risk reduction", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "flood risk reduction"}, "species data": {"concepts": "species data", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species data"}, "ecosystem services": {"concepts": "ecosystem services", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecosystem services"}, "state water board": {"concepts": "state water board", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "state water board"}, "agency": {"concepts": "agency", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "agency"}, "researchers": {"concepts": "researchers", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "researchers"}, "barriers": {"concepts": "barriers", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "barriers"}, "considerations": {"concepts": "considerations", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "considerations"}, "us eez": {"concepts": "us eez", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "us eez"}, "rapid insight mechanisms": {"concepts": "rapid insight mechanisms", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "rapid insight mechanisms"}, "outcomes": {"concepts": "outcomes", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "outcomes"}, "impacts": {"concepts": "impacts", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "impacts"}, "parameters": {"concepts": "parameters", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "parameters"}, "risk models": {"concepts": "risk models", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "risk models"}, "problem-oriented engagement": {"concepts": "problem-oriented engagement", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "problem-oriented engagement"}, "organizational narrative": {"concepts": "organizational narrative", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "organizational narrative"}, "nature-based solutions": {"concepts": "nature-based solutions", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "nature-based solutions"}, "expertise": {"concepts": "expertise", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "expertise"}, "ngo research": {"concepts": "ngo research", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "ngo research"}, "conservation": {"concepts": "conservation", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "conservation"}, "academic research": {"concepts": "academic research", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "academic research"}, "public repository": {"concepts": "public repository", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "public repository"}, "ngo management": {"concepts": "ngo management", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "ngo management"}, "practitioners": {"concepts": "practitioners", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "practitioners"}, "science-based framework": {"concepts": "science-based framework", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "science-based framework"}, "analysis": {"concepts": "analysis", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "analysis"}, "synthesis": {"concepts": "synthesis", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "synthesis"}, "collaboration": {"concepts": "collaboration", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "collaboration"}, "wind attenuation": {"concepts": "wind attenuation", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "wind attenuation"}, "carbon": {"concepts": "carbon", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "carbon"}, "funding": {"concepts": "funding", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "funding"}, "science perspective": {"concepts": "science perspective", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "science perspective"}, "dunes": {"concepts": "dunes", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "dunes"}, "sectors": {"concepts": "sectors", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "sectors"}, "noaa": {"concepts": "noaa", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "noaa"}, "effectiveness": {"concepts": "effectiveness", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "effectiveness"}, "phd researcher": {"concepts": "phd researcher", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "phd researcher"}, "science side": {"concepts": "science side", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "science side"}, "organizational interface": {"concepts": "organizational interface", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "organizational interface"}, "boundary organizations": {"concepts": "boundary organizations", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "boundary organizations"}, "universities": {"concepts": "universities", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "universities"}, "evidence-based interpretation": {"concepts": "evidence-based interpretation", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "evidence-based interpretation"}, "applied research": {"concepts": "applied research", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "applied research"}, "data limitations": {"concepts": "data limitations", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "data limitations"}, "research communities": {"concepts": "research communities", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "research communities"}, "silos": {"concepts": "silos", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "silos"}, "indicators": {"concepts": "indicators", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "indicators"}, "models": {"concepts": "models", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "models"}, "policy side": {"concepts": "policy side", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy side"}, "federal policy": {"concepts": "federal policy", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "federal policy"}, "policy implementation": {"concepts": "policy implementation", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy implementation"}, "policy intention": {"concepts": "policy intention", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy intention"}, "policy language": {"concepts": "policy language", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy language"}, "grant programs": {"concepts": "grant programs", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "grant programs"}, "multilateral negotiations": {"concepts": "multilateral negotiations", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "multilateral negotiations"}, "farm bill programs": {"concepts": "farm bill programs", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "farm bill programs"}, "science-policy interface": {"concepts": "science-policy interface", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "science-policy interface"}, "policy": {"concepts": "policy", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy"}, "system-based management": {"concepts": "system-based management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "system-based management"}, "decision makers": {"concepts": "decision makers", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "decision makers"}, "managers": {"concepts": "managers", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "managers"}, "stock management": {"concepts": "stock management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "stock management"}, "management decisions": {"concepts": "management decisions", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management decisions"}, "prioritization": {"concepts": "prioritization", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "prioritization"}, "partnership management": {"concepts": "partnership management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "partnership management"}, "management objectives": {"concepts": "management objectives", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management objectives"}, "capacity constraints": {"concepts": "capacity constraints", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "capacity constraints"}, "green management": {"concepts": "green management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "green management"}, "planning process": {"concepts": "planning process", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "planning process"}, "resource management": {"concepts": "resource management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "resource management"}, "management context": {"concepts": "management context", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management context"}, "system-oriented management": {"concepts": "system-oriented management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "system-oriented management"}, "planning processes": {"concepts": "planning processes", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "planning processes"}, "management capacity": {"concepts": "management capacity", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management capacity"}, "management interventions": {"concepts": "management interventions", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management interventions"}, "management processes": {"concepts": "management processes", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management processes"}, "management practices": {"concepts": "management practices", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management practices"}};
        const interClusterEdges = [["Private Sector Analysis", "Management Practices", {"weight": 0.8, "confidence": 0.58, "type": "inter_cluster", "style": "solid"}], ["Private Sector Analysis", "Marine Biodiversity Management", {"weight": 0.8, "confidence": 0.59, "type": "inter_cluster", "style": "solid"}], ["Private Sector Analysis", "Policy Implementation", {"weight": 0.8, "confidence": 0.49000000000000005, "type": "inter_cluster", "style": "solid"}], ["Private Sector Analysis", "Research Collaboration", {"weight": 0.6, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Marine Biodiversity Management", "Policy Implementation", {"weight": 1.0, "confidence": 0.68, "type": "inter_cluster", "style": "solid"}], ["Marine Biodiversity Management", "Management Practices", {"weight": 0.8, "confidence": 0.59, "type": "inter_cluster", "style": "solid"}], ["Marine Biodiversity Management", "Research Collaboration", {"weight": 0.6, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Marine Biodiversity Management", "Private Sector Analysis", {"weight": 0.4, "confidence": 0.27999999999999997, "type": "inter_cluster", "style": "solid"}], ["Research Collaboration", "Marine Biodiversity Management", {"weight": 1.0, "confidence": 0.82, "type": "inter_cluster", "style": "solid"}], ["Research Collaboration", "Private Sector Analysis", {"weight": 0.8, "confidence": 0.5599999999999999, "type": "inter_cluster", "style": "solid"}], ["Research Collaboration", "Management Practices", {"weight": 0.6, "confidence": 0.44000000000000006, "type": "inter_cluster", "style": "solid"}], ["Research Collaboration", "Policy Implementation", {"weight": 0.4, "confidence": 0.27999999999999997, "type": "inter_cluster", "style": "solid"}], ["Policy Implementation", "Research Collaboration", {"weight": 0.8, "confidence": 0.5999999999999999, "type": "inter_cluster", "style": "solid"}], ["Policy Implementation", "Marine Biodiversity Management", {"weight": 0.8, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Policy Implementation", "Management Practices", {"weight": 0.8, "confidence": 0.63, "type": "inter_cluster", "style": "solid"}], ["Policy Implementation", "Private Sector Analysis", {"weight": 0.6, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Management Practices", "Private Sector Analysis", {"weight": 0.8, "confidence": 0.5900000000000001, "type": "inter_cluster", "style": "solid"}], ["Management Practices", "Marine Biodiversity Management", {"weight": 0.6, "confidence": 0.47000000000000003, "type": "inter_cluster", "style": "solid"}], ["Management Practices", "Policy Implementation", {"weight": 0.6, "confidence": 0.36, "type": "inter_cluster", "style": "solid"}], ["Management Practices", "Research Collaboration", {"weight": 0.4, "confidence": 0.27999999999999997, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Private Sector Analysis": [["private sector risk models", {"concepts": "private sector risk models", "type": "concept", "cluster": "Private Sector Analysis", "node_size": 10, "label": "private sector risk models"}], ["private sector", {"concepts": "private sector", "type": "concept", "cluster": "Private Sector Analysis", "node_size": 10, "label": "private sector"}], ["benefit cost analysis", {"concepts": "benefit cost analysis", "type": "concept", "cluster": "Private Sector Analysis", "node_size": 10, "label": "benefit cost analysis"}]], "Marine Biodiversity Management": [["community structure", {"concepts": "community structure", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "community structure"}], ["marine outcomes", {"concepts": "marine outcomes", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marine outcomes"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "biodiversity"}], ["mangroves", {"concepts": "mangroves", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "mangroves"}], ["conservation organizations", {"concepts": "conservation organizations", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "conservation organizations"}], ["functional understanding", {"concepts": "functional understanding", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional understanding"}], ["species richness", {"concepts": "species richness", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species richness"}], ["marshes", {"concepts": "marshes", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marshes"}], ["habitat-forming species", {"concepts": "habitat-forming species", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "habitat-forming species"}], ["individual species management", {"concepts": "individual species management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "individual species management"}], ["ecosystem interactions", {"concepts": "ecosystem interactions", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecosystem interactions"}], ["coastal ecosystem restoration", {"concepts": "coastal ecosystem restoration", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "coastal ecosystem restoration"}], ["conservation actions", {"concepts": "conservation actions", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "conservation actions"}], ["functional data", {"concepts": "functional data", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional data"}], ["ecosystem service valuation", {"concepts": "ecosystem service valuation", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecosystem service valuation"}], ["oyster reefs", {"concepts": "oyster reefs", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "oyster reefs"}], ["conservation concern species", {"concepts": "conservation concern species", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "conservation concern species"}], ["food web-supporting species", {"concepts": "food web-supporting species", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "food web-supporting species"}], ["biogeochemistry", {"concepts": "biogeochemistry", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "biogeochemistry"}], ["estuary manager", {"concepts": "estuary manager", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "estuary manager"}], ["habitat function", {"concepts": "habitat function", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "habitat function"}], ["facilitation functions", {"concepts": "facilitation functions", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "facilitation functions"}], ["water quality", {"concepts": "water quality", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "water quality"}], ["fishery manager", {"concepts": "fishery manager", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "fishery manager"}], ["natural resource management", {"concepts": "natural resource management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "natural resource management"}], ["estuary", {"concepts": "estuary", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "estuary"}], ["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marine resource management"}], ["biodiversity information", {"concepts": "biodiversity information", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "biodiversity information"}], ["fishery landings", {"concepts": "fishery landings", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "fishery landings"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species of conservation concern"}], ["functional mechanism", {"concepts": "functional mechanism", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional mechanism"}], ["habitat-associated function", {"concepts": "habitat-associated function", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "habitat-associated function"}], ["functional diversity", {"concepts": "functional diversity", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "functional diversity"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "harmful organisms"}], ["coral reefs", {"concepts": "coral reefs", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "coral reefs"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species diversity"}], ["marine management", {"concepts": "marine management", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "marine management"}], ["diversity-function relationship", {"concepts": "diversity-function relationship", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "diversity-function relationship"}], ["ecological information", {"concepts": "ecological information", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecological information"}], ["nutrient cycling", {"concepts": "nutrient cycling", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "nutrient cycling"}], ["coastal wetlands", {"concepts": "coastal wetlands", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "coastal wetlands"}], ["flood risk reduction", {"concepts": "flood risk reduction", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "flood risk reduction"}], ["species data", {"concepts": "species data", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "species data"}], ["ecosystem services", {"concepts": "ecosystem services", "type": "concept", "cluster": "Marine Biodiversity Management", "node_size": 10, "label": "ecosystem services"}]], "Research Collaboration": [["state water board", {"concepts": "state water board", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "state water board"}], ["agency", {"concepts": "agency", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "agency"}], ["researchers", {"concepts": "researchers", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "researchers"}], ["barriers", {"concepts": "barriers", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "barriers"}], ["considerations", {"concepts": "considerations", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "considerations"}], ["us eez", {"concepts": "us eez", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "us eez"}], ["rapid insight mechanisms", {"concepts": "rapid insight mechanisms", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "rapid insight mechanisms"}], ["outcomes", {"concepts": "outcomes", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "outcomes"}], ["impacts", {"concepts": "impacts", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "impacts"}], ["parameters", {"concepts": "parameters", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "parameters"}], ["risk models", {"concepts": "risk models", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "risk models"}], ["problem-oriented engagement", {"concepts": "problem-oriented engagement", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "problem-oriented engagement"}], ["organizational narrative", {"concepts": "organizational narrative", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "organizational narrative"}], ["nature-based solutions", {"concepts": "nature-based solutions", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "nature-based solutions"}], ["expertise", {"concepts": "expertise", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "expertise"}], ["ngo research", {"concepts": "ngo research", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "ngo research"}], ["conservation", {"concepts": "conservation", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "conservation"}], ["academic research", {"concepts": "academic research", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "academic research"}], ["public repository", {"concepts": "public repository", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "public repository"}], ["ngo management", {"concepts": "ngo management", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "ngo management"}], ["practitioners", {"concepts": "practitioners", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "practitioners"}], ["science-based framework", {"concepts": "science-based framework", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "science-based framework"}], ["analysis", {"concepts": "analysis", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "analysis"}], ["synthesis", {"concepts": "synthesis", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "synthesis"}], ["collaboration", {"concepts": "collaboration", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "collaboration"}], ["wind attenuation", {"concepts": "wind attenuation", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "wind attenuation"}], ["carbon", {"concepts": "carbon", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "carbon"}], ["funding", {"concepts": "funding", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "funding"}], ["science perspective", {"concepts": "science perspective", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "science perspective"}], ["dunes", {"concepts": "dunes", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "dunes"}], ["sectors", {"concepts": "sectors", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "sectors"}], ["noaa", {"concepts": "noaa", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "noaa"}], ["effectiveness", {"concepts": "effectiveness", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "effectiveness"}], ["phd researcher", {"concepts": "phd researcher", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "phd researcher"}], ["science side", {"concepts": "science side", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "science side"}], ["organizational interface", {"concepts": "organizational interface", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "organizational interface"}], ["boundary organizations", {"concepts": "boundary organizations", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "boundary organizations"}], ["universities", {"concepts": "universities", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "universities"}], ["evidence-based interpretation", {"concepts": "evidence-based interpretation", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "evidence-based interpretation"}], ["applied research", {"concepts": "applied research", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "applied research"}], ["data limitations", {"concepts": "data limitations", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "data limitations"}], ["research communities", {"concepts": "research communities", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "research communities"}], ["silos", {"concepts": "silos", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "silos"}], ["indicators", {"concepts": "indicators", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "indicators"}], ["models", {"concepts": "models", "type": "concept", "cluster": "Research Collaboration", "node_size": 10, "label": "models"}]], "Policy Implementation": [["policy side", {"concepts": "policy side", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy side"}], ["federal policy", {"concepts": "federal policy", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "federal policy"}], ["policy implementation", {"concepts": "policy implementation", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy implementation"}], ["policy intention", {"concepts": "policy intention", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy intention"}], ["policy language", {"concepts": "policy language", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy language"}], ["grant programs", {"concepts": "grant programs", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "grant programs"}], ["multilateral negotiations", {"concepts": "multilateral negotiations", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "multilateral negotiations"}], ["farm bill programs", {"concepts": "farm bill programs", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "farm bill programs"}], ["science-policy interface", {"concepts": "science-policy interface", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "science-policy interface"}], ["policy", {"concepts": "policy", "type": "concept", "cluster": "Policy Implementation", "node_size": 10, "label": "policy"}]], "Management Practices": [["system-based management", {"concepts": "system-based management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "system-based management"}], ["decision makers", {"concepts": "decision makers", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "decision makers"}], ["managers", {"concepts": "managers", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "managers"}], ["stock management", {"concepts": "stock management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "stock management"}], ["management decisions", {"concepts": "management decisions", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management decisions"}], ["prioritization", {"concepts": "prioritization", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "prioritization"}], ["partnership management", {"concepts": "partnership management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "partnership management"}], ["management objectives", {"concepts": "management objectives", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management objectives"}], ["capacity constraints", {"concepts": "capacity constraints", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "capacity constraints"}], ["green management", {"concepts": "green management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "green management"}], ["planning process", {"concepts": "planning process", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "planning process"}], ["resource management", {"concepts": "resource management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "resource management"}], ["management context", {"concepts": "management context", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management context"}], ["system-oriented management", {"concepts": "system-oriented management", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "system-oriented management"}], ["planning processes", {"concepts": "planning processes", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "planning processes"}], ["management capacity", {"concepts": "management capacity", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management capacity"}], ["management interventions", {"concepts": "management interventions", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management interventions"}], ["management processes", {"concepts": "management processes", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management processes"}], ["management practices", {"concepts": "management practices", "type": "concept", "cluster": "Management Practices", "node_size": 10, "label": "management practices"}]]};
        const clusterEdges = {"Private Sector Analysis": [], "Marine Biodiversity Management": [], "Research Collaboration": [], "Policy Implementation": [], "Management Practices": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

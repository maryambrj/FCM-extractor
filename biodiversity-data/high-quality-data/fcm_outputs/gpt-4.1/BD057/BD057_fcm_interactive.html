
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Tube-Building Fauna": {"concepts": "tube building, deep-burrowing, surface burrowing, burrowing fauna", "concept_list": ["tube building", "deep-burrowing", "surface burrowing", "burrowing fauna"], "type": "cluster", "node_size": 27, "label": "Tube-Building Fauna"}, "Biodiversity Assessment": {"concepts": "enclosure, tube building fauna", "concept_list": ["enclosure", "tube building fauna"], "type": "cluster", "node_size": 21, "label": "Biodiversity Assessment"}, "Benthic Ecology": {"concepts": "condition categories, tolerant species, quantitative assessment, willingness to support, habitat destruction, species diversity, research focus, mosaics, causal link, functional groups, epifauna, index of biotic integrity, beauty of nature, habitat forming species, condition assessment, camera systems, non-regulatory management, office of research and development, cartography, beaches, assessment tools, conservation concern, ecological condition, regulatory purposes, food web, management decisions, environmental improvement, decision making, creeks, ecosystem, food web supporting species, sensitive species, variability, noaa, habitat biodiversity, biodiversity components, functional group diversity, index score, research and development, cmecs, indirect measure, biodiversity assessment, square meter count, scoring framework, ecosystem health, taxonomy, contract staff, microfauna, decay, healthy ecosystem, healthy ecosystems, data sets, index, development, stressors, enjoyment of nature, human effects, condition prediction, visual assessment, community benefits, management approaches, stratification, functional group biodiversity, harmful organisms, epa, biodiversity, bioassessment, functional diversity, environmental support, mental models, plankton, fishing, habitat diversity, functional group, ecosystem services, tolerance indices, imaging, species of conservation concern, assessment framework, species tolerance, ecological classification", "concept_list": ["condition categories", "tolerant species", "quantitative assessment", "willingness to support", "habitat destruction", "species diversity", "research focus", "mosaics", "causal link", "functional groups", "epifauna", "index of biotic integrity", "beauty of nature", "habitat forming species", "condition assessment", "camera systems", "non-regulatory management", "office of research and development", "cartography", "beaches", "assessment tools", "conservation concern", "ecological condition", "regulatory purposes", "food web", "management decisions", "environmental improvement", "decision making", "creeks", "ecosystem", "food web supporting species", "sensitive species", "variability", "noaa", "habitat biodiversity", "biodiversity components", "functional group diversity", "index score", "research and development", "cmecs", "indirect measure", "biodiversity assessment", "square meter count", "scoring framework", "ecosystem health", "taxonomy", "contract staff", "microfauna", "decay", "healthy ecosystem", "healthy ecosystems", "data sets", "index", "development", "stressors", "enjoyment of nature", "human effects", "condition prediction", "visual assessment", "community benefits", "management approaches", "stratification", "functional group biodiversity", "harmful organisms", "epa", "biodiversity", "bioassessment", "functional diversity", "environmental support", "mental models", "plankton", "fishing", "habitat diversity", "functional group", "ecosystem services", "tolerance indices", "imaging", "species of conservation concern", "assessment framework", "species tolerance", "ecological classification"], "type": "cluster", "node_size": 258, "label": "Benthic Ecology"}, "Burrowing Behavior": {"concepts": "plant growth, hypoxia, marine setting, estuarine ecology, fauna categories, deepwater habitats, oxygen gradient, nutrient levels, sewage, benthic bioassessment, seafloor, seafloor fauna, wind energy, salt marsh, seagrass, salt marshes, benthic fauna, benthos diversity, nutrient input, dissolved oxygen, sewage stream, freshwater, anoxia, macroalgae, benthic habitat, sediment analysis, benthos, seafloor analysis, shallow water habitats, nutrient runoff, benthic diversity, seagrass loss, marshes, macrofauna, oxygen depletion", "concept_list": ["plant growth", "hypoxia", "marine setting", "estuarine ecology", "fauna categories", "deepwater habitats", "oxygen gradient", "nutrient levels", "sewage", "benthic bioassessment", "seafloor", "seafloor fauna", "wind energy", "salt marsh", "seagrass", "salt marshes", "benthic fauna", "benthos diversity", "nutrient input", "dissolved oxygen", "sewage stream", "freshwater", "anoxia", "macroalgae", "benthic habitat", "sediment analysis", "benthos", "seafloor analysis", "shallow water habitats", "nutrient runoff", "benthic diversity", "seagrass loss", "marshes", "macrofauna", "oxygen depletion"], "type": "cluster", "node_size": 120, "label": "Burrowing Behavior"}};
        const conceptData = {"tube building": {"concepts": "tube building", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "tube building"}, "deep-burrowing": {"concepts": "deep-burrowing", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "deep-burrowing"}, "surface burrowing": {"concepts": "surface burrowing", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "surface burrowing"}, "burrowing fauna": {"concepts": "burrowing fauna", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "burrowing fauna"}, "enclosure": {"concepts": "enclosure", "type": "concept", "cluster": "Biodiversity Assessment", "node_size": 10, "label": "enclosure"}, "tube building fauna": {"concepts": "tube building fauna", "type": "concept", "cluster": "Biodiversity Assessment", "node_size": 10, "label": "tube building fauna"}, "condition categories": {"concepts": "condition categories", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "condition categories"}, "tolerant species": {"concepts": "tolerant species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "tolerant species"}, "quantitative assessment": {"concepts": "quantitative assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "quantitative assessment"}, "willingness to support": {"concepts": "willingness to support", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "willingness to support"}, "habitat destruction": {"concepts": "habitat destruction", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat destruction"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "species diversity"}, "research focus": {"concepts": "research focus", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "research focus"}, "mosaics": {"concepts": "mosaics", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "mosaics"}, "causal link": {"concepts": "causal link", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "causal link"}, "functional groups": {"concepts": "functional groups", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional groups"}, "epifauna": {"concepts": "epifauna", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "epifauna"}, "index of biotic integrity": {"concepts": "index of biotic integrity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "index of biotic integrity"}, "beauty of nature": {"concepts": "beauty of nature", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "beauty of nature"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat forming species"}, "condition assessment": {"concepts": "condition assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "condition assessment"}, "camera systems": {"concepts": "camera systems", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "camera systems"}, "non-regulatory management": {"concepts": "non-regulatory management", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "non-regulatory management"}, "office of research and development": {"concepts": "office of research and development", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "office of research and development"}, "cartography": {"concepts": "cartography", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "cartography"}, "beaches": {"concepts": "beaches", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "beaches"}, "assessment tools": {"concepts": "assessment tools", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "assessment tools"}, "conservation concern": {"concepts": "conservation concern", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "conservation concern"}, "ecological condition": {"concepts": "ecological condition", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecological condition"}, "regulatory purposes": {"concepts": "regulatory purposes", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "regulatory purposes"}, "food web": {"concepts": "food web", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "food web"}, "management decisions": {"concepts": "management decisions", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "management decisions"}, "environmental improvement": {"concepts": "environmental improvement", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "environmental improvement"}, "decision making": {"concepts": "decision making", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "decision making"}, "creeks": {"concepts": "creeks", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "creeks"}, "ecosystem": {"concepts": "ecosystem", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecosystem"}, "food web supporting species": {"concepts": "food web supporting species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "food web supporting species"}, "sensitive species": {"concepts": "sensitive species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "sensitive species"}, "variability": {"concepts": "variability", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "variability"}, "noaa": {"concepts": "noaa", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "noaa"}, "habitat biodiversity": {"concepts": "habitat biodiversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat biodiversity"}, "biodiversity components": {"concepts": "biodiversity components", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "biodiversity components"}, "functional group diversity": {"concepts": "functional group diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional group diversity"}, "index score": {"concepts": "index score", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "index score"}, "research and development": {"concepts": "research and development", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "research and development"}, "cmecs": {"concepts": "cmecs", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "cmecs"}, "indirect measure": {"concepts": "indirect measure", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "indirect measure"}, "biodiversity assessment": {"concepts": "biodiversity assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "biodiversity assessment"}, "square meter count": {"concepts": "square meter count", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "square meter count"}, "scoring framework": {"concepts": "scoring framework", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "scoring framework"}, "ecosystem health": {"concepts": "ecosystem health", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecosystem health"}, "taxonomy": {"concepts": "taxonomy", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "taxonomy"}, "contract staff": {"concepts": "contract staff", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "contract staff"}, "microfauna": {"concepts": "microfauna", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "microfauna"}, "decay": {"concepts": "decay", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "decay"}, "healthy ecosystem": {"concepts": "healthy ecosystem", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "healthy ecosystem"}, "healthy ecosystems": {"concepts": "healthy ecosystems", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "healthy ecosystems"}, "data sets": {"concepts": "data sets", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "data sets"}, "index": {"concepts": "index", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "index"}, "development": {"concepts": "development", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "development"}, "stressors": {"concepts": "stressors", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "stressors"}, "enjoyment of nature": {"concepts": "enjoyment of nature", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "enjoyment of nature"}, "human effects": {"concepts": "human effects", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "human effects"}, "condition prediction": {"concepts": "condition prediction", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "condition prediction"}, "visual assessment": {"concepts": "visual assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "visual assessment"}, "community benefits": {"concepts": "community benefits", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "community benefits"}, "management approaches": {"concepts": "management approaches", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "management approaches"}, "stratification": {"concepts": "stratification", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "stratification"}, "functional group biodiversity": {"concepts": "functional group biodiversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional group biodiversity"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "harmful organisms"}, "epa": {"concepts": "epa", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "epa"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "biodiversity"}, "bioassessment": {"concepts": "bioassessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "bioassessment"}, "functional diversity": {"concepts": "functional diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional diversity"}, "environmental support": {"concepts": "environmental support", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "environmental support"}, "mental models": {"concepts": "mental models", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "mental models"}, "plankton": {"concepts": "plankton", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "plankton"}, "fishing": {"concepts": "fishing", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "fishing"}, "habitat diversity": {"concepts": "habitat diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat diversity"}, "functional group": {"concepts": "functional group", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional group"}, "ecosystem services": {"concepts": "ecosystem services", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecosystem services"}, "tolerance indices": {"concepts": "tolerance indices", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "tolerance indices"}, "imaging": {"concepts": "imaging", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "imaging"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "species of conservation concern"}, "assessment framework": {"concepts": "assessment framework", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "assessment framework"}, "species tolerance": {"concepts": "species tolerance", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "species tolerance"}, "ecological classification": {"concepts": "ecological classification", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecological classification"}, "plant growth": {"concepts": "plant growth", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "plant growth"}, "hypoxia": {"concepts": "hypoxia", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "hypoxia"}, "marine setting": {"concepts": "marine setting", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "marine setting"}, "estuarine ecology": {"concepts": "estuarine ecology", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "estuarine ecology"}, "fauna categories": {"concepts": "fauna categories", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "fauna categories"}, "deepwater habitats": {"concepts": "deepwater habitats", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "deepwater habitats"}, "oxygen gradient": {"concepts": "oxygen gradient", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "oxygen gradient"}, "nutrient levels": {"concepts": "nutrient levels", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "nutrient levels"}, "sewage": {"concepts": "sewage", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "sewage"}, "benthic bioassessment": {"concepts": "benthic bioassessment", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic bioassessment"}, "seafloor": {"concepts": "seafloor", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seafloor"}, "seafloor fauna": {"concepts": "seafloor fauna", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seafloor fauna"}, "wind energy": {"concepts": "wind energy", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "wind energy"}, "salt marsh": {"concepts": "salt marsh", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "salt marsh"}, "seagrass": {"concepts": "seagrass", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seagrass"}, "salt marshes": {"concepts": "salt marshes", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "salt marshes"}, "benthic fauna": {"concepts": "benthic fauna", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic fauna"}, "benthos diversity": {"concepts": "benthos diversity", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthos diversity"}, "nutrient input": {"concepts": "nutrient input", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "nutrient input"}, "dissolved oxygen": {"concepts": "dissolved oxygen", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "dissolved oxygen"}, "sewage stream": {"concepts": "sewage stream", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "sewage stream"}, "freshwater": {"concepts": "freshwater", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "freshwater"}, "anoxia": {"concepts": "anoxia", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "anoxia"}, "macroalgae": {"concepts": "macroalgae", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "macroalgae"}, "benthic habitat": {"concepts": "benthic habitat", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic habitat"}, "sediment analysis": {"concepts": "sediment analysis", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "sediment analysis"}, "benthos": {"concepts": "benthos", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthos"}, "seafloor analysis": {"concepts": "seafloor analysis", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seafloor analysis"}, "shallow water habitats": {"concepts": "shallow water habitats", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "shallow water habitats"}, "nutrient runoff": {"concepts": "nutrient runoff", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "nutrient runoff"}, "benthic diversity": {"concepts": "benthic diversity", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic diversity"}, "seagrass loss": {"concepts": "seagrass loss", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seagrass loss"}, "marshes": {"concepts": "marshes", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "marshes"}, "macrofauna": {"concepts": "macrofauna", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "macrofauna"}, "oxygen depletion": {"concepts": "oxygen depletion", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "oxygen depletion"}};
        const interClusterEdges = [["Tube-Building Fauna", "Burrowing Behavior", {"weight": 0.6, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Tube-Building Fauna", "Benthic Ecology", {"weight": 0.4, "confidence": 0.32, "type": "inter_cluster", "style": "solid"}], ["Tube-Building Fauna", "Biodiversity Assessment", {"weight": 0.4, "confidence": 0.27, "type": "inter_cluster", "style": "solid"}], ["Biodiversity Assessment", "Benthic Ecology", {"weight": 0.6, "confidence": 0.41999999999999993, "type": "inter_cluster", "style": "solid"}], ["Biodiversity Assessment", "Tube-Building Fauna", {"weight": 0.6, "confidence": 0.4800000000000001, "type": "inter_cluster", "style": "solid"}], ["Biodiversity Assessment", "Burrowing Behavior", {"weight": 0.4, "confidence": 0.24, "type": "inter_cluster", "style": "solid"}], ["Benthic Ecology", "Burrowing Behavior", {"weight": 0.4, "confidence": 0.27999999999999997, "type": "inter_cluster", "style": "solid"}], ["Benthic Ecology", "Biodiversity Assessment", {"weight": 0.2, "confidence": 0.15, "type": "inter_cluster", "style": "solid"}], ["Burrowing Behavior", "Benthic Ecology", {"weight": 0.8, "confidence": 0.62, "type": "inter_cluster", "style": "solid"}], ["Burrowing Behavior", "Tube-Building Fauna", {"weight": 0.4, "confidence": 0.62, "type": "inter_cluster", "style": "solid"}], ["Burrowing Behavior", "Biodiversity Assessment", {"weight": 0.4, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Tube-Building Fauna": [["tube building", {"concepts": "tube building", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "tube building"}], ["deep-burrowing", {"concepts": "deep-burrowing", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "deep-burrowing"}], ["surface burrowing", {"concepts": "surface burrowing", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "surface burrowing"}], ["burrowing fauna", {"concepts": "burrowing fauna", "type": "concept", "cluster": "Tube-Building Fauna", "node_size": 10, "label": "burrowing fauna"}]], "Biodiversity Assessment": [["enclosure", {"concepts": "enclosure", "type": "concept", "cluster": "Biodiversity Assessment", "node_size": 10, "label": "enclosure"}], ["tube building fauna", {"concepts": "tube building fauna", "type": "concept", "cluster": "Biodiversity Assessment", "node_size": 10, "label": "tube building fauna"}]], "Benthic Ecology": [["condition categories", {"concepts": "condition categories", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "condition categories"}], ["tolerant species", {"concepts": "tolerant species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "tolerant species"}], ["quantitative assessment", {"concepts": "quantitative assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "quantitative assessment"}], ["willingness to support", {"concepts": "willingness to support", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "willingness to support"}], ["habitat destruction", {"concepts": "habitat destruction", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat destruction"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "species diversity"}], ["research focus", {"concepts": "research focus", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "research focus"}], ["mosaics", {"concepts": "mosaics", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "mosaics"}], ["causal link", {"concepts": "causal link", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "causal link"}], ["functional groups", {"concepts": "functional groups", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional groups"}], ["epifauna", {"concepts": "epifauna", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "epifauna"}], ["index of biotic integrity", {"concepts": "index of biotic integrity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "index of biotic integrity"}], ["beauty of nature", {"concepts": "beauty of nature", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "beauty of nature"}], ["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat forming species"}], ["condition assessment", {"concepts": "condition assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "condition assessment"}], ["camera systems", {"concepts": "camera systems", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "camera systems"}], ["non-regulatory management", {"concepts": "non-regulatory management", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "non-regulatory management"}], ["office of research and development", {"concepts": "office of research and development", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "office of research and development"}], ["cartography", {"concepts": "cartography", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "cartography"}], ["beaches", {"concepts": "beaches", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "beaches"}], ["assessment tools", {"concepts": "assessment tools", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "assessment tools"}], ["conservation concern", {"concepts": "conservation concern", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "conservation concern"}], ["ecological condition", {"concepts": "ecological condition", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecological condition"}], ["regulatory purposes", {"concepts": "regulatory purposes", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "regulatory purposes"}], ["food web", {"concepts": "food web", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "food web"}], ["management decisions", {"concepts": "management decisions", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "management decisions"}], ["environmental improvement", {"concepts": "environmental improvement", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "environmental improvement"}], ["decision making", {"concepts": "decision making", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "decision making"}], ["creeks", {"concepts": "creeks", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "creeks"}], ["ecosystem", {"concepts": "ecosystem", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecosystem"}], ["food web supporting species", {"concepts": "food web supporting species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "food web supporting species"}], ["sensitive species", {"concepts": "sensitive species", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "sensitive species"}], ["variability", {"concepts": "variability", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "variability"}], ["noaa", {"concepts": "noaa", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "noaa"}], ["habitat biodiversity", {"concepts": "habitat biodiversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat biodiversity"}], ["biodiversity components", {"concepts": "biodiversity components", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "biodiversity components"}], ["functional group diversity", {"concepts": "functional group diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional group diversity"}], ["index score", {"concepts": "index score", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "index score"}], ["research and development", {"concepts": "research and development", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "research and development"}], ["cmecs", {"concepts": "cmecs", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "cmecs"}], ["indirect measure", {"concepts": "indirect measure", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "indirect measure"}], ["biodiversity assessment", {"concepts": "biodiversity assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "biodiversity assessment"}], ["square meter count", {"concepts": "square meter count", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "square meter count"}], ["scoring framework", {"concepts": "scoring framework", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "scoring framework"}], ["ecosystem health", {"concepts": "ecosystem health", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecosystem health"}], ["taxonomy", {"concepts": "taxonomy", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "taxonomy"}], ["contract staff", {"concepts": "contract staff", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "contract staff"}], ["microfauna", {"concepts": "microfauna", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "microfauna"}], ["decay", {"concepts": "decay", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "decay"}], ["healthy ecosystem", {"concepts": "healthy ecosystem", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "healthy ecosystem"}], ["healthy ecosystems", {"concepts": "healthy ecosystems", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "healthy ecosystems"}], ["data sets", {"concepts": "data sets", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "data sets"}], ["index", {"concepts": "index", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "index"}], ["development", {"concepts": "development", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "development"}], ["stressors", {"concepts": "stressors", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "stressors"}], ["enjoyment of nature", {"concepts": "enjoyment of nature", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "enjoyment of nature"}], ["human effects", {"concepts": "human effects", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "human effects"}], ["condition prediction", {"concepts": "condition prediction", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "condition prediction"}], ["visual assessment", {"concepts": "visual assessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "visual assessment"}], ["community benefits", {"concepts": "community benefits", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "community benefits"}], ["management approaches", {"concepts": "management approaches", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "management approaches"}], ["stratification", {"concepts": "stratification", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "stratification"}], ["functional group biodiversity", {"concepts": "functional group biodiversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional group biodiversity"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "harmful organisms"}], ["epa", {"concepts": "epa", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "epa"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "biodiversity"}], ["bioassessment", {"concepts": "bioassessment", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "bioassessment"}], ["functional diversity", {"concepts": "functional diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional diversity"}], ["environmental support", {"concepts": "environmental support", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "environmental support"}], ["mental models", {"concepts": "mental models", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "mental models"}], ["plankton", {"concepts": "plankton", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "plankton"}], ["fishing", {"concepts": "fishing", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "fishing"}], ["habitat diversity", {"concepts": "habitat diversity", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "habitat diversity"}], ["functional group", {"concepts": "functional group", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "functional group"}], ["ecosystem services", {"concepts": "ecosystem services", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecosystem services"}], ["tolerance indices", {"concepts": "tolerance indices", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "tolerance indices"}], ["imaging", {"concepts": "imaging", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "imaging"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "species of conservation concern"}], ["assessment framework", {"concepts": "assessment framework", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "assessment framework"}], ["species tolerance", {"concepts": "species tolerance", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "species tolerance"}], ["ecological classification", {"concepts": "ecological classification", "type": "concept", "cluster": "Benthic Ecology", "node_size": 10, "label": "ecological classification"}]], "Burrowing Behavior": [["plant growth", {"concepts": "plant growth", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "plant growth"}], ["hypoxia", {"concepts": "hypoxia", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "hypoxia"}], ["marine setting", {"concepts": "marine setting", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "marine setting"}], ["estuarine ecology", {"concepts": "estuarine ecology", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "estuarine ecology"}], ["fauna categories", {"concepts": "fauna categories", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "fauna categories"}], ["deepwater habitats", {"concepts": "deepwater habitats", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "deepwater habitats"}], ["oxygen gradient", {"concepts": "oxygen gradient", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "oxygen gradient"}], ["nutrient levels", {"concepts": "nutrient levels", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "nutrient levels"}], ["sewage", {"concepts": "sewage", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "sewage"}], ["benthic bioassessment", {"concepts": "benthic bioassessment", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic bioassessment"}], ["seafloor", {"concepts": "seafloor", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seafloor"}], ["seafloor fauna", {"concepts": "seafloor fauna", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seafloor fauna"}], ["wind energy", {"concepts": "wind energy", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "wind energy"}], ["salt marsh", {"concepts": "salt marsh", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "salt marsh"}], ["seagrass", {"concepts": "seagrass", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seagrass"}], ["salt marshes", {"concepts": "salt marshes", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "salt marshes"}], ["benthic fauna", {"concepts": "benthic fauna", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic fauna"}], ["benthos diversity", {"concepts": "benthos diversity", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthos diversity"}], ["nutrient input", {"concepts": "nutrient input", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "nutrient input"}], ["dissolved oxygen", {"concepts": "dissolved oxygen", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "dissolved oxygen"}], ["sewage stream", {"concepts": "sewage stream", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "sewage stream"}], ["freshwater", {"concepts": "freshwater", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "freshwater"}], ["anoxia", {"concepts": "anoxia", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "anoxia"}], ["macroalgae", {"concepts": "macroalgae", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "macroalgae"}], ["benthic habitat", {"concepts": "benthic habitat", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic habitat"}], ["sediment analysis", {"concepts": "sediment analysis", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "sediment analysis"}], ["benthos", {"concepts": "benthos", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthos"}], ["seafloor analysis", {"concepts": "seafloor analysis", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seafloor analysis"}], ["shallow water habitats", {"concepts": "shallow water habitats", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "shallow water habitats"}], ["nutrient runoff", {"concepts": "nutrient runoff", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "nutrient runoff"}], ["benthic diversity", {"concepts": "benthic diversity", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "benthic diversity"}], ["seagrass loss", {"concepts": "seagrass loss", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "seagrass loss"}], ["marshes", {"concepts": "marshes", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "marshes"}], ["macrofauna", {"concepts": "macrofauna", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "macrofauna"}], ["oxygen depletion", {"concepts": "oxygen depletion", "type": "concept", "cluster": "Burrowing Behavior", "node_size": 10, "label": "oxygen depletion"}]]};
        const clusterEdges = {"Tube-Building Fauna": [], "Biodiversity Assessment": [], "Benthic Ecology": [], "Burrowing Behavior": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

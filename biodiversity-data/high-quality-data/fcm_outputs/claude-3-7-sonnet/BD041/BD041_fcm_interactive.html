
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Marine Conservation & Fisheries": {"concepts": "fisheries policy, marine environment, oyster reefs, oysters, marine biology, oyster reef restoration, marine conservation, oil spill assessment, shellfish predation, coral reefs, aquatic biology, anadromous fish, sea turtles, coastal resilience, marine assessment, wetland filling, coastal ecosystem, marine mammals, coastal ecosystems, marine ecology, marine policy, marine resource management", "concept_list": ["fisheries policy", "marine environment", "oyster reefs", "oysters", "marine biology", "oyster reef restoration", "marine conservation", "oil spill assessment", "shellfish predation", "coral reefs", "aquatic biology", "anadromous fish", "sea turtles", "coastal resilience", "marine assessment", "wetland filling", "coastal ecosystem", "marine mammals", "coastal ecosystems", "marine ecology", "marine policy", "marine resource management"], "type": "cluster", "node_size": 81, "label": "Marine Conservation & Fisheries"}, "Ecosystem Health Assessment": {"concepts": "sedimentation, management effectiveness, ecosystem protections, harmful organisms, mangrove forests, quantitative process, gulf of mexico, interviews, biodiversity, food sources, relationships, habitat forming species, qualitative process, healthy ecosystems, ecosystem components, ecosystem balance, diagnoses, species diversity, symptoms, broad ecosystem protection, top predators, environmental determinants, natural inventory, conservation concern, native organism abundance, stakeholders, management approaches, pollutants, population quantification, physiological systems, treatments, key food web supporting species, concepts, everglades restoration, travel arrangements, contaminants, nutrient influx, access to resources, baseline biodiversity data, importation bans, behavioral patterns, species of conservation concern, invasive species removal, qualitative aggregation, food chain, food web, healthy ecosystem, southern us division, emotional states, ecosystem protection, ecosystem health, nature conservancy, biodiversity definition, tropical storms, geospatial analysis, workshop, bacteria, invasive species, population growth, experts, travel office, sea level rise, mapping, ecosystem models, conservation actions, blue carbon, no-take areas, excess nutrients, ecosystem restoration, storm surge, species distribution, cognitive functions, species interactions, microbial communities, upstream management, no take areas, mental health conditions, support systems", "concept_list": ["sedimentation", "management effectiveness", "ecosystem protections", "harmful organisms", "mangrove forests", "quantitative process", "gulf of mexico", "interviews", "biodiversity", "food sources", "relationships", "habitat forming species", "qualitative process", "healthy ecosystems", "ecosystem components", "ecosystem balance", "diagnoses", "species diversity", "symptoms", "broad ecosystem protection", "top predators", "environmental determinants", "natural inventory", "conservation concern", "native organism abundance", "stakeholders", "management approaches", "pollutants", "population quantification", "physiological systems", "treatments", "key food web supporting species", "concepts", "everglades restoration", "travel arrangements", "contaminants", "nutrient influx", "access to resources", "baseline biodiversity data", "importation bans", "behavioral patterns", "species of conservation concern", "invasive species removal", "qualitative aggregation", "food chain", "food web", "healthy ecosystem", "southern us division", "emotional states", "ecosystem protection", "ecosystem health", "nature conservancy", "biodiversity definition", "tropical storms", "geospatial analysis", "workshop", "bacteria", "invasive species", "population growth", "experts", "travel office", "sea level rise", "mapping", "ecosystem models", "conservation actions", "blue carbon", "no-take areas", "excess nutrients", "ecosystem restoration", "storm surge", "species distribution", "cognitive functions", "species interactions", "microbial communities", "upstream management", "no take areas", "mental health conditions", "support systems"], "type": "cluster", "node_size": 249, "label": "Ecosystem Health Assessment"}};
        const conceptData = {"fisheries policy": {"concepts": "fisheries policy", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "fisheries policy"}, "marine environment": {"concepts": "marine environment", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine environment"}, "oyster reefs": {"concepts": "oyster reefs", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oyster reefs"}, "oysters": {"concepts": "oysters", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oysters"}, "marine biology": {"concepts": "marine biology", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine biology"}, "oyster reef restoration": {"concepts": "oyster reef restoration", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oyster reef restoration"}, "marine conservation": {"concepts": "marine conservation", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine conservation"}, "oil spill assessment": {"concepts": "oil spill assessment", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oil spill assessment"}, "shellfish predation": {"concepts": "shellfish predation", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "shellfish predation"}, "coral reefs": {"concepts": "coral reefs", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coral reefs"}, "aquatic biology": {"concepts": "aquatic biology", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "aquatic biology"}, "anadromous fish": {"concepts": "anadromous fish", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "anadromous fish"}, "sea turtles": {"concepts": "sea turtles", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "sea turtles"}, "coastal resilience": {"concepts": "coastal resilience", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coastal resilience"}, "marine assessment": {"concepts": "marine assessment", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine assessment"}, "wetland filling": {"concepts": "wetland filling", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "wetland filling"}, "coastal ecosystem": {"concepts": "coastal ecosystem", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coastal ecosystem"}, "marine mammals": {"concepts": "marine mammals", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine mammals"}, "coastal ecosystems": {"concepts": "coastal ecosystems", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coastal ecosystems"}, "marine ecology": {"concepts": "marine ecology", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine ecology"}, "marine policy": {"concepts": "marine policy", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine policy"}, "marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine resource management"}, "sedimentation": {"concepts": "sedimentation", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "sedimentation"}, "management effectiveness": {"concepts": "management effectiveness", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "management effectiveness"}, "ecosystem protections": {"concepts": "ecosystem protections", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem protections"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "harmful organisms"}, "mangrove forests": {"concepts": "mangrove forests", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "mangrove forests"}, "quantitative process": {"concepts": "quantitative process", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "quantitative process"}, "gulf of mexico": {"concepts": "gulf of mexico", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "gulf of mexico"}, "interviews": {"concepts": "interviews", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "interviews"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "biodiversity"}, "food sources": {"concepts": "food sources", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "food sources"}, "relationships": {"concepts": "relationships", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "relationships"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "habitat forming species"}, "qualitative process": {"concepts": "qualitative process", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "qualitative process"}, "healthy ecosystems": {"concepts": "healthy ecosystems", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "healthy ecosystems"}, "ecosystem components": {"concepts": "ecosystem components", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem components"}, "ecosystem balance": {"concepts": "ecosystem balance", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem balance"}, "diagnoses": {"concepts": "diagnoses", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "diagnoses"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species diversity"}, "symptoms": {"concepts": "symptoms", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "symptoms"}, "broad ecosystem protection": {"concepts": "broad ecosystem protection", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "broad ecosystem protection"}, "top predators": {"concepts": "top predators", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "top predators"}, "environmental determinants": {"concepts": "environmental determinants", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "environmental determinants"}, "natural inventory": {"concepts": "natural inventory", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "natural inventory"}, "conservation concern": {"concepts": "conservation concern", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "conservation concern"}, "native organism abundance": {"concepts": "native organism abundance", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "native organism abundance"}, "stakeholders": {"concepts": "stakeholders", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "stakeholders"}, "management approaches": {"concepts": "management approaches", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "management approaches"}, "pollutants": {"concepts": "pollutants", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "pollutants"}, "population quantification": {"concepts": "population quantification", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "population quantification"}, "physiological systems": {"concepts": "physiological systems", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "physiological systems"}, "treatments": {"concepts": "treatments", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "treatments"}, "key food web supporting species": {"concepts": "key food web supporting species", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "key food web supporting species"}, "concepts": {"concepts": "concepts", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "concepts"}, "everglades restoration": {"concepts": "everglades restoration", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "everglades restoration"}, "travel arrangements": {"concepts": "travel arrangements", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "travel arrangements"}, "contaminants": {"concepts": "contaminants", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "contaminants"}, "nutrient influx": {"concepts": "nutrient influx", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "nutrient influx"}, "access to resources": {"concepts": "access to resources", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "access to resources"}, "baseline biodiversity data": {"concepts": "baseline biodiversity data", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "baseline biodiversity data"}, "importation bans": {"concepts": "importation bans", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "importation bans"}, "behavioral patterns": {"concepts": "behavioral patterns", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "behavioral patterns"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species of conservation concern"}, "invasive species removal": {"concepts": "invasive species removal", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "invasive species removal"}, "qualitative aggregation": {"concepts": "qualitative aggregation", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "qualitative aggregation"}, "food chain": {"concepts": "food chain", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "food chain"}, "food web": {"concepts": "food web", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "food web"}, "healthy ecosystem": {"concepts": "healthy ecosystem", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "healthy ecosystem"}, "southern us division": {"concepts": "southern us division", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "southern us division"}, "emotional states": {"concepts": "emotional states", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "emotional states"}, "ecosystem protection": {"concepts": "ecosystem protection", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem protection"}, "ecosystem health": {"concepts": "ecosystem health", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem health"}, "nature conservancy": {"concepts": "nature conservancy", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "nature conservancy"}, "biodiversity definition": {"concepts": "biodiversity definition", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "biodiversity definition"}, "tropical storms": {"concepts": "tropical storms", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "tropical storms"}, "geospatial analysis": {"concepts": "geospatial analysis", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "geospatial analysis"}, "workshop": {"concepts": "workshop", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "workshop"}, "bacteria": {"concepts": "bacteria", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "bacteria"}, "invasive species": {"concepts": "invasive species", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "invasive species"}, "population growth": {"concepts": "population growth", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "population growth"}, "experts": {"concepts": "experts", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "experts"}, "travel office": {"concepts": "travel office", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "travel office"}, "sea level rise": {"concepts": "sea level rise", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "sea level rise"}, "mapping": {"concepts": "mapping", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "mapping"}, "ecosystem models": {"concepts": "ecosystem models", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem models"}, "conservation actions": {"concepts": "conservation actions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "conservation actions"}, "blue carbon": {"concepts": "blue carbon", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "blue carbon"}, "no-take areas": {"concepts": "no-take areas", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "no-take areas"}, "excess nutrients": {"concepts": "excess nutrients", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "excess nutrients"}, "ecosystem restoration": {"concepts": "ecosystem restoration", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem restoration"}, "storm surge": {"concepts": "storm surge", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "storm surge"}, "species distribution": {"concepts": "species distribution", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species distribution"}, "cognitive functions": {"concepts": "cognitive functions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "cognitive functions"}, "species interactions": {"concepts": "species interactions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species interactions"}, "microbial communities": {"concepts": "microbial communities", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "microbial communities"}, "upstream management": {"concepts": "upstream management", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "upstream management"}, "no take areas": {"concepts": "no take areas", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "no take areas"}, "mental health conditions": {"concepts": "mental health conditions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "mental health conditions"}, "support systems": {"concepts": "support systems", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "support systems"}};
        const interClusterEdges = [["Marine Conservation & Fisheries", "Ecosystem Health Assessment", {"weight": 1.0, "confidence": 0.9166666666666666, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Health Assessment", "Marine Conservation & Fisheries", {"weight": 1.0, "confidence": 0.8666666666666667, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Marine Conservation & Fisheries": [["fisheries policy", {"concepts": "fisheries policy", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "fisheries policy"}], ["marine environment", {"concepts": "marine environment", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine environment"}], ["oyster reefs", {"concepts": "oyster reefs", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oyster reefs"}], ["oysters", {"concepts": "oysters", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oysters"}], ["marine biology", {"concepts": "marine biology", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine biology"}], ["oyster reef restoration", {"concepts": "oyster reef restoration", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oyster reef restoration"}], ["marine conservation", {"concepts": "marine conservation", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine conservation"}], ["oil spill assessment", {"concepts": "oil spill assessment", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "oil spill assessment"}], ["shellfish predation", {"concepts": "shellfish predation", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "shellfish predation"}], ["coral reefs", {"concepts": "coral reefs", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coral reefs"}], ["aquatic biology", {"concepts": "aquatic biology", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "aquatic biology"}], ["anadromous fish", {"concepts": "anadromous fish", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "anadromous fish"}], ["sea turtles", {"concepts": "sea turtles", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "sea turtles"}], ["coastal resilience", {"concepts": "coastal resilience", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coastal resilience"}], ["marine assessment", {"concepts": "marine assessment", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine assessment"}], ["wetland filling", {"concepts": "wetland filling", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "wetland filling"}], ["coastal ecosystem", {"concepts": "coastal ecosystem", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coastal ecosystem"}], ["marine mammals", {"concepts": "marine mammals", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine mammals"}], ["coastal ecosystems", {"concepts": "coastal ecosystems", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "coastal ecosystems"}], ["marine ecology", {"concepts": "marine ecology", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine ecology"}], ["marine policy", {"concepts": "marine policy", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine policy"}], ["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Conservation & Fisheries", "node_size": 10, "label": "marine resource management"}]], "Ecosystem Health Assessment": [["sedimentation", {"concepts": "sedimentation", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "sedimentation"}], ["management effectiveness", {"concepts": "management effectiveness", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "management effectiveness"}], ["ecosystem protections", {"concepts": "ecosystem protections", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem protections"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "harmful organisms"}], ["mangrove forests", {"concepts": "mangrove forests", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "mangrove forests"}], ["quantitative process", {"concepts": "quantitative process", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "quantitative process"}], ["gulf of mexico", {"concepts": "gulf of mexico", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "gulf of mexico"}], ["interviews", {"concepts": "interviews", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "interviews"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "biodiversity"}], ["food sources", {"concepts": "food sources", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "food sources"}], ["relationships", {"concepts": "relationships", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "relationships"}], ["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "habitat forming species"}], ["qualitative process", {"concepts": "qualitative process", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "qualitative process"}], ["healthy ecosystems", {"concepts": "healthy ecosystems", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "healthy ecosystems"}], ["ecosystem components", {"concepts": "ecosystem components", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem components"}], ["ecosystem balance", {"concepts": "ecosystem balance", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem balance"}], ["diagnoses", {"concepts": "diagnoses", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "diagnoses"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species diversity"}], ["symptoms", {"concepts": "symptoms", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "symptoms"}], ["broad ecosystem protection", {"concepts": "broad ecosystem protection", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "broad ecosystem protection"}], ["top predators", {"concepts": "top predators", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "top predators"}], ["environmental determinants", {"concepts": "environmental determinants", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "environmental determinants"}], ["natural inventory", {"concepts": "natural inventory", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "natural inventory"}], ["conservation concern", {"concepts": "conservation concern", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "conservation concern"}], ["native organism abundance", {"concepts": "native organism abundance", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "native organism abundance"}], ["stakeholders", {"concepts": "stakeholders", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "stakeholders"}], ["management approaches", {"concepts": "management approaches", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "management approaches"}], ["pollutants", {"concepts": "pollutants", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "pollutants"}], ["population quantification", {"concepts": "population quantification", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "population quantification"}], ["physiological systems", {"concepts": "physiological systems", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "physiological systems"}], ["treatments", {"concepts": "treatments", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "treatments"}], ["key food web supporting species", {"concepts": "key food web supporting species", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "key food web supporting species"}], ["concepts", {"concepts": "concepts", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "concepts"}], ["everglades restoration", {"concepts": "everglades restoration", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "everglades restoration"}], ["travel arrangements", {"concepts": "travel arrangements", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "travel arrangements"}], ["contaminants", {"concepts": "contaminants", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "contaminants"}], ["nutrient influx", {"concepts": "nutrient influx", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "nutrient influx"}], ["access to resources", {"concepts": "access to resources", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "access to resources"}], ["baseline biodiversity data", {"concepts": "baseline biodiversity data", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "baseline biodiversity data"}], ["importation bans", {"concepts": "importation bans", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "importation bans"}], ["behavioral patterns", {"concepts": "behavioral patterns", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "behavioral patterns"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species of conservation concern"}], ["invasive species removal", {"concepts": "invasive species removal", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "invasive species removal"}], ["qualitative aggregation", {"concepts": "qualitative aggregation", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "qualitative aggregation"}], ["food chain", {"concepts": "food chain", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "food chain"}], ["food web", {"concepts": "food web", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "food web"}], ["healthy ecosystem", {"concepts": "healthy ecosystem", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "healthy ecosystem"}], ["southern us division", {"concepts": "southern us division", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "southern us division"}], ["emotional states", {"concepts": "emotional states", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "emotional states"}], ["ecosystem protection", {"concepts": "ecosystem protection", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem protection"}], ["ecosystem health", {"concepts": "ecosystem health", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem health"}], ["nature conservancy", {"concepts": "nature conservancy", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "nature conservancy"}], ["biodiversity definition", {"concepts": "biodiversity definition", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "biodiversity definition"}], ["tropical storms", {"concepts": "tropical storms", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "tropical storms"}], ["geospatial analysis", {"concepts": "geospatial analysis", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "geospatial analysis"}], ["workshop", {"concepts": "workshop", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "workshop"}], ["bacteria", {"concepts": "bacteria", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "bacteria"}], ["invasive species", {"concepts": "invasive species", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "invasive species"}], ["population growth", {"concepts": "population growth", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "population growth"}], ["experts", {"concepts": "experts", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "experts"}], ["travel office", {"concepts": "travel office", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "travel office"}], ["sea level rise", {"concepts": "sea level rise", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "sea level rise"}], ["mapping", {"concepts": "mapping", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "mapping"}], ["ecosystem models", {"concepts": "ecosystem models", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem models"}], ["conservation actions", {"concepts": "conservation actions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "conservation actions"}], ["blue carbon", {"concepts": "blue carbon", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "blue carbon"}], ["no-take areas", {"concepts": "no-take areas", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "no-take areas"}], ["excess nutrients", {"concepts": "excess nutrients", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "excess nutrients"}], ["ecosystem restoration", {"concepts": "ecosystem restoration", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "ecosystem restoration"}], ["storm surge", {"concepts": "storm surge", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "storm surge"}], ["species distribution", {"concepts": "species distribution", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species distribution"}], ["cognitive functions", {"concepts": "cognitive functions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "cognitive functions"}], ["species interactions", {"concepts": "species interactions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "species interactions"}], ["microbial communities", {"concepts": "microbial communities", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "microbial communities"}], ["upstream management", {"concepts": "upstream management", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "upstream management"}], ["no take areas", {"concepts": "no take areas", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "no take areas"}], ["mental health conditions", {"concepts": "mental health conditions", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "mental health conditions"}], ["support systems", {"concepts": "support systems", "type": "concept", "cluster": "Ecosystem Health Assessment", "node_size": 10, "label": "support systems"}]]};
        const clusterEdges = {"Marine Conservation & Fisheries": [], "Ecosystem Health Assessment": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

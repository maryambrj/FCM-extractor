
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Environmental Change Drivers": {"concepts": "seed bank, ecological resilience, habitat forming species, food webs, paleoecology, disturbance regime, water samples, subsistence fishing, endangered species list, carbon sequestration, tourism, environmental variables, socio-ecological systems, food-web, food-web supporting species, species interactions, ecosystem service, population diversity, large-scale migrations, population genomics, species assemblage, gamma diversity, species migration, trophic function, boreal forests, genetic diversity, symbiotes, ecological functioning, ecologically redundant species, native communities, invasive species, biogeography, alpha diversity, salmon harvesting, single species management, ecosystem management, coral reef management, key food-web species, species of conservation concern, key food-web, marine resource management, ecological redundancy, fossil record, subsistence lifestyle, ecological roles, beta diversity, community ecology, aquaculture, climate change, biodiversity assessments, biodiversity, intrinsic diversity, coral conservation, conservation management, biodiversity monitoring, species management, tropical forests, biodiversity assessment, invertebrates, environmental disturbance, food source, extrinsic diversity, recreation, marine management, carbon cycling, marine biodiversity, number of species, conservation concern, commercial fishing, fisheries, elusive species, environmental sociology, ecology, landscape conservation cooperatives, species assemblages, harmful algal blooms, tree species, harmful organisms, fisheries management, intra-population diversity, elevation gradients, habitat, biodiversity conservation", "concept_list": ["seed bank", "ecological resilience", "habitat forming species", "food webs", "paleoecology", "disturbance regime", "water samples", "subsistence fishing", "endangered species list", "carbon sequestration", "tourism", "environmental variables", "socio-ecological systems", "food-web", "food-web supporting species", "species interactions", "ecosystem service", "population diversity", "large-scale migrations", "population genomics", "species assemblage", "gamma diversity", "species migration", "trophic function", "boreal forests", "genetic diversity", "symbiotes", "ecological functioning", "ecologically redundant species", "native communities", "invasive species", "biogeography", "alpha diversity", "salmon harvesting", "single species management", "ecosystem management", "coral reef management", "key food-web species", "species of conservation concern", "key food-web", "marine resource management", "ecological redundancy", "fossil record", "subsistence lifestyle", "ecological roles", "beta diversity", "community ecology", "aquaculture", "climate change", "biodiversity assessments", "biodiversity", "intrinsic diversity", "coral conservation", "conservation management", "biodiversity monitoring", "species management", "tropical forests", "biodiversity assessment", "invertebrates", "environmental disturbance", "food source", "extrinsic diversity", "recreation", "marine management", "carbon cycling", "marine biodiversity", "number of species", "conservation concern", "commercial fishing", "fisheries", "elusive species", "environmental sociology", "ecology", "landscape conservation cooperatives", "species assemblages", "harmful algal blooms", "tree species", "harmful organisms", "fisheries management", "intra-population diversity", "elevation gradients", "habitat", "biodiversity conservation"], "type": "cluster", "node_size": 264, "label": "Environmental Change Drivers"}, "Resource Management Tools": {"concepts": "productivity, andes, paleorecord, human society, context dependence, amazon, noaa, edna, human pressures, adaptation, photosynthesis, gulf hypoxia region, gulf hypoxia, red tide, microbes", "concept_list": ["productivity", "andes", "paleorecord", "human society", "context dependence", "amazon", "noaa", "edna", "human pressures", "adaptation", "photosynthesis", "gulf hypoxia region", "gulf hypoxia", "red tide", "microbes"], "type": "cluster", "node_size": 60, "label": "Resource Management Tools"}, "Economic & Social Dynamics": {"concepts": "decision making tools, fuzzy cognitive mapping, active management, resource management, system components, mental modeler, holistic management, resource management policies, mental model", "concept_list": ["decision making tools", "fuzzy cognitive mapping", "active management", "resource management", "system components", "mental modeler", "holistic management", "resource management policies", "mental model"], "type": "cluster", "node_size": 42, "label": "Economic & Social Dynamics"}, "Biodiversity & Conservation": {"concepts": "economic opportunity, functional role, economic value, system dynamics, collective action", "concept_list": ["economic opportunity", "functional role", "economic value", "system dynamics", "collective action"], "type": "cluster", "node_size": 30, "label": "Biodiversity & Conservation"}};
        const conceptData = {"seed bank": {"concepts": "seed bank", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "seed bank"}, "ecological resilience": {"concepts": "ecological resilience", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological resilience"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "habitat forming species"}, "food webs": {"concepts": "food webs", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food webs"}, "paleoecology": {"concepts": "paleoecology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "paleoecology"}, "disturbance regime": {"concepts": "disturbance regime", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "disturbance regime"}, "water samples": {"concepts": "water samples", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "water samples"}, "subsistence fishing": {"concepts": "subsistence fishing", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "subsistence fishing"}, "endangered species list": {"concepts": "endangered species list", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "endangered species list"}, "carbon sequestration": {"concepts": "carbon sequestration", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "carbon sequestration"}, "tourism": {"concepts": "tourism", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "tourism"}, "environmental variables": {"concepts": "environmental variables", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "environmental variables"}, "socio-ecological systems": {"concepts": "socio-ecological systems", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "socio-ecological systems"}, "food-web": {"concepts": "food-web", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food-web"}, "food-web supporting species": {"concepts": "food-web supporting species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food-web supporting species"}, "species interactions": {"concepts": "species interactions", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species interactions"}, "ecosystem service": {"concepts": "ecosystem service", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecosystem service"}, "population diversity": {"concepts": "population diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "population diversity"}, "large-scale migrations": {"concepts": "large-scale migrations", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "large-scale migrations"}, "population genomics": {"concepts": "population genomics", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "population genomics"}, "species assemblage": {"concepts": "species assemblage", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species assemblage"}, "gamma diversity": {"concepts": "gamma diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "gamma diversity"}, "species migration": {"concepts": "species migration", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species migration"}, "trophic function": {"concepts": "trophic function", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "trophic function"}, "boreal forests": {"concepts": "boreal forests", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "boreal forests"}, "genetic diversity": {"concepts": "genetic diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "genetic diversity"}, "symbiotes": {"concepts": "symbiotes", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "symbiotes"}, "ecological functioning": {"concepts": "ecological functioning", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological functioning"}, "ecologically redundant species": {"concepts": "ecologically redundant species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecologically redundant species"}, "native communities": {"concepts": "native communities", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "native communities"}, "invasive species": {"concepts": "invasive species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "invasive species"}, "biogeography": {"concepts": "biogeography", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biogeography"}, "alpha diversity": {"concepts": "alpha diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "alpha diversity"}, "salmon harvesting": {"concepts": "salmon harvesting", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "salmon harvesting"}, "single species management": {"concepts": "single species management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "single species management"}, "ecosystem management": {"concepts": "ecosystem management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecosystem management"}, "coral reef management": {"concepts": "coral reef management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "coral reef management"}, "key food-web species": {"concepts": "key food-web species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "key food-web species"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species of conservation concern"}, "key food-web": {"concepts": "key food-web", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "key food-web"}, "marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "marine resource management"}, "ecological redundancy": {"concepts": "ecological redundancy", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological redundancy"}, "fossil record": {"concepts": "fossil record", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "fossil record"}, "subsistence lifestyle": {"concepts": "subsistence lifestyle", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "subsistence lifestyle"}, "ecological roles": {"concepts": "ecological roles", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological roles"}, "beta diversity": {"concepts": "beta diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "beta diversity"}, "community ecology": {"concepts": "community ecology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "community ecology"}, "aquaculture": {"concepts": "aquaculture", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "aquaculture"}, "climate change": {"concepts": "climate change", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "climate change"}, "biodiversity assessments": {"concepts": "biodiversity assessments", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity assessments"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity"}, "intrinsic diversity": {"concepts": "intrinsic diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "intrinsic diversity"}, "coral conservation": {"concepts": "coral conservation", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "coral conservation"}, "conservation management": {"concepts": "conservation management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "conservation management"}, "biodiversity monitoring": {"concepts": "biodiversity monitoring", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity monitoring"}, "species management": {"concepts": "species management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species management"}, "tropical forests": {"concepts": "tropical forests", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "tropical forests"}, "biodiversity assessment": {"concepts": "biodiversity assessment", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity assessment"}, "invertebrates": {"concepts": "invertebrates", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "invertebrates"}, "environmental disturbance": {"concepts": "environmental disturbance", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "environmental disturbance"}, "food source": {"concepts": "food source", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food source"}, "extrinsic diversity": {"concepts": "extrinsic diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "extrinsic diversity"}, "recreation": {"concepts": "recreation", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "recreation"}, "marine management": {"concepts": "marine management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "marine management"}, "carbon cycling": {"concepts": "carbon cycling", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "carbon cycling"}, "marine biodiversity": {"concepts": "marine biodiversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "marine biodiversity"}, "number of species": {"concepts": "number of species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "number of species"}, "conservation concern": {"concepts": "conservation concern", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "conservation concern"}, "commercial fishing": {"concepts": "commercial fishing", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "commercial fishing"}, "fisheries": {"concepts": "fisheries", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "fisheries"}, "elusive species": {"concepts": "elusive species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "elusive species"}, "environmental sociology": {"concepts": "environmental sociology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "environmental sociology"}, "ecology": {"concepts": "ecology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecology"}, "landscape conservation cooperatives": {"concepts": "landscape conservation cooperatives", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "landscape conservation cooperatives"}, "species assemblages": {"concepts": "species assemblages", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species assemblages"}, "harmful algal blooms": {"concepts": "harmful algal blooms", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "harmful algal blooms"}, "tree species": {"concepts": "tree species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "tree species"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "harmful organisms"}, "fisheries management": {"concepts": "fisheries management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "fisheries management"}, "intra-population diversity": {"concepts": "intra-population diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "intra-population diversity"}, "elevation gradients": {"concepts": "elevation gradients", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "elevation gradients"}, "habitat": {"concepts": "habitat", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "habitat"}, "biodiversity conservation": {"concepts": "biodiversity conservation", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity conservation"}, "productivity": {"concepts": "productivity", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "productivity"}, "andes": {"concepts": "andes", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "andes"}, "paleorecord": {"concepts": "paleorecord", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "paleorecord"}, "human society": {"concepts": "human society", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "human society"}, "context dependence": {"concepts": "context dependence", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "context dependence"}, "amazon": {"concepts": "amazon", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "amazon"}, "noaa": {"concepts": "noaa", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "noaa"}, "edna": {"concepts": "edna", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "edna"}, "human pressures": {"concepts": "human pressures", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "human pressures"}, "adaptation": {"concepts": "adaptation", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "adaptation"}, "photosynthesis": {"concepts": "photosynthesis", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "photosynthesis"}, "gulf hypoxia region": {"concepts": "gulf hypoxia region", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "gulf hypoxia region"}, "gulf hypoxia": {"concepts": "gulf hypoxia", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "gulf hypoxia"}, "red tide": {"concepts": "red tide", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "red tide"}, "microbes": {"concepts": "microbes", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "microbes"}, "decision making tools": {"concepts": "decision making tools", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "decision making tools"}, "fuzzy cognitive mapping": {"concepts": "fuzzy cognitive mapping", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "fuzzy cognitive mapping"}, "active management": {"concepts": "active management", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "active management"}, "resource management": {"concepts": "resource management", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "resource management"}, "system components": {"concepts": "system components", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "system components"}, "mental modeler": {"concepts": "mental modeler", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "mental modeler"}, "holistic management": {"concepts": "holistic management", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "holistic management"}, "resource management policies": {"concepts": "resource management policies", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "resource management policies"}, "mental model": {"concepts": "mental model", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "mental model"}, "economic opportunity": {"concepts": "economic opportunity", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "economic opportunity"}, "functional role": {"concepts": "functional role", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "functional role"}, "economic value": {"concepts": "economic value", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "economic value"}, "system dynamics": {"concepts": "system dynamics", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "system dynamics"}, "collective action": {"concepts": "collective action", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "collective action"}};
        const interClusterEdges = [["Environmental Change Drivers", "Resource Management Tools", {"weight": 1.0, "confidence": 0.792, "type": "inter_cluster", "style": "solid"}], ["Environmental Change Drivers", "Biodiversity & Conservation", {"weight": 1.0, "confidence": 0.764, "type": "inter_cluster", "style": "solid"}], ["Resource Management Tools", "Environmental Change Drivers", {"weight": 1.0, "confidence": 0.8019999999999999, "type": "inter_cluster", "style": "solid"}], ["Resource Management Tools", "Economic & Social Dynamics", {"weight": 1.0, "confidence": 0.724, "type": "inter_cluster", "style": "solid"}], ["Resource Management Tools", "Biodiversity & Conservation", {"weight": 1.0, "confidence": 0.6880000000000001, "type": "inter_cluster", "style": "solid"}], ["Economic & Social Dynamics", "Biodiversity & Conservation", {"weight": 1.0, "confidence": 0.752, "type": "inter_cluster", "style": "solid"}], ["Economic & Social Dynamics", "Resource Management Tools", {"weight": 1.0, "confidence": 0.708, "type": "inter_cluster", "style": "solid"}], ["Biodiversity & Conservation", "Environmental Change Drivers", {"weight": 1.0, "confidence": 0.76, "type": "inter_cluster", "style": "solid"}], ["Biodiversity & Conservation", "Resource Management Tools", {"weight": 1.0, "confidence": 0.666, "type": "inter_cluster", "style": "solid"}], ["Biodiversity & Conservation", "Economic & Social Dynamics", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Environmental Change Drivers": [["seed bank", {"concepts": "seed bank", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "seed bank"}], ["ecological resilience", {"concepts": "ecological resilience", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological resilience"}], ["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "habitat forming species"}], ["food webs", {"concepts": "food webs", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food webs"}], ["paleoecology", {"concepts": "paleoecology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "paleoecology"}], ["disturbance regime", {"concepts": "disturbance regime", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "disturbance regime"}], ["water samples", {"concepts": "water samples", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "water samples"}], ["subsistence fishing", {"concepts": "subsistence fishing", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "subsistence fishing"}], ["endangered species list", {"concepts": "endangered species list", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "endangered species list"}], ["carbon sequestration", {"concepts": "carbon sequestration", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "carbon sequestration"}], ["tourism", {"concepts": "tourism", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "tourism"}], ["environmental variables", {"concepts": "environmental variables", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "environmental variables"}], ["socio-ecological systems", {"concepts": "socio-ecological systems", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "socio-ecological systems"}], ["food-web", {"concepts": "food-web", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food-web"}], ["food-web supporting species", {"concepts": "food-web supporting species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food-web supporting species"}], ["species interactions", {"concepts": "species interactions", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species interactions"}], ["ecosystem service", {"concepts": "ecosystem service", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecosystem service"}], ["population diversity", {"concepts": "population diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "population diversity"}], ["large-scale migrations", {"concepts": "large-scale migrations", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "large-scale migrations"}], ["population genomics", {"concepts": "population genomics", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "population genomics"}], ["species assemblage", {"concepts": "species assemblage", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species assemblage"}], ["gamma diversity", {"concepts": "gamma diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "gamma diversity"}], ["species migration", {"concepts": "species migration", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species migration"}], ["trophic function", {"concepts": "trophic function", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "trophic function"}], ["boreal forests", {"concepts": "boreal forests", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "boreal forests"}], ["genetic diversity", {"concepts": "genetic diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "genetic diversity"}], ["symbiotes", {"concepts": "symbiotes", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "symbiotes"}], ["ecological functioning", {"concepts": "ecological functioning", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological functioning"}], ["ecologically redundant species", {"concepts": "ecologically redundant species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecologically redundant species"}], ["native communities", {"concepts": "native communities", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "native communities"}], ["invasive species", {"concepts": "invasive species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "invasive species"}], ["biogeography", {"concepts": "biogeography", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biogeography"}], ["alpha diversity", {"concepts": "alpha diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "alpha diversity"}], ["salmon harvesting", {"concepts": "salmon harvesting", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "salmon harvesting"}], ["single species management", {"concepts": "single species management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "single species management"}], ["ecosystem management", {"concepts": "ecosystem management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecosystem management"}], ["coral reef management", {"concepts": "coral reef management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "coral reef management"}], ["key food-web species", {"concepts": "key food-web species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "key food-web species"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species of conservation concern"}], ["key food-web", {"concepts": "key food-web", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "key food-web"}], ["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "marine resource management"}], ["ecological redundancy", {"concepts": "ecological redundancy", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological redundancy"}], ["fossil record", {"concepts": "fossil record", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "fossil record"}], ["subsistence lifestyle", {"concepts": "subsistence lifestyle", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "subsistence lifestyle"}], ["ecological roles", {"concepts": "ecological roles", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecological roles"}], ["beta diversity", {"concepts": "beta diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "beta diversity"}], ["community ecology", {"concepts": "community ecology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "community ecology"}], ["aquaculture", {"concepts": "aquaculture", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "aquaculture"}], ["climate change", {"concepts": "climate change", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "climate change"}], ["biodiversity assessments", {"concepts": "biodiversity assessments", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity assessments"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity"}], ["intrinsic diversity", {"concepts": "intrinsic diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "intrinsic diversity"}], ["coral conservation", {"concepts": "coral conservation", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "coral conservation"}], ["conservation management", {"concepts": "conservation management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "conservation management"}], ["biodiversity monitoring", {"concepts": "biodiversity monitoring", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity monitoring"}], ["species management", {"concepts": "species management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species management"}], ["tropical forests", {"concepts": "tropical forests", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "tropical forests"}], ["biodiversity assessment", {"concepts": "biodiversity assessment", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity assessment"}], ["invertebrates", {"concepts": "invertebrates", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "invertebrates"}], ["environmental disturbance", {"concepts": "environmental disturbance", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "environmental disturbance"}], ["food source", {"concepts": "food source", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "food source"}], ["extrinsic diversity", {"concepts": "extrinsic diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "extrinsic diversity"}], ["recreation", {"concepts": "recreation", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "recreation"}], ["marine management", {"concepts": "marine management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "marine management"}], ["carbon cycling", {"concepts": "carbon cycling", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "carbon cycling"}], ["marine biodiversity", {"concepts": "marine biodiversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "marine biodiversity"}], ["number of species", {"concepts": "number of species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "number of species"}], ["conservation concern", {"concepts": "conservation concern", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "conservation concern"}], ["commercial fishing", {"concepts": "commercial fishing", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "commercial fishing"}], ["fisheries", {"concepts": "fisheries", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "fisheries"}], ["elusive species", {"concepts": "elusive species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "elusive species"}], ["environmental sociology", {"concepts": "environmental sociology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "environmental sociology"}], ["ecology", {"concepts": "ecology", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "ecology"}], ["landscape conservation cooperatives", {"concepts": "landscape conservation cooperatives", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "landscape conservation cooperatives"}], ["species assemblages", {"concepts": "species assemblages", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "species assemblages"}], ["harmful algal blooms", {"concepts": "harmful algal blooms", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "harmful algal blooms"}], ["tree species", {"concepts": "tree species", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "tree species"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "harmful organisms"}], ["fisheries management", {"concepts": "fisheries management", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "fisheries management"}], ["intra-population diversity", {"concepts": "intra-population diversity", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "intra-population diversity"}], ["elevation gradients", {"concepts": "elevation gradients", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "elevation gradients"}], ["habitat", {"concepts": "habitat", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "habitat"}], ["biodiversity conservation", {"concepts": "biodiversity conservation", "type": "concept", "cluster": "Environmental Change Drivers", "node_size": 10, "label": "biodiversity conservation"}]], "Resource Management Tools": [["productivity", {"concepts": "productivity", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "productivity"}], ["andes", {"concepts": "andes", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "andes"}], ["paleorecord", {"concepts": "paleorecord", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "paleorecord"}], ["human society", {"concepts": "human society", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "human society"}], ["context dependence", {"concepts": "context dependence", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "context dependence"}], ["amazon", {"concepts": "amazon", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "amazon"}], ["noaa", {"concepts": "noaa", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "noaa"}], ["edna", {"concepts": "edna", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "edna"}], ["human pressures", {"concepts": "human pressures", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "human pressures"}], ["adaptation", {"concepts": "adaptation", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "adaptation"}], ["photosynthesis", {"concepts": "photosynthesis", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "photosynthesis"}], ["gulf hypoxia region", {"concepts": "gulf hypoxia region", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "gulf hypoxia region"}], ["gulf hypoxia", {"concepts": "gulf hypoxia", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "gulf hypoxia"}], ["red tide", {"concepts": "red tide", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "red tide"}], ["microbes", {"concepts": "microbes", "type": "concept", "cluster": "Resource Management Tools", "node_size": 10, "label": "microbes"}]], "Economic & Social Dynamics": [["decision making tools", {"concepts": "decision making tools", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "decision making tools"}], ["fuzzy cognitive mapping", {"concepts": "fuzzy cognitive mapping", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "fuzzy cognitive mapping"}], ["active management", {"concepts": "active management", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "active management"}], ["resource management", {"concepts": "resource management", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "resource management"}], ["system components", {"concepts": "system components", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "system components"}], ["mental modeler", {"concepts": "mental modeler", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "mental modeler"}], ["holistic management", {"concepts": "holistic management", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "holistic management"}], ["resource management policies", {"concepts": "resource management policies", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "resource management policies"}], ["mental model", {"concepts": "mental model", "type": "concept", "cluster": "Economic & Social Dynamics", "node_size": 10, "label": "mental model"}]], "Biodiversity & Conservation": [["economic opportunity", {"concepts": "economic opportunity", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "economic opportunity"}], ["functional role", {"concepts": "functional role", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "functional role"}], ["economic value", {"concepts": "economic value", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "economic value"}], ["system dynamics", {"concepts": "system dynamics", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "system dynamics"}], ["collective action", {"concepts": "collective action", "type": "concept", "cluster": "Biodiversity & Conservation", "node_size": 10, "label": "collective action"}]]};
        const clusterEdges = {"Environmental Change Drivers": [], "Resource Management Tools": [], "Economic & Social Dynamics": [], "Biodiversity & Conservation": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

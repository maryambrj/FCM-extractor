
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Restoration Efforts": {"concepts": "seawalls, shoreline management, native species, dredge material, mangroves, invasive species, harmful organisms, species diversity, food web support, nesting shorebirds, ecosystem services, food web, sea level rise, seawall, carbon storage, shoreline erosion control, living shorelines, coastal engineering, sea walls, oyster reef, habitat loss, marsh walks, marine resource management, biodiversity, sea level rise advisory council, marsh grass, species of conservation concern, historic preservation, turtles, climate management, sediment, tidal zones, habitat division, plant diversity, food web species, habitat creation, habitat forming species, oyster farms, diversity of plants and animals, department of natural resources, living shorelines act, water quality improvement, marsh, water quality, food web supporting species, watermen, animal diversity", "concept_list": ["seawalls", "shoreline management", "native species", "dredge material", "mangroves", "invasive species", "harmful organisms", "species diversity", "food web support", "nesting shorebirds", "ecosystem services", "food web", "sea level rise", "seawall", "carbon storage", "shoreline erosion control", "living shorelines", "coastal engineering", "sea walls", "oyster reef", "habitat loss", "marsh walks", "marine resource management", "biodiversity", "sea level rise advisory council", "marsh grass", "species of conservation concern", "historic preservation", "turtles", "climate management", "sediment", "tidal zones", "habitat division", "plant diversity", "food web species", "habitat creation", "habitat forming species", "oyster farms", "diversity of plants and animals", "department of natural resources", "living shorelines act", "water quality improvement", "marsh", "water quality", "food web supporting species", "watermen", "animal diversity"], "type": "cluster", "node_size": 156, "label": "Restoration Efforts"}, "Impact Assessment": {"concepts": "restoration, relocation, st. mary\u2019s church, permitting hurdles, noaa, noaa chesapeake bay office, teaching, underwood associates, interview, military perspective, university architect, design build, regulations, second day, maryland dnr, adaptive changes, join, tourism, bulkheads, engineering, workshop, naval academy, audubon society, tourists, workshop invitation, dates, political dynamics, system dynamics, juncus, dnr, phragmites, ecotourism, half day, flooding, engineering perspective, spartina", "concept_list": ["restoration", "relocation", "st. mary\u2019s church", "permitting hurdles", "noaa", "noaa chesapeake bay office", "teaching", "underwood associates", "interview", "military perspective", "university architect", "design build", "regulations", "second day", "maryland dnr", "adaptive changes", "join", "tourism", "bulkheads", "engineering", "workshop", "naval academy", "audubon society", "tourists", "workshop invitation", "dates", "political dynamics", "system dynamics", "juncus", "dnr", "phragmites", "ecotourism", "half day", "flooding", "engineering perspective", "spartina"], "type": "cluster", "node_size": 123, "label": "Impact Assessment"}, "Decision Making": {"concepts": "medium impact, environmental benefits, co-benefits, beneficial use, direct relationships, high impact, low impact, funding, relative impact", "concept_list": ["medium impact", "environmental benefits", "co-benefits", "beneficial use", "direct relationships", "high impact", "low impact", "funding", "relative impact"], "type": "cluster", "node_size": 42, "label": "Decision Making"}, "Waterfront Communities": {"concepts": "stakeholders, decision processes, management decisions, management strategy, implementation guidelines, stakeholder groups, project planning", "concept_list": ["stakeholders", "decision processes", "management decisions", "management strategy", "implementation guidelines", "stakeholder groups", "project planning"], "type": "cluster", "node_size": 36, "label": "Waterfront Communities"}, "Coastal Ecology": {"concepts": "waterfront businesses, climate change, waterfront homeowners, waterfront residents, businesses", "concept_list": ["waterfront businesses", "climate change", "waterfront homeowners", "waterfront residents", "businesses"], "type": "cluster", "node_size": 30, "label": "Coastal Ecology"}};
        const conceptData = {"seawalls": {"concepts": "seawalls", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "seawalls"}, "shoreline management": {"concepts": "shoreline management", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "shoreline management"}, "native species": {"concepts": "native species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "native species"}, "dredge material": {"concepts": "dredge material", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "dredge material"}, "mangroves": {"concepts": "mangroves", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "mangroves"}, "invasive species": {"concepts": "invasive species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "invasive species"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "harmful organisms"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "species diversity"}, "food web support": {"concepts": "food web support", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web support"}, "nesting shorebirds": {"concepts": "nesting shorebirds", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "nesting shorebirds"}, "ecosystem services": {"concepts": "ecosystem services", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "ecosystem services"}, "food web": {"concepts": "food web", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web"}, "sea level rise": {"concepts": "sea level rise", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sea level rise"}, "seawall": {"concepts": "seawall", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "seawall"}, "carbon storage": {"concepts": "carbon storage", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "carbon storage"}, "shoreline erosion control": {"concepts": "shoreline erosion control", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "shoreline erosion control"}, "living shorelines": {"concepts": "living shorelines", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "living shorelines"}, "coastal engineering": {"concepts": "coastal engineering", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "coastal engineering"}, "sea walls": {"concepts": "sea walls", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sea walls"}, "oyster reef": {"concepts": "oyster reef", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "oyster reef"}, "habitat loss": {"concepts": "habitat loss", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat loss"}, "marsh walks": {"concepts": "marsh walks", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marsh walks"}, "marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marine resource management"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "biodiversity"}, "sea level rise advisory council": {"concepts": "sea level rise advisory council", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sea level rise advisory council"}, "marsh grass": {"concepts": "marsh grass", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marsh grass"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "species of conservation concern"}, "historic preservation": {"concepts": "historic preservation", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "historic preservation"}, "turtles": {"concepts": "turtles", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "turtles"}, "climate management": {"concepts": "climate management", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "climate management"}, "sediment": {"concepts": "sediment", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sediment"}, "tidal zones": {"concepts": "tidal zones", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "tidal zones"}, "habitat division": {"concepts": "habitat division", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat division"}, "plant diversity": {"concepts": "plant diversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "plant diversity"}, "food web species": {"concepts": "food web species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web species"}, "habitat creation": {"concepts": "habitat creation", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat creation"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat forming species"}, "oyster farms": {"concepts": "oyster farms", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "oyster farms"}, "diversity of plants and animals": {"concepts": "diversity of plants and animals", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "diversity of plants and animals"}, "department of natural resources": {"concepts": "department of natural resources", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "department of natural resources"}, "living shorelines act": {"concepts": "living shorelines act", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "living shorelines act"}, "water quality improvement": {"concepts": "water quality improvement", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "water quality improvement"}, "marsh": {"concepts": "marsh", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marsh"}, "water quality": {"concepts": "water quality", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "water quality"}, "food web supporting species": {"concepts": "food web supporting species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web supporting species"}, "watermen": {"concepts": "watermen", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "watermen"}, "animal diversity": {"concepts": "animal diversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "animal diversity"}, "restoration": {"concepts": "restoration", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "restoration"}, "relocation": {"concepts": "relocation", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "relocation"}, "st. mary\u2019s church": {"concepts": "st. mary\u2019s church", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "st. mary\u2019s church"}, "permitting hurdles": {"concepts": "permitting hurdles", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "permitting hurdles"}, "noaa": {"concepts": "noaa", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "noaa"}, "noaa chesapeake bay office": {"concepts": "noaa chesapeake bay office", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "noaa chesapeake bay office"}, "teaching": {"concepts": "teaching", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "teaching"}, "underwood associates": {"concepts": "underwood associates", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "underwood associates"}, "interview": {"concepts": "interview", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "interview"}, "military perspective": {"concepts": "military perspective", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "military perspective"}, "university architect": {"concepts": "university architect", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "university architect"}, "design build": {"concepts": "design build", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "design build"}, "regulations": {"concepts": "regulations", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "regulations"}, "second day": {"concepts": "second day", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "second day"}, "maryland dnr": {"concepts": "maryland dnr", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "maryland dnr"}, "adaptive changes": {"concepts": "adaptive changes", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "adaptive changes"}, "join": {"concepts": "join", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "join"}, "tourism": {"concepts": "tourism", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "tourism"}, "bulkheads": {"concepts": "bulkheads", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "bulkheads"}, "engineering": {"concepts": "engineering", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "engineering"}, "workshop": {"concepts": "workshop", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "workshop"}, "naval academy": {"concepts": "naval academy", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "naval academy"}, "audubon society": {"concepts": "audubon society", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "audubon society"}, "tourists": {"concepts": "tourists", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "tourists"}, "workshop invitation": {"concepts": "workshop invitation", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "workshop invitation"}, "dates": {"concepts": "dates", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "dates"}, "political dynamics": {"concepts": "political dynamics", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "political dynamics"}, "system dynamics": {"concepts": "system dynamics", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "system dynamics"}, "juncus": {"concepts": "juncus", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "juncus"}, "dnr": {"concepts": "dnr", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "dnr"}, "phragmites": {"concepts": "phragmites", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "phragmites"}, "ecotourism": {"concepts": "ecotourism", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "ecotourism"}, "half day": {"concepts": "half day", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "half day"}, "flooding": {"concepts": "flooding", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "flooding"}, "engineering perspective": {"concepts": "engineering perspective", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "engineering perspective"}, "spartina": {"concepts": "spartina", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "spartina"}, "medium impact": {"concepts": "medium impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "medium impact"}, "environmental benefits": {"concepts": "environmental benefits", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "environmental benefits"}, "co-benefits": {"concepts": "co-benefits", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "co-benefits"}, "beneficial use": {"concepts": "beneficial use", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "beneficial use"}, "direct relationships": {"concepts": "direct relationships", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "direct relationships"}, "high impact": {"concepts": "high impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "high impact"}, "low impact": {"concepts": "low impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "low impact"}, "funding": {"concepts": "funding", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "funding"}, "relative impact": {"concepts": "relative impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "relative impact"}, "stakeholders": {"concepts": "stakeholders", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "stakeholders"}, "decision processes": {"concepts": "decision processes", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "decision processes"}, "management decisions": {"concepts": "management decisions", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "management decisions"}, "management strategy": {"concepts": "management strategy", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "management strategy"}, "implementation guidelines": {"concepts": "implementation guidelines", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "implementation guidelines"}, "stakeholder groups": {"concepts": "stakeholder groups", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "stakeholder groups"}, "project planning": {"concepts": "project planning", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "project planning"}, "waterfront businesses": {"concepts": "waterfront businesses", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "waterfront businesses"}, "climate change": {"concepts": "climate change", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "climate change"}, "waterfront homeowners": {"concepts": "waterfront homeowners", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "waterfront homeowners"}, "waterfront residents": {"concepts": "waterfront residents", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "waterfront residents"}, "businesses": {"concepts": "businesses", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "businesses"}};
        const interClusterEdges = [["Restoration Efforts", "Decision Making", {"weight": 1.0, "confidence": 0.74, "type": "inter_cluster", "style": "solid"}], ["Restoration Efforts", "Coastal Ecology", {"weight": 0.8, "confidence": 0.67, "type": "inter_cluster", "style": "solid"}], ["Restoration Efforts", "Impact Assessment", {"weight": 0.75, "confidence": 0.5625, "type": "inter_cluster", "style": "solid"}], ["Restoration Efforts", "Waterfront Communities", {"weight": 0.75, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Impact Assessment", "Coastal Ecology", {"weight": 1.0, "confidence": 0.71, "type": "inter_cluster", "style": "solid"}], ["Impact Assessment", "Decision Making", {"weight": 1.0, "confidence": 0.675, "type": "inter_cluster", "style": "solid"}], ["Impact Assessment", "Waterfront Communities", {"weight": 1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["Impact Assessment", "Restoration Efforts", {"weight": 0.6666666666666666, "confidence": 0.5666666666666668, "type": "inter_cluster", "style": "solid"}], ["Decision Making", "Restoration Efforts", {"weight": 1.0, "confidence": 0.74, "type": "inter_cluster", "style": "solid"}], ["Decision Making", "Waterfront Communities", {"weight": 1.0, "confidence": 0.7333333333333333, "type": "inter_cluster", "style": "solid"}], ["Decision Making", "Impact Assessment", {"weight": 1.0, "confidence": 0.7000000000000001, "type": "inter_cluster", "style": "solid"}], ["Decision Making", "Coastal Ecology", {"weight": 0.75, "confidence": 0.49999999999999994, "type": "inter_cluster", "style": "solid"}], ["Waterfront Communities", "Impact Assessment", {"weight": 1.0, "confidence": 0.7899999999999999, "type": "inter_cluster", "style": "solid"}], ["Waterfront Communities", "Decision Making", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Waterfront Communities", "Coastal Ecology", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Waterfront Communities", "Restoration Efforts", {"weight": 1.0, "confidence": 0.8666666666666667, "type": "inter_cluster", "style": "solid"}], ["Coastal Ecology", "Restoration Efforts", {"weight": 1.0, "confidence": 0.8400000000000001, "type": "inter_cluster", "style": "solid"}], ["Coastal Ecology", "Decision Making", {"weight": 1.0, "confidence": 0.6399999999999999, "type": "inter_cluster", "style": "solid"}], ["Coastal Ecology", "Impact Assessment", {"weight": 0.8, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Coastal Ecology", "Waterfront Communities", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Restoration Efforts": [["seawalls", {"concepts": "seawalls", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "seawalls"}], ["shoreline management", {"concepts": "shoreline management", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "shoreline management"}], ["native species", {"concepts": "native species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "native species"}], ["dredge material", {"concepts": "dredge material", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "dredge material"}], ["mangroves", {"concepts": "mangroves", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "mangroves"}], ["invasive species", {"concepts": "invasive species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "invasive species"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "harmful organisms"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "species diversity"}], ["food web support", {"concepts": "food web support", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web support"}], ["nesting shorebirds", {"concepts": "nesting shorebirds", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "nesting shorebirds"}], ["ecosystem services", {"concepts": "ecosystem services", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "ecosystem services"}], ["food web", {"concepts": "food web", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web"}], ["sea level rise", {"concepts": "sea level rise", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sea level rise"}], ["seawall", {"concepts": "seawall", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "seawall"}], ["carbon storage", {"concepts": "carbon storage", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "carbon storage"}], ["shoreline erosion control", {"concepts": "shoreline erosion control", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "shoreline erosion control"}], ["living shorelines", {"concepts": "living shorelines", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "living shorelines"}], ["coastal engineering", {"concepts": "coastal engineering", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "coastal engineering"}], ["sea walls", {"concepts": "sea walls", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sea walls"}], ["oyster reef", {"concepts": "oyster reef", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "oyster reef"}], ["habitat loss", {"concepts": "habitat loss", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat loss"}], ["marsh walks", {"concepts": "marsh walks", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marsh walks"}], ["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marine resource management"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "biodiversity"}], ["sea level rise advisory council", {"concepts": "sea level rise advisory council", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sea level rise advisory council"}], ["marsh grass", {"concepts": "marsh grass", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marsh grass"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "species of conservation concern"}], ["historic preservation", {"concepts": "historic preservation", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "historic preservation"}], ["turtles", {"concepts": "turtles", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "turtles"}], ["climate management", {"concepts": "climate management", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "climate management"}], ["sediment", {"concepts": "sediment", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "sediment"}], ["tidal zones", {"concepts": "tidal zones", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "tidal zones"}], ["habitat division", {"concepts": "habitat division", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat division"}], ["plant diversity", {"concepts": "plant diversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "plant diversity"}], ["food web species", {"concepts": "food web species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web species"}], ["habitat creation", {"concepts": "habitat creation", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat creation"}], ["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "habitat forming species"}], ["oyster farms", {"concepts": "oyster farms", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "oyster farms"}], ["diversity of plants and animals", {"concepts": "diversity of plants and animals", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "diversity of plants and animals"}], ["department of natural resources", {"concepts": "department of natural resources", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "department of natural resources"}], ["living shorelines act", {"concepts": "living shorelines act", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "living shorelines act"}], ["water quality improvement", {"concepts": "water quality improvement", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "water quality improvement"}], ["marsh", {"concepts": "marsh", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "marsh"}], ["water quality", {"concepts": "water quality", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "water quality"}], ["food web supporting species", {"concepts": "food web supporting species", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "food web supporting species"}], ["watermen", {"concepts": "watermen", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "watermen"}], ["animal diversity", {"concepts": "animal diversity", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "animal diversity"}]], "Impact Assessment": [["restoration", {"concepts": "restoration", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "restoration"}], ["relocation", {"concepts": "relocation", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "relocation"}], ["st. mary\u2019s church", {"concepts": "st. mary\u2019s church", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "st. mary\u2019s church"}], ["permitting hurdles", {"concepts": "permitting hurdles", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "permitting hurdles"}], ["noaa", {"concepts": "noaa", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "noaa"}], ["noaa chesapeake bay office", {"concepts": "noaa chesapeake bay office", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "noaa chesapeake bay office"}], ["teaching", {"concepts": "teaching", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "teaching"}], ["underwood associates", {"concepts": "underwood associates", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "underwood associates"}], ["interview", {"concepts": "interview", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "interview"}], ["military perspective", {"concepts": "military perspective", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "military perspective"}], ["university architect", {"concepts": "university architect", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "university architect"}], ["design build", {"concepts": "design build", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "design build"}], ["regulations", {"concepts": "regulations", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "regulations"}], ["second day", {"concepts": "second day", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "second day"}], ["maryland dnr", {"concepts": "maryland dnr", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "maryland dnr"}], ["adaptive changes", {"concepts": "adaptive changes", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "adaptive changes"}], ["join", {"concepts": "join", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "join"}], ["tourism", {"concepts": "tourism", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "tourism"}], ["bulkheads", {"concepts": "bulkheads", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "bulkheads"}], ["engineering", {"concepts": "engineering", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "engineering"}], ["workshop", {"concepts": "workshop", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "workshop"}], ["naval academy", {"concepts": "naval academy", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "naval academy"}], ["audubon society", {"concepts": "audubon society", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "audubon society"}], ["tourists", {"concepts": "tourists", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "tourists"}], ["workshop invitation", {"concepts": "workshop invitation", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "workshop invitation"}], ["dates", {"concepts": "dates", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "dates"}], ["political dynamics", {"concepts": "political dynamics", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "political dynamics"}], ["system dynamics", {"concepts": "system dynamics", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "system dynamics"}], ["juncus", {"concepts": "juncus", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "juncus"}], ["dnr", {"concepts": "dnr", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "dnr"}], ["phragmites", {"concepts": "phragmites", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "phragmites"}], ["ecotourism", {"concepts": "ecotourism", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "ecotourism"}], ["half day", {"concepts": "half day", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "half day"}], ["flooding", {"concepts": "flooding", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "flooding"}], ["engineering perspective", {"concepts": "engineering perspective", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "engineering perspective"}], ["spartina", {"concepts": "spartina", "type": "concept", "cluster": "Impact Assessment", "node_size": 10, "label": "spartina"}]], "Decision Making": [["medium impact", {"concepts": "medium impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "medium impact"}], ["environmental benefits", {"concepts": "environmental benefits", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "environmental benefits"}], ["co-benefits", {"concepts": "co-benefits", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "co-benefits"}], ["beneficial use", {"concepts": "beneficial use", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "beneficial use"}], ["direct relationships", {"concepts": "direct relationships", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "direct relationships"}], ["high impact", {"concepts": "high impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "high impact"}], ["low impact", {"concepts": "low impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "low impact"}], ["funding", {"concepts": "funding", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "funding"}], ["relative impact", {"concepts": "relative impact", "type": "concept", "cluster": "Decision Making", "node_size": 10, "label": "relative impact"}]], "Waterfront Communities": [["stakeholders", {"concepts": "stakeholders", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "stakeholders"}], ["decision processes", {"concepts": "decision processes", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "decision processes"}], ["management decisions", {"concepts": "management decisions", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "management decisions"}], ["management strategy", {"concepts": "management strategy", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "management strategy"}], ["implementation guidelines", {"concepts": "implementation guidelines", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "implementation guidelines"}], ["stakeholder groups", {"concepts": "stakeholder groups", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "stakeholder groups"}], ["project planning", {"concepts": "project planning", "type": "concept", "cluster": "Waterfront Communities", "node_size": 10, "label": "project planning"}]], "Coastal Ecology": [["waterfront businesses", {"concepts": "waterfront businesses", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "waterfront businesses"}], ["climate change", {"concepts": "climate change", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "climate change"}], ["waterfront homeowners", {"concepts": "waterfront homeowners", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "waterfront homeowners"}], ["waterfront residents", {"concepts": "waterfront residents", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "waterfront residents"}], ["businesses", {"concepts": "businesses", "type": "concept", "cluster": "Coastal Ecology", "node_size": 10, "label": "businesses"}]]};
        const clusterEdges = {"Restoration Efforts": [], "Impact Assessment": [], "Decision Making": [], "Waterfront Communities": [], "Coastal Ecology": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>


<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"binary flags": {"concepts": "binary flags", "concept_list": ["binary flags"], "type": "cluster", "node_size": 18, "label": "binary flags"}, "templated code": {"concepts": "templated code, signed directed graph, graph theory, directed graph", "concept_list": ["templated code", "signed directed graph", "graph theory", "directed graph"], "type": "cluster", "node_size": 27, "label": "templated code"}, "computer visualization software": {"concepts": "computer visualization software", "concept_list": ["computer visualization software"], "type": "cluster", "node_size": 18, "label": "computer visualization software"}, "reverse engineering": {"concepts": "reverse engineering", "concept_list": ["reverse engineering"], "type": "cluster", "node_size": 18, "label": "reverse engineering"}, "disruption": {"concepts": "disruption", "concept_list": ["disruption"], "type": "cluster", "node_size": 18, "label": "disruption"}, "subject matter expert": {"concepts": "subject matter expert", "concept_list": ["subject matter expert"], "type": "cluster", "node_size": 18, "label": "subject matter expert"}, "Stack Identification": {"concepts": "hardware issues, software stack, os-based linux, aarch architecture", "concept_list": ["hardware issues", "software stack", "os-based linux", "aarch architecture"], "type": "cluster", "node_size": 27, "label": "Stack Identification"}, "Dynamic Code Changes": {"concepts": "stack determination, stack", "concept_list": ["stack determination", "stack"], "type": "cluster", "node_size": 21, "label": "Dynamic Code Changes"}, "Runtime Analysis": {"concepts": "dynamic variable code, dynamic code, dynamic code modification, dynamic modifications", "concept_list": ["dynamic variable code", "dynamic code", "dynamic code modification", "dynamic modifications"], "type": "cluster", "node_size": 27, "label": "Runtime Analysis"}, "Time Management": {"concepts": "dynamic analysis, dynamic variable modification, object modifications, runtime type identifier", "concept_list": ["dynamic analysis", "dynamic variable modification", "object modifications", "runtime type identifier"], "type": "cluster", "node_size": 27, "label": "Time Management"}, "Hardware and Software": {"concepts": "time wastage, time constraint, time waster", "concept_list": ["time wastage", "time constraint", "time waster"], "type": "cluster", "node_size": 24, "label": "Hardware and Software"}, "Python Package Management": {"concepts": "program execution, program breakpoint, program modification, breakpoint, buffer-based program", "concept_list": ["program execution", "program breakpoint", "program modification", "breakpoint", "buffer-based program"], "type": "cluster", "node_size": 30, "label": "Python Package Management"}, "Library Security Compatibility": {"concepts": "libc version, library compatibility, openssl modification, diffie-hellman", "concept_list": ["libc version", "library compatibility", "openssl modification", "diffie-hellman"], "type": "cluster", "node_size": 27, "label": "Library Security Compatibility"}, "Automated Reverse Engineering": {"concepts": "automation, ghidra, binwalk", "concept_list": ["automation", "ghidra", "binwalk"], "type": "cluster", "node_size": 24, "label": "Automated Reverse Engineering"}, "Static Binary Compilation": {"concepts": "binary compilation, static compilation, statically compiled binary, compiler strings, compressed section, runtime decompression, instruction patterns, bytecode vm, static analysis, programming language", "concept_list": ["binary compilation", "static compilation", "statically compiled binary", "compiler strings", "compressed section", "runtime decompression", "instruction patterns", "bytecode vm", "static analysis", "programming language"], "type": "cluster", "node_size": 45, "label": "Static Binary Compilation"}, "File and Firmware Formats": {"concepts": "firmware, blob data, file format, docker file, binary file", "concept_list": ["firmware", "blob data", "file format", "docker file", "binary file"], "type": "cluster", "node_size": 30, "label": "File and Firmware Formats"}, "GDB Debugging Tools": {"concepts": "gdb server, gdb debugging, gnu exploitation framework, gdb plugin", "concept_list": ["gdb server", "gdb debugging", "gnu exploitation framework", "gdb plugin"], "type": "cluster", "node_size": 27, "label": "GDB Debugging Tools"}, "System Architecture Basics": {"concepts": "arm architecture, statically linked, dynamically linked, operating system, operating systems, linux, windows, c language", "concept_list": ["arm architecture", "statically linked", "dynamically linked", "operating system", "operating systems", "linux", "windows", "c language"], "type": "cluster", "node_size": 39, "label": "System Architecture Basics"}, "Code Analysis Techniques": {"concepts": "unexpected surprise, positive edge, negative edge, string obfuscation, stack complexity, data flow, linked lists, component frequency, control flow, frequency analysis, file signature, heap management, stack identification, optimization level, cyber attacks, cyber attacker, mitigation strategy", "concept_list": ["unexpected surprise", "positive edge", "negative edge", "string obfuscation", "stack complexity", "data flow", "linked lists", "component frequency", "control flow", "frequency analysis", "file signature", "heap management", "stack identification", "optimization level", "cyber attacks", "cyber attacker", "mitigation strategy"], "type": "cluster", "node_size": 66, "label": "Code Analysis Techniques"}, "Technical Challenge Analysis": {"concepts": "challenge difficulty, challenge complexity, challenge environment, google, tls handshake, multiple languages, remote setup, c++ language, setup mismatch, code decompilation", "concept_list": ["challenge difficulty", "challenge complexity", "challenge environment", "google", "tls handshake", "multiple languages", "remote setup", "c++ language", "setup mismatch", "code decompilation"], "type": "cluster", "node_size": 45, "label": "Technical Challenge Analysis"}, "Binary Data Analysis": {"concepts": "bytecode analysis, socket input, pointers, hex editor, binary analysis", "concept_list": ["bytecode analysis", "socket input", "pointers", "hex editor", "binary analysis"], "type": "cluster", "node_size": 30, "label": "Binary Data Analysis"}, "Script Workflow": {"concepts": "script development, script execution, script creation", "concept_list": ["script development", "script execution", "script creation"], "type": "cluster", "node_size": 24, "label": "Script Workflow"}, "Script Success with ChatGPT": {"concepts": "solve script, script success factors, chatgpt", "concept_list": ["solve script", "script success factors", "chatgpt"], "type": "cluster", "node_size": 24, "label": "Script Success with ChatGPT"}, "Debugging Insights": {"concepts": "debugging challenges, debugging information, debugging info, debugging", "concept_list": ["debugging challenges", "debugging information", "debugging info", "debugging"], "type": "cluster", "node_size": 27, "label": "Debugging Insights"}, "Debugger Usability": {"concepts": "debugger user friendliness, user friendliness, debugger friendliness", "concept_list": ["debugger user friendliness", "user friendliness", "debugger friendliness"], "type": "cluster", "node_size": 24, "label": "Debugger Usability"}, "Influence of Knowledge": {"concepts": "beliefs, prior knowledge, knowledge, decision influence, neutral influence, conditional influence, influential factors", "concept_list": ["beliefs", "prior knowledge", "knowledge", "decision influence", "neutral influence", "conditional influence", "influential factors"], "type": "cluster", "node_size": 36, "label": "Influence of Knowledge"}, "Decision & Problem Solving": {"concepts": "decisions, decision influence, iterative process, problem-solving process, decision making, goal-oriented task analysis, research process", "concept_list": ["decisions", "decision influence", "iterative process", "problem-solving process", "decision making", "goal-oriented task analysis", "research process"], "type": "cluster", "node_size": 36, "label": "Decision & Problem Solving"}, "Remote vs Local Setup": {"concepts": "remote mismatch, geographic location, local setup, environment variables, local vs remote, variable manipulation", "concept_list": ["remote mismatch", "geographic location", "local setup", "environment variables", "local vs remote", "variable manipulation"], "type": "cluster", "node_size": 33, "label": "Remote vs Local Setup"}, "Causal Analysis Methods": {"concepts": "environmental variables, dynamic introspection, research, research tools, distraction, causal factors, causal effect, causal relationship, surprise factors, semi-structured interview, fuzzy cognitive map, issue identification, identification success, teammate collaboration", "concept_list": ["environmental variables", "dynamic introspection", "research", "research tools", "distraction", "causal factors", "causal effect", "causal relationship", "surprise factors", "semi-structured interview", "fuzzy cognitive map", "issue identification", "identification success", "teammate collaboration"], "type": "cluster", "node_size": 57, "label": "Causal Analysis Methods"}, "Elliptic Curve Cryptography": {"concepts": "elliptic curve, ephemeral key, authentication signature, rsa authentication", "concept_list": ["elliptic curve", "ephemeral key", "authentication signature", "rsa authentication"], "type": "cluster", "node_size": 27, "label": "Elliptic Curve Cryptography"}, "Custom Cipher Design": {"concepts": "cipher hooks, block cipher, custom cipher suite", "concept_list": ["cipher hooks", "block cipher", "custom cipher suite"], "type": "cluster", "node_size": 24, "label": "Custom Cipher Design"}, "Programming Languages": {"concepts": "rust language, rust, go language", "concept_list": ["rust language", "rust", "go language"], "type": "cluster", "node_size": 24, "label": "Programming Languages"}, "Template Challenges": {"concepts": "templating, rea challenges, gef", "concept_list": ["templating", "rea challenges", "gef"], "type": "cluster", "node_size": 24, "label": "Template Challenges"}, "Encryption and Type Info": {"concepts": "rc4, rtti", "concept_list": ["rc4", "rtti"], "type": "cluster", "node_size": 21, "label": "Encryption and Type Info"}, "CTF Performance": {"concepts": "ctf, ctf success, bare metal", "concept_list": ["ctf", "ctf success", "bare metal"], "type": "cluster", "node_size": 24, "label": "CTF Performance"}, "Data Structure Complexity": {"concepts": "data structures, data structure complexity, complex data structure", "concept_list": ["data structures", "data structure complexity", "complex data structure"], "type": "cluster", "node_size": 24, "label": "Data Structure Complexity"}, "Data Structure Types": {"concepts": "lattice structure, unstructured data", "concept_list": ["lattice structure", "unstructured data"], "type": "cluster", "node_size": 21, "label": "Data Structure Types"}, "Protocol Management": {"concepts": "tls protocol, protocol identification, protocol handling, custom protocols, custom protocol, network latency, protocol familiarity", "concept_list": ["tls protocol", "protocol identification", "protocol handling", "custom protocols", "custom protocol", "network latency", "protocol familiarity"], "type": "cluster", "node_size": 36, "label": "Protocol Management"}, "Protocol Complexity": {"concepts": "protocol complexity, complex protocols, protocol intricacies", "concept_list": ["protocol complexity", "complex protocols", "protocol intricacies"], "type": "cluster", "node_size": 24, "label": "Protocol Complexity"}, "Code Decompilation": {"concepts": "decompilation, decompiling", "concept_list": ["decompilation", "decompiling"], "type": "cluster", "node_size": 21, "label": "Code Decompilation"}, "Function Identification": {"concepts": "function understanding, function labeling", "concept_list": ["function understanding", "function labeling"], "type": "cluster", "node_size": 21, "label": "Function Identification"}, "Input Techniques": {"concepts": "input method, input methods, input identification, terminal inputs, input statement", "concept_list": ["input method", "input methods", "input identification", "terminal inputs", "input statement"], "type": "cluster", "node_size": 30, "label": "Input Techniques"}, "Architecture Evaluation": {"concepts": "alpha architecture, architecture, architecture determination, legacy architecture", "concept_list": ["alpha architecture", "architecture", "architecture determination", "legacy architecture"], "type": "cluster", "node_size": 27, "label": "Architecture Evaluation"}, "System Architecture Analysis": {"concepts": "infrastructure hosting, memory array, architecture frequency analysis", "concept_list": ["infrastructure hosting", "memory array", "architecture frequency analysis"], "type": "cluster", "node_size": 24, "label": "System Architecture Analysis"}};
        const conceptData = {};
        const interClusterEdges = [["binary flags", "Dynamic Code Changes", {"weight": 1.0, "confidence": 0.7666666666666666, "type": "inter_cluster", "style": "solid"}], ["binary flags", "File and Firmware Formats", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["templated code", "Script Success with ChatGPT", {"weight": -1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["templated code", "Programming Languages", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["computer visualization software", "reverse engineering", {"weight": 1.0, "confidence": 0.6499999999999999, "type": "inter_cluster", "style": "solid"}], ["computer visualization software", "Data Structure Complexity", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "Runtime Analysis", {"weight": 1.0, "confidence": 0.7749999999999999, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "Library Security Compatibility", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "Encryption and Type Info", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "Influence of Knowledge", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["subject matter expert", "Binary Data Analysis", {"weight": 1.0, "confidence": 0.7300000000000001, "type": "inter_cluster", "style": "solid"}], ["subject matter expert", "System Architecture Basics", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Stack Identification", "Template Challenges", {"weight": 0.5, "confidence": 0.325, "type": "inter_cluster", "style": "solid"}], ["Runtime Analysis", "Binary Data Analysis", {"weight": 1.0, "confidence": 0.79, "type": "inter_cluster", "style": "solid"}], ["Runtime Analysis", "Decision & Problem Solving", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Time Management", "Protocol Complexity", {"weight": 1.0, "confidence": 0.825, "type": "inter_cluster", "style": "solid"}], ["Time Management", "Data Structure Types", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Hardware and Software", "Script Success with ChatGPT", {"weight": -0.6666666666666666, "confidence": 0.5833333333333334, "type": "inter_cluster", "style": "solid"}], ["Hardware and Software", "Library Security Compatibility", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Hardware and Software", "Input Techniques", {"weight": -0.3333333333333333, "confidence": 0.26666666666666666, "type": "inter_cluster", "style": "solid"}], ["Python Package Management", "Decision & Problem Solving", {"weight": 1.0, "confidence": 0.8300000000000001, "type": "inter_cluster", "style": "solid"}], ["Python Package Management", "Code Analysis Techniques", {"weight": 1.0, "confidence": 0.825, "type": "inter_cluster", "style": "solid"}], ["Automated Reverse Engineering", "Influence of Knowledge", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Static Binary Compilation", "File and Firmware Formats", {"weight": 1.0, "confidence": 0.8300000000000001, "type": "inter_cluster", "style": "solid"}], ["File and Firmware Formats", "disruption", {"weight": 0.75, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["GDB Debugging Tools", "Causal Analysis Methods", {"weight": 0.8, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["GDB Debugging Tools", "Decision & Problem Solving", {"weight": 0.6666666666666666, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["GDB Debugging Tools", "Static Binary Compilation", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Technical Challenge Analysis", "Python Package Management", {"weight": 0.5, "confidence": 0.8625, "type": "inter_cluster", "style": "solid"}], ["Technical Challenge Analysis", "Code Decompilation", {"weight": 1.0, "confidence": 0.8666666666666667, "type": "inter_cluster", "style": "solid"}], ["Technical Challenge Analysis", "Debugging Insights", {"weight": 1.0, "confidence": 0.875, "type": "inter_cluster", "style": "solid"}], ["Binary Data Analysis", "Protocol Complexity", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Script Workflow", "reverse engineering", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Script Workflow", "Time Management", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["Script Workflow", "Stack Identification", {"weight": -0.3333333333333333, "confidence": 0.25, "type": "inter_cluster", "style": "solid"}], ["Script Success with ChatGPT", "Script Workflow", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["Script Success with ChatGPT", "templated code", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["Script Success with ChatGPT", "Protocol Complexity", {"weight": 0.3333333333333333, "confidence": 0.2833333333333333, "type": "inter_cluster", "style": "solid"}], ["Debugging Insights", "Template Challenges", {"weight": 1.0, "confidence": 0.7833333333333333, "type": "inter_cluster", "style": "solid"}], ["Debugging Insights", "Remote vs Local Setup", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Debugging Insights", "Static Binary Compilation", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["Debugger Usability", "Protocol Management", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Decision & Problem Solving", "Automated Reverse Engineering", {"weight": 0.75, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Decision & Problem Solving", "Python Package Management", {"weight": 1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["Remote vs Local Setup", "disruption", {"weight": 1.0, "confidence": 0.9099999999999999, "type": "inter_cluster", "style": "solid"}], ["Remote vs Local Setup", "Causal Analysis Methods", {"weight": 1.0, "confidence": 0.825, "type": "inter_cluster", "style": "solid"}], ["Remote vs Local Setup", "Function Identification", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Causal Analysis Methods", "Decision & Problem Solving", {"weight": 1.0, "confidence": 0.8333333333333334, "type": "inter_cluster", "style": "solid"}], ["Causal Analysis Methods", "Automated Reverse Engineering", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["Elliptic Curve Cryptography", "Hardware and Software", {"weight": 1.0, "confidence": 0.7166666666666667, "type": "inter_cluster", "style": "solid"}], ["Custom Cipher Design", "Technical Challenge Analysis", {"weight": 1.0, "confidence": 0.7999999999999999, "type": "inter_cluster", "style": "solid"}], ["Programming Languages", "Dynamic Code Changes", {"weight": 1.0, "confidence": 0.8399999999999999, "type": "inter_cluster", "style": "solid"}], ["Programming Languages", "Time Management", {"weight": 1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["CTF Performance", "Python Package Management", {"weight": 1.0, "confidence": 0.8125, "type": "inter_cluster", "style": "solid"}], ["Data Structure Complexity", "Data Structure Types", {"weight": 1.0, "confidence": 0.8125, "type": "inter_cluster", "style": "solid"}], ["Data Structure Types", "Dynamic Code Changes", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Data Structure Types", "Debugger Usability", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Protocol Management", "Python Package Management", {"weight": -1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["Protocol Management", "disruption", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Protocol Complexity", "Code Analysis Techniques", {"weight": 1.0, "confidence": 0.7999999999999999, "type": "inter_cluster", "style": "solid"}], ["Code Decompilation", "reverse engineering", {"weight": 0.75, "confidence": 0.7124999999999999, "type": "inter_cluster", "style": "solid"}], ["Code Decompilation", "File and Firmware Formats", {"weight": 1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["Architecture Evaluation", "Hardware and Software", {"weight": 0.3333333333333333, "confidence": 0.8833333333333333, "type": "inter_cluster", "style": "solid"}], ["System Architecture Analysis", "CTF Performance", {"weight": 0.6666666666666666, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"templated code": [], "Stack Identification": [], "Dynamic Code Changes": [], "Runtime Analysis": [], "Time Management": [], "Hardware and Software": [], "Python Package Management": [], "Library Security Compatibility": [], "Automated Reverse Engineering": [], "Static Binary Compilation": [], "File and Firmware Formats": [], "GDB Debugging Tools": [], "System Architecture Basics": [], "Code Analysis Techniques": [], "Technical Challenge Analysis": [], "Binary Data Analysis": [], "Script Workflow": [], "Script Success with ChatGPT": [], "Debugging Insights": [], "Debugger Usability": [], "Influence of Knowledge": [], "Decision & Problem Solving": [], "Remote vs Local Setup": [], "Causal Analysis Methods": [], "Elliptic Curve Cryptography": [], "Custom Cipher Design": [], "Programming Languages": [], "Template Challenges": [], "Encryption and Type Info": [], "CTF Performance": [], "Data Structure Complexity": [], "Data Structure Types": [], "Protocol Management": [], "Protocol Complexity": [], "Code Decompilation": [], "Function Identification": [], "Input Techniques": [], "Architecture Evaluation": [], "System Architecture Analysis": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

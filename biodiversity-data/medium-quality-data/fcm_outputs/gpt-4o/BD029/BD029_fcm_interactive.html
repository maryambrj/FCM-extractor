
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"saltwater event": {"concepts": "saltwater event", "concept_list": ["saltwater event"], "type": "cluster", "node_size": 18, "label": "saltwater event"}, "marine biodiversity": {"concepts": "marine biodiversity", "concept_list": ["marine biodiversity"], "type": "cluster", "node_size": 18, "label": "marine biodiversity"}, "limestone reefs": {"concepts": "limestone reefs", "concept_list": ["limestone reefs"], "type": "cluster", "node_size": 18, "label": "limestone reefs"}, "pleasure boating": {"concepts": "pleasure boating", "concept_list": ["pleasure boating"], "type": "cluster", "node_size": 18, "label": "pleasure boating"}, "ecotourists": {"concepts": "ecotourists", "concept_list": ["ecotourists"], "type": "cluster", "node_size": 18, "label": "ecotourists"}, "Climate and Weather": {"concepts": "fisheries management, game fish status, fishery population, fishing business, fishing effort, shrimp fishery, fisheries, fishing guide, gill-net fishery, fishery recovery, fishermen, fishery impact", "concept_list": ["fisheries management", "game fish status", "fishery population", "fishing business", "fishing effort", "shrimp fishery", "fisheries", "fishing guide", "gill-net fishery", "fishery recovery", "fishermen", "fishery impact"], "type": "cluster", "node_size": 51, "label": "Climate and Weather"}, "Marine Life Studies": {"concepts": "rainfall, storms, climate change, global warming, hurricanes, tropical storms, weather", "concept_list": ["rainfall", "storms", "climate change", "global warming", "hurricanes", "tropical storms", "weather"], "type": "cluster", "node_size": 36, "label": "Marine Life Studies"}, "Environmental and Economic Factors": {"concepts": "speckled trout, fish counting, sea lab, flounder, oyster shells, shrimping, white trout, fish kills, fish behavior, protected fish, red fish, oyster, marsh", "concept_list": ["speckled trout", "fish counting", "sea lab", "flounder", "oyster shells", "shrimping", "white trout", "fish kills", "fish behavior", "protected fish", "red fish", "oyster", "marsh"], "type": "cluster", "node_size": 54, "label": "Environmental and Economic Factors"}, "Government Jubilees": {"concepts": "covid checks, bull reds, environmental factors, habitat erosion, ship traffic, species, license cost, environmental impact, lobbyist, tropicalization, baldwin county, environmental groups, boat traffic, commercial gill netter, state government, local government, gill netting, dredging, economy, legislation issues, mobile county, inflation, honorarium, vessel monitoring system", "concept_list": ["covid checks", "bull reds", "environmental factors", "habitat erosion", "ship traffic", "species", "license cost", "environmental impact", "lobbyist", "tropicalization", "baldwin county", "environmental groups", "boat traffic", "commercial gill netter", "state government", "local government", "gill netting", "dredging", "economy", "legislation issues", "mobile county", "inflation", "honorarium", "vessel monitoring system"], "type": "cluster", "node_size": 87, "label": "Government Jubilees"}, "Social Media Impact": {"concepts": "piers, business impact, social media, medium impact, management decisions, influencers, negative impact, industrial companies, social media influence, positive impact, stakeholders", "concept_list": ["piers", "business impact", "social media", "medium impact", "management decisions", "influencers", "negative impact", "industrial companies", "social media influence", "positive impact", "stakeholders"], "type": "cluster", "node_size": 48, "label": "Social Media Impact"}, "Mental Models": {"concepts": "guiding, mental modeling, model", "concept_list": ["guiding", "mental modeling", "model"], "type": "cluster", "node_size": 24, "label": "Mental Models"}, "Licensing Regulations": {"concepts": "licensing, mrb regulations, workshop, citations, jubilees, federal government", "concept_list": ["licensing", "mrb regulations", "workshop", "citations", "jubilees", "federal government"], "type": "cluster", "node_size": 33, "label": "Licensing Regulations"}, "MRD Punishments": {"concepts": "mrd, punishment, fuel", "concept_list": ["mrd", "punishment", "fuel"], "type": "cluster", "node_size": 24, "label": "MRD Punishments"}, "Healthcare Policies": {"concepts": "stimulus, hospital, cobia, regulations", "concept_list": ["stimulus", "hospital", "cobia", "regulations"], "type": "cluster", "node_size": 27, "label": "Healthcare Policies"}, "Runoff Management": {"concepts": "construction runoff, sewage runoff, freshwater runoff", "concept_list": ["construction runoff", "sewage runoff", "freshwater runoff"], "type": "cluster", "node_size": 24, "label": "Runoff Management"}, "Alabama Rivers": {"concepts": "alabama river, dog river", "concept_list": ["alabama river", "dog river"], "type": "cluster", "node_size": 21, "label": "Alabama Rivers"}, "River Pollution Control": {"concepts": "breakwaters, fowl river, industrial runoff", "concept_list": ["breakwaters", "fowl river", "industrial runoff"], "type": "cluster", "node_size": 24, "label": "River Pollution Control"}, "Reef Resource Management": {"concepts": "reef permits, marine resource", "concept_list": ["reef permits", "marine resource"], "type": "cluster", "node_size": 21, "label": "Reef Resource Management"}, "Coastal Activities": {"concepts": "marine recreational activities, coastal biodiversity, marine resources, aquaculture, coastal pelagics, migratory pelagics", "concept_list": ["marine recreational activities", "coastal biodiversity", "marine resources", "aquaculture", "coastal pelagics", "migratory pelagics"], "type": "cluster", "node_size": 33, "label": "Coastal Activities"}, "Hotel Infrastructure": {"concepts": "hotel room, bridges", "concept_list": ["hotel room", "bridges"], "type": "cluster", "node_size": 21, "label": "Hotel Infrastructure"}, "Bay Flooding": {"concepts": "mobile bay, flooding", "concept_list": ["mobile bay", "flooding"], "type": "cluster", "node_size": 21, "label": "Bay Flooding"}, "Bayou Fishing": {"concepts": "captain bobby, boat, bayou la batre, yellowtail, spanish mackerel, bait", "concept_list": ["captain bobby", "boat", "bayou la batre", "yellowtail", "spanish mackerel", "bait"], "type": "cluster", "node_size": 33, "label": "Bayou Fishing"}, "Eco Diversity": {"concepts": "habitats, biodiversity, tourism, tropical habitat, rocks", "concept_list": ["habitats", "biodiversity", "tourism", "tropical habitat", "rocks"], "type": "cluster", "node_size": 30, "label": "Eco Diversity"}};
        const conceptData = {"fisheries management": {"concepts": "fisheries management", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fisheries management"}, "game fish status": {"concepts": "game fish status", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "game fish status"}, "fishery population": {"concepts": "fishery population", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishery population"}, "fishing business": {"concepts": "fishing business", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishing business"}, "fishing effort": {"concepts": "fishing effort", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishing effort"}, "shrimp fishery": {"concepts": "shrimp fishery", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "shrimp fishery"}, "fisheries": {"concepts": "fisheries", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fisheries"}, "fishing guide": {"concepts": "fishing guide", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishing guide"}, "gill-net fishery": {"concepts": "gill-net fishery", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "gill-net fishery"}, "fishery recovery": {"concepts": "fishery recovery", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishery recovery"}, "fishermen": {"concepts": "fishermen", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishermen"}, "fishery impact": {"concepts": "fishery impact", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishery impact"}, "rainfall": {"concepts": "rainfall", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "rainfall"}, "storms": {"concepts": "storms", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "storms"}, "climate change": {"concepts": "climate change", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "climate change"}, "global warming": {"concepts": "global warming", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "global warming"}, "hurricanes": {"concepts": "hurricanes", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "hurricanes"}, "tropical storms": {"concepts": "tropical storms", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "tropical storms"}, "weather": {"concepts": "weather", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "weather"}, "speckled trout": {"concepts": "speckled trout", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "speckled trout"}, "fish counting": {"concepts": "fish counting", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "fish counting"}, "sea lab": {"concepts": "sea lab", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "sea lab"}, "flounder": {"concepts": "flounder", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "flounder"}, "oyster shells": {"concepts": "oyster shells", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "oyster shells"}, "shrimping": {"concepts": "shrimping", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "shrimping"}, "white trout": {"concepts": "white trout", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "white trout"}, "fish kills": {"concepts": "fish kills", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "fish kills"}, "fish behavior": {"concepts": "fish behavior", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "fish behavior"}, "protected fish": {"concepts": "protected fish", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "protected fish"}, "red fish": {"concepts": "red fish", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "red fish"}, "oyster": {"concepts": "oyster", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "oyster"}, "marsh": {"concepts": "marsh", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "marsh"}, "covid checks": {"concepts": "covid checks", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "covid checks"}, "bull reds": {"concepts": "bull reds", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "bull reds"}, "environmental factors": {"concepts": "environmental factors", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "environmental factors"}, "habitat erosion": {"concepts": "habitat erosion", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "habitat erosion"}, "ship traffic": {"concepts": "ship traffic", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "ship traffic"}, "species": {"concepts": "species", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "species"}, "license cost": {"concepts": "license cost", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "license cost"}, "environmental impact": {"concepts": "environmental impact", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "environmental impact"}, "lobbyist": {"concepts": "lobbyist", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "lobbyist"}, "tropicalization": {"concepts": "tropicalization", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "tropicalization"}, "baldwin county": {"concepts": "baldwin county", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "baldwin county"}, "environmental groups": {"concepts": "environmental groups", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "environmental groups"}, "boat traffic": {"concepts": "boat traffic", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "boat traffic"}, "commercial gill netter": {"concepts": "commercial gill netter", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "commercial gill netter"}, "state government": {"concepts": "state government", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "state government"}, "local government": {"concepts": "local government", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "local government"}, "gill netting": {"concepts": "gill netting", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "gill netting"}, "dredging": {"concepts": "dredging", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "dredging"}, "economy": {"concepts": "economy", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "economy"}, "legislation issues": {"concepts": "legislation issues", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "legislation issues"}, "mobile county": {"concepts": "mobile county", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "mobile county"}, "inflation": {"concepts": "inflation", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "inflation"}, "honorarium": {"concepts": "honorarium", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "honorarium"}, "vessel monitoring system": {"concepts": "vessel monitoring system", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "vessel monitoring system"}, "piers": {"concepts": "piers", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "piers"}, "business impact": {"concepts": "business impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "business impact"}, "social media": {"concepts": "social media", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "social media"}, "medium impact": {"concepts": "medium impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "medium impact"}, "management decisions": {"concepts": "management decisions", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "management decisions"}, "influencers": {"concepts": "influencers", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "influencers"}, "negative impact": {"concepts": "negative impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "negative impact"}, "industrial companies": {"concepts": "industrial companies", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "industrial companies"}, "social media influence": {"concepts": "social media influence", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "social media influence"}, "positive impact": {"concepts": "positive impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "positive impact"}, "stakeholders": {"concepts": "stakeholders", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "stakeholders"}, "guiding": {"concepts": "guiding", "type": "concept", "cluster": "Mental Models", "node_size": 10, "label": "guiding"}, "mental modeling": {"concepts": "mental modeling", "type": "concept", "cluster": "Mental Models", "node_size": 10, "label": "mental modeling"}, "model": {"concepts": "model", "type": "concept", "cluster": "Mental Models", "node_size": 10, "label": "model"}, "licensing": {"concepts": "licensing", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "licensing"}, "mrb regulations": {"concepts": "mrb regulations", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "mrb regulations"}, "workshop": {"concepts": "workshop", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "workshop"}, "citations": {"concepts": "citations", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "citations"}, "jubilees": {"concepts": "jubilees", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "jubilees"}, "federal government": {"concepts": "federal government", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "federal government"}, "mrd": {"concepts": "mrd", "type": "concept", "cluster": "MRD Punishments", "node_size": 10, "label": "mrd"}, "punishment": {"concepts": "punishment", "type": "concept", "cluster": "MRD Punishments", "node_size": 10, "label": "punishment"}, "fuel": {"concepts": "fuel", "type": "concept", "cluster": "MRD Punishments", "node_size": 10, "label": "fuel"}, "stimulus": {"concepts": "stimulus", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "stimulus"}, "hospital": {"concepts": "hospital", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "hospital"}, "cobia": {"concepts": "cobia", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "cobia"}, "regulations": {"concepts": "regulations", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "regulations"}, "construction runoff": {"concepts": "construction runoff", "type": "concept", "cluster": "Runoff Management", "node_size": 10, "label": "construction runoff"}, "sewage runoff": {"concepts": "sewage runoff", "type": "concept", "cluster": "Runoff Management", "node_size": 10, "label": "sewage runoff"}, "freshwater runoff": {"concepts": "freshwater runoff", "type": "concept", "cluster": "Runoff Management", "node_size": 10, "label": "freshwater runoff"}, "alabama river": {"concepts": "alabama river", "type": "concept", "cluster": "Alabama Rivers", "node_size": 10, "label": "alabama river"}, "dog river": {"concepts": "dog river", "type": "concept", "cluster": "Alabama Rivers", "node_size": 10, "label": "dog river"}, "breakwaters": {"concepts": "breakwaters", "type": "concept", "cluster": "River Pollution Control", "node_size": 10, "label": "breakwaters"}, "fowl river": {"concepts": "fowl river", "type": "concept", "cluster": "River Pollution Control", "node_size": 10, "label": "fowl river"}, "industrial runoff": {"concepts": "industrial runoff", "type": "concept", "cluster": "River Pollution Control", "node_size": 10, "label": "industrial runoff"}, "reef permits": {"concepts": "reef permits", "type": "concept", "cluster": "Reef Resource Management", "node_size": 10, "label": "reef permits"}, "marine resource": {"concepts": "marine resource", "type": "concept", "cluster": "Reef Resource Management", "node_size": 10, "label": "marine resource"}, "marine recreational activities": {"concepts": "marine recreational activities", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "marine recreational activities"}, "coastal biodiversity": {"concepts": "coastal biodiversity", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "coastal biodiversity"}, "marine resources": {"concepts": "marine resources", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "marine resources"}, "aquaculture": {"concepts": "aquaculture", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "aquaculture"}, "coastal pelagics": {"concepts": "coastal pelagics", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "coastal pelagics"}, "migratory pelagics": {"concepts": "migratory pelagics", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "migratory pelagics"}, "hotel room": {"concepts": "hotel room", "type": "concept", "cluster": "Hotel Infrastructure", "node_size": 10, "label": "hotel room"}, "bridges": {"concepts": "bridges", "type": "concept", "cluster": "Hotel Infrastructure", "node_size": 10, "label": "bridges"}, "mobile bay": {"concepts": "mobile bay", "type": "concept", "cluster": "Bay Flooding", "node_size": 10, "label": "mobile bay"}, "flooding": {"concepts": "flooding", "type": "concept", "cluster": "Bay Flooding", "node_size": 10, "label": "flooding"}, "captain bobby": {"concepts": "captain bobby", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "captain bobby"}, "boat": {"concepts": "boat", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "boat"}, "bayou la batre": {"concepts": "bayou la batre", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "bayou la batre"}, "yellowtail": {"concepts": "yellowtail", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "yellowtail"}, "spanish mackerel": {"concepts": "spanish mackerel", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "spanish mackerel"}, "bait": {"concepts": "bait", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "bait"}, "habitats": {"concepts": "habitats", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "habitats"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "biodiversity"}, "tourism": {"concepts": "tourism", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "tourism"}, "tropical habitat": {"concepts": "tropical habitat", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "tropical habitat"}, "rocks": {"concepts": "rocks", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "rocks"}};
        const interClusterEdges = [["saltwater event", "Runoff Management", {"weight": -0.6666666666666666, "confidence": 0.48333333333333334, "type": "inter_cluster", "style": "solid"}], ["marine biodiversity", "Alabama Rivers", {"weight": 0.25, "confidence": 0.5125, "type": "inter_cluster", "style": "solid"}], ["marine biodiversity", "Coastal Activities", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["marine biodiversity", "Reef Resource Management", {"weight": 0.6666666666666666, "confidence": 0.5333333333333333, "type": "inter_cluster", "style": "solid"}], ["marine biodiversity", "Bayou Fishing", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["pleasure boating", "marine biodiversity", {"weight": -0.8, "confidence": 0.5599999999999999, "type": "inter_cluster", "style": "solid"}], ["ecotourists", "limestone reefs", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Climate and Weather", "saltwater event", {"weight": -0.4, "confidence": 0.27, "type": "inter_cluster", "style": "solid"}], ["Marine Life Studies", "marine biodiversity", {"weight": -0.75, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Marine Life Studies", "Environmental and Economic Factors", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Environmental and Economic Factors", "marine biodiversity", {"weight": 1.0, "confidence": 0.8125000000000001, "type": "inter_cluster", "style": "solid"}], ["Environmental and Economic Factors", "pleasure boating", {"weight": -0.6666666666666666, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Environmental and Economic Factors", "Hotel Infrastructure", {"weight": 0.3333333333333333, "confidence": 0.26666666666666666, "type": "inter_cluster", "style": "solid"}], ["Government Jubilees", "Climate and Weather", {"weight": -0.6, "confidence": 0.47000000000000003, "type": "inter_cluster", "style": "solid"}], ["Social Media Impact", "Runoff Management", {"weight": -0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Social Media Impact", "Coastal Activities", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Mental Models", "Eco Diversity", {"weight": 0.75, "confidence": 0.5249999999999999, "type": "inter_cluster", "style": "solid"}], ["Mental Models", "Social Media Impact", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Licensing Regulations", "Climate and Weather", {"weight": 0.25, "confidence": 0.6000000000000001, "type": "inter_cluster", "style": "solid"}], ["Healthcare Policies", "Eco Diversity", {"weight": 0.3333333333333333, "confidence": 0.6833333333333332, "type": "inter_cluster", "style": "solid"}], ["Runoff Management", "River Pollution Control", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Runoff Management", "Government Jubilees", {"weight": -0.6666666666666666, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Runoff Management", "ecotourists", {"weight": -0.4, "confidence": 0.31, "type": "inter_cluster", "style": "solid"}], ["Alabama Rivers", "Runoff Management", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["River Pollution Control", "Marine Life Studies", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["River Pollution Control", "Social Media Impact", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["River Pollution Control", "Coastal Activities", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Reef Resource Management", "marine biodiversity", {"weight": 0.8, "confidence": 0.6599999999999999, "type": "inter_cluster", "style": "solid"}], ["Reef Resource Management", "Bayou Fishing", {"weight": -0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["Coastal Activities", "MRD Punishments", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Bay Flooding", "saltwater event", {"weight": 0.8, "confidence": 0.6300000000000001, "type": "inter_cluster", "style": "solid"}], ["Bay Flooding", "Coastal Activities", {"weight": -0.6666666666666666, "confidence": 0.4666666666666666, "type": "inter_cluster", "style": "solid"}], ["Bayou Fishing", "Licensing Regulations", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["Eco Diversity", "Climate and Weather", {"weight": 0.75, "confidence": 0.625, "type": "inter_cluster", "style": "solid"}], ["Eco Diversity", "Reef Resource Management", {"weight": 0.75, "confidence": 0.575, "type": "inter_cluster", "style": "solid"}], ["Eco Diversity", "Government Jubilees", {"weight": -0.75, "confidence": 0.575, "type": "inter_cluster", "style": "solid"}], ["Eco Diversity", "Licensing Regulations", {"weight": 0.5, "confidence": 0.325, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Climate and Weather": [["fisheries management", {"concepts": "fisheries management", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fisheries management"}], ["game fish status", {"concepts": "game fish status", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "game fish status"}], ["fishery population", {"concepts": "fishery population", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishery population"}], ["fishing business", {"concepts": "fishing business", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishing business"}], ["fishing effort", {"concepts": "fishing effort", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishing effort"}], ["shrimp fishery", {"concepts": "shrimp fishery", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "shrimp fishery"}], ["fisheries", {"concepts": "fisheries", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fisheries"}], ["fishing guide", {"concepts": "fishing guide", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishing guide"}], ["gill-net fishery", {"concepts": "gill-net fishery", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "gill-net fishery"}], ["fishery recovery", {"concepts": "fishery recovery", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishery recovery"}], ["fishermen", {"concepts": "fishermen", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishermen"}], ["fishery impact", {"concepts": "fishery impact", "type": "concept", "cluster": "Climate and Weather", "node_size": 10, "label": "fishery impact"}]], "Marine Life Studies": [["rainfall", {"concepts": "rainfall", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "rainfall"}], ["storms", {"concepts": "storms", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "storms"}], ["climate change", {"concepts": "climate change", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "climate change"}], ["global warming", {"concepts": "global warming", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "global warming"}], ["hurricanes", {"concepts": "hurricanes", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "hurricanes"}], ["tropical storms", {"concepts": "tropical storms", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "tropical storms"}], ["weather", {"concepts": "weather", "type": "concept", "cluster": "Marine Life Studies", "node_size": 10, "label": "weather"}]], "Environmental and Economic Factors": [["speckled trout", {"concepts": "speckled trout", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "speckled trout"}], ["fish counting", {"concepts": "fish counting", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "fish counting"}], ["sea lab", {"concepts": "sea lab", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "sea lab"}], ["flounder", {"concepts": "flounder", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "flounder"}], ["oyster shells", {"concepts": "oyster shells", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "oyster shells"}], ["shrimping", {"concepts": "shrimping", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "shrimping"}], ["white trout", {"concepts": "white trout", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "white trout"}], ["fish kills", {"concepts": "fish kills", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "fish kills"}], ["fish behavior", {"concepts": "fish behavior", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "fish behavior"}], ["protected fish", {"concepts": "protected fish", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "protected fish"}], ["red fish", {"concepts": "red fish", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "red fish"}], ["oyster", {"concepts": "oyster", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "oyster"}], ["marsh", {"concepts": "marsh", "type": "concept", "cluster": "Environmental and Economic Factors", "node_size": 10, "label": "marsh"}]], "Government Jubilees": [["covid checks", {"concepts": "covid checks", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "covid checks"}], ["bull reds", {"concepts": "bull reds", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "bull reds"}], ["environmental factors", {"concepts": "environmental factors", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "environmental factors"}], ["habitat erosion", {"concepts": "habitat erosion", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "habitat erosion"}], ["ship traffic", {"concepts": "ship traffic", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "ship traffic"}], ["species", {"concepts": "species", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "species"}], ["license cost", {"concepts": "license cost", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "license cost"}], ["environmental impact", {"concepts": "environmental impact", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "environmental impact"}], ["lobbyist", {"concepts": "lobbyist", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "lobbyist"}], ["tropicalization", {"concepts": "tropicalization", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "tropicalization"}], ["baldwin county", {"concepts": "baldwin county", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "baldwin county"}], ["environmental groups", {"concepts": "environmental groups", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "environmental groups"}], ["boat traffic", {"concepts": "boat traffic", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "boat traffic"}], ["commercial gill netter", {"concepts": "commercial gill netter", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "commercial gill netter"}], ["state government", {"concepts": "state government", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "state government"}], ["local government", {"concepts": "local government", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "local government"}], ["gill netting", {"concepts": "gill netting", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "gill netting"}], ["dredging", {"concepts": "dredging", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "dredging"}], ["economy", {"concepts": "economy", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "economy"}], ["legislation issues", {"concepts": "legislation issues", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "legislation issues"}], ["mobile county", {"concepts": "mobile county", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "mobile county"}], ["inflation", {"concepts": "inflation", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "inflation"}], ["honorarium", {"concepts": "honorarium", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "honorarium"}], ["vessel monitoring system", {"concepts": "vessel monitoring system", "type": "concept", "cluster": "Government Jubilees", "node_size": 10, "label": "vessel monitoring system"}]], "Social Media Impact": [["piers", {"concepts": "piers", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "piers"}], ["business impact", {"concepts": "business impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "business impact"}], ["social media", {"concepts": "social media", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "social media"}], ["medium impact", {"concepts": "medium impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "medium impact"}], ["management decisions", {"concepts": "management decisions", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "management decisions"}], ["influencers", {"concepts": "influencers", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "influencers"}], ["negative impact", {"concepts": "negative impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "negative impact"}], ["industrial companies", {"concepts": "industrial companies", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "industrial companies"}], ["social media influence", {"concepts": "social media influence", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "social media influence"}], ["positive impact", {"concepts": "positive impact", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "positive impact"}], ["stakeholders", {"concepts": "stakeholders", "type": "concept", "cluster": "Social Media Impact", "node_size": 10, "label": "stakeholders"}]], "Mental Models": [["guiding", {"concepts": "guiding", "type": "concept", "cluster": "Mental Models", "node_size": 10, "label": "guiding"}], ["mental modeling", {"concepts": "mental modeling", "type": "concept", "cluster": "Mental Models", "node_size": 10, "label": "mental modeling"}], ["model", {"concepts": "model", "type": "concept", "cluster": "Mental Models", "node_size": 10, "label": "model"}]], "Licensing Regulations": [["licensing", {"concepts": "licensing", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "licensing"}], ["mrb regulations", {"concepts": "mrb regulations", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "mrb regulations"}], ["workshop", {"concepts": "workshop", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "workshop"}], ["citations", {"concepts": "citations", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "citations"}], ["jubilees", {"concepts": "jubilees", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "jubilees"}], ["federal government", {"concepts": "federal government", "type": "concept", "cluster": "Licensing Regulations", "node_size": 10, "label": "federal government"}]], "MRD Punishments": [["mrd", {"concepts": "mrd", "type": "concept", "cluster": "MRD Punishments", "node_size": 10, "label": "mrd"}], ["punishment", {"concepts": "punishment", "type": "concept", "cluster": "MRD Punishments", "node_size": 10, "label": "punishment"}], ["fuel", {"concepts": "fuel", "type": "concept", "cluster": "MRD Punishments", "node_size": 10, "label": "fuel"}]], "Healthcare Policies": [["stimulus", {"concepts": "stimulus", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "stimulus"}], ["hospital", {"concepts": "hospital", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "hospital"}], ["cobia", {"concepts": "cobia", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "cobia"}], ["regulations", {"concepts": "regulations", "type": "concept", "cluster": "Healthcare Policies", "node_size": 10, "label": "regulations"}]], "Runoff Management": [["construction runoff", {"concepts": "construction runoff", "type": "concept", "cluster": "Runoff Management", "node_size": 10, "label": "construction runoff"}], ["sewage runoff", {"concepts": "sewage runoff", "type": "concept", "cluster": "Runoff Management", "node_size": 10, "label": "sewage runoff"}], ["freshwater runoff", {"concepts": "freshwater runoff", "type": "concept", "cluster": "Runoff Management", "node_size": 10, "label": "freshwater runoff"}]], "Alabama Rivers": [["alabama river", {"concepts": "alabama river", "type": "concept", "cluster": "Alabama Rivers", "node_size": 10, "label": "alabama river"}], ["dog river", {"concepts": "dog river", "type": "concept", "cluster": "Alabama Rivers", "node_size": 10, "label": "dog river"}]], "River Pollution Control": [["breakwaters", {"concepts": "breakwaters", "type": "concept", "cluster": "River Pollution Control", "node_size": 10, "label": "breakwaters"}], ["fowl river", {"concepts": "fowl river", "type": "concept", "cluster": "River Pollution Control", "node_size": 10, "label": "fowl river"}], ["industrial runoff", {"concepts": "industrial runoff", "type": "concept", "cluster": "River Pollution Control", "node_size": 10, "label": "industrial runoff"}]], "Reef Resource Management": [["reef permits", {"concepts": "reef permits", "type": "concept", "cluster": "Reef Resource Management", "node_size": 10, "label": "reef permits"}], ["marine resource", {"concepts": "marine resource", "type": "concept", "cluster": "Reef Resource Management", "node_size": 10, "label": "marine resource"}]], "Coastal Activities": [["marine recreational activities", {"concepts": "marine recreational activities", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "marine recreational activities"}], ["coastal biodiversity", {"concepts": "coastal biodiversity", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "coastal biodiversity"}], ["marine resources", {"concepts": "marine resources", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "marine resources"}], ["aquaculture", {"concepts": "aquaculture", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "aquaculture"}], ["coastal pelagics", {"concepts": "coastal pelagics", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "coastal pelagics"}], ["migratory pelagics", {"concepts": "migratory pelagics", "type": "concept", "cluster": "Coastal Activities", "node_size": 10, "label": "migratory pelagics"}]], "Hotel Infrastructure": [["hotel room", {"concepts": "hotel room", "type": "concept", "cluster": "Hotel Infrastructure", "node_size": 10, "label": "hotel room"}], ["bridges", {"concepts": "bridges", "type": "concept", "cluster": "Hotel Infrastructure", "node_size": 10, "label": "bridges"}]], "Bay Flooding": [["mobile bay", {"concepts": "mobile bay", "type": "concept", "cluster": "Bay Flooding", "node_size": 10, "label": "mobile bay"}], ["flooding", {"concepts": "flooding", "type": "concept", "cluster": "Bay Flooding", "node_size": 10, "label": "flooding"}]], "Bayou Fishing": [["captain bobby", {"concepts": "captain bobby", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "captain bobby"}], ["boat", {"concepts": "boat", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "boat"}], ["bayou la batre", {"concepts": "bayou la batre", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "bayou la batre"}], ["yellowtail", {"concepts": "yellowtail", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "yellowtail"}], ["spanish mackerel", {"concepts": "spanish mackerel", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "spanish mackerel"}], ["bait", {"concepts": "bait", "type": "concept", "cluster": "Bayou Fishing", "node_size": 10, "label": "bait"}]], "Eco Diversity": [["habitats", {"concepts": "habitats", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "habitats"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "biodiversity"}], ["tourism", {"concepts": "tourism", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "tourism"}], ["tropical habitat", {"concepts": "tropical habitat", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "tropical habitat"}], ["rocks", {"concepts": "rocks", "type": "concept", "cluster": "Eco Diversity", "node_size": 10, "label": "rocks"}]]};
        const clusterEdges = {"Climate and Weather": [], "Marine Life Studies": [], "Environmental and Economic Factors": [], "Government Jubilees": [], "Social Media Impact": [], "Mental Models": [], "Licensing Regulations": [], "MRD Punishments": [], "Healthcare Policies": [], "Runoff Management": [], "Alabama Rivers": [], "River Pollution Control": [], "Reef Resource Management": [], "Coastal Activities": [], "Hotel Infrastructure": [], "Bay Flooding": [], "Bayou Fishing": [], "Eco Diversity": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

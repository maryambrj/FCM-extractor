
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"diagramming": {"concepts": "diagramming", "concept_list": ["diagramming"], "type": "cluster", "node_size": 18, "label": "diagramming"}, "process discovery": {"concepts": "process discovery", "concept_list": ["process discovery"], "type": "cluster", "node_size": 18, "label": "process discovery"}, "success reinforcement": {"concepts": "success reinforcement", "concept_list": ["success reinforcement"], "type": "cluster", "node_size": 18, "label": "success reinforcement"}, "red herrings": {"concepts": "red herrings", "concept_list": ["red herrings"], "type": "cluster", "node_size": 18, "label": "red herrings"}, "challenge text": {"concepts": "challenge text", "concept_list": ["challenge text"], "type": "cluster", "node_size": 18, "label": "challenge text"}, "remote context": {"concepts": "remote context", "concept_list": ["remote context"], "type": "cluster", "node_size": 18, "label": "remote context"}, "reverse engineering": {"concepts": "reverse engineering", "concept_list": ["reverse engineering"], "type": "cluster", "node_size": 18, "label": "reverse engineering"}, "beliefs": {"concepts": "beliefs", "concept_list": ["beliefs"], "type": "cluster", "node_size": 18, "label": "beliefs"}, "mitigation steps": {"concepts": "mitigation steps", "concept_list": ["mitigation steps"], "type": "cluster", "node_size": 18, "label": "mitigation steps"}, "give up step": {"concepts": "give up step", "concept_list": ["give up step"], "type": "cluster", "node_size": 18, "label": "give up step"}, "process diagram": {"concepts": "process diagram", "concept_list": ["process diagram"], "type": "cluster", "node_size": 18, "label": "process diagram"}, "breakpoint": {"concepts": "breakpoint", "concept_list": ["breakpoint"], "type": "cluster", "node_size": 18, "label": "breakpoint"}, "acquisition success": {"concepts": "acquisition success", "concept_list": ["acquisition success"], "type": "cluster", "node_size": 18, "label": "acquisition success"}, "process upload": {"concepts": "process upload", "concept_list": ["process upload"], "type": "cluster", "node_size": 18, "label": "process upload"}, "usability": {"concepts": "usability", "concept_list": ["usability"], "type": "cluster", "node_size": 18, "label": "usability"}, "error handling": {"concepts": "error handling", "concept_list": ["error handling"], "type": "cluster", "node_size": 18, "label": "error handling"}, "internal success": {"concepts": "internal success", "concept_list": ["internal success"], "type": "cluster", "node_size": 18, "label": "internal success"}, "static variables": {"concepts": "static variables", "concept_list": ["static variables"], "type": "cluster", "node_size": 18, "label": "static variables"}, "vulnerability": {"concepts": "vulnerability", "concept_list": ["vulnerability"], "type": "cluster", "node_size": 18, "label": "vulnerability"}, "anti-debugger techniques": {"concepts": "anti-debugger techniques", "concept_list": ["anti-debugger techniques"], "type": "cluster", "node_size": 18, "label": "anti-debugger techniques"}, "success": {"concepts": "success", "concept_list": ["success"], "type": "cluster", "node_size": 18, "label": "success"}, "idea validation": {"concepts": "idea validation", "concept_list": ["idea validation"], "type": "cluster", "node_size": 18, "label": "idea validation"}, "negative factors": {"concepts": "negative factors", "concept_list": ["negative factors"], "type": "cluster", "node_size": 18, "label": "negative factors"}, "challenge factors": {"concepts": "challenge factors", "concept_list": ["challenge factors"], "type": "cluster", "node_size": 18, "label": "challenge factors"}, "forward flow": {"concepts": "forward flow", "concept_list": ["forward flow"], "type": "cluster", "node_size": 18, "label": "forward flow"}, "meta knowledge": {"concepts": "meta knowledge", "concept_list": ["meta knowledge"], "type": "cluster", "node_size": 18, "label": "meta knowledge"}, "process challenges": {"concepts": "process challenges", "concept_list": ["process challenges"], "type": "cluster", "node_size": 18, "label": "process challenges"}, "static analysis": {"concepts": "static analysis", "concept_list": ["static analysis"], "type": "cluster", "node_size": 18, "label": "static analysis"}, "server connection": {"concepts": "server connection", "concept_list": ["server connection"], "type": "cluster", "node_size": 18, "label": "server connection"}, "anti-debugger": {"concepts": "anti-debugger", "concept_list": ["anti-debugger"], "type": "cluster", "node_size": 18, "label": "anti-debugger"}, "input": {"concepts": "input", "concept_list": ["input"], "type": "cluster", "node_size": 18, "label": "input"}, "decompilation": {"concepts": "decompilation", "concept_list": ["decompilation"], "type": "cluster", "node_size": 18, "label": "decompilation"}, "factors": {"concepts": "factors", "concept_list": ["factors"], "type": "cluster", "node_size": 18, "label": "factors"}, "primitives": {"concepts": "primitives", "concept_list": ["primitives"], "type": "cluster", "node_size": 18, "label": "primitives"}, "open-ended questions": {"concepts": "open-ended questions", "concept_list": ["open-ended questions"], "type": "cluster", "node_size": 18, "label": "open-ended questions"}, "steps": {"concepts": "steps", "concept_list": ["steps"], "type": "cluster", "node_size": 18, "label": "steps"}, "backward flow": {"concepts": "backward flow", "concept_list": ["backward flow"], "type": "cluster", "node_size": 18, "label": "backward flow"}, "debug strings": {"concepts": "debug strings", "concept_list": ["debug strings"], "type": "cluster", "node_size": 18, "label": "debug strings"}, "process flow": {"concepts": "process flow", "concept_list": ["process flow"], "type": "cluster", "node_size": 18, "label": "process flow"}, "process visualization": {"concepts": "process visualization", "concept_list": ["process visualization"], "type": "cluster", "node_size": 18, "label": "process visualization"}, "indicators": {"concepts": "indicators", "concept_list": ["indicators"], "type": "cluster", "node_size": 18, "label": "indicators"}, "defense system": {"concepts": "defense system", "concept_list": ["defense system"], "type": "cluster", "node_size": 18, "label": "defense system"}, "process matrix": {"concepts": "process matrix", "concept_list": ["process matrix"], "type": "cluster", "node_size": 18, "label": "process matrix"}, "operating system": {"concepts": "operating system", "concept_list": ["operating system"], "type": "cluster", "node_size": 18, "label": "operating system"}, "local context": {"concepts": "local context", "concept_list": ["local context"], "type": "cluster", "node_size": 18, "label": "local context"}, "software tools": {"concepts": "software tools", "concept_list": ["software tools"], "type": "cluster", "node_size": 18, "label": "software tools"}, "idra": {"concepts": "idra", "concept_list": ["idra"], "type": "cluster", "node_size": 18, "label": "idra"}, "exploit": {"concepts": "exploit", "concept_list": ["exploit"], "type": "cluster", "node_size": 18, "label": "exploit"}, "romper": {"concepts": "romper", "concept_list": ["romper"], "type": "cluster", "node_size": 18, "label": "romper"}, "code analysis": {"concepts": "code analysis", "concept_list": ["code analysis"], "type": "cluster", "node_size": 18, "label": "code analysis"}, "process judgment": {"concepts": "process judgment", "concept_list": ["process judgment"], "type": "cluster", "node_size": 18, "label": "process judgment"}, "alternatives": {"concepts": "alternatives", "concept_list": ["alternatives"], "type": "cluster", "node_size": 18, "label": "alternatives"}, "code readability": {"concepts": "code readability", "concept_list": ["code readability"], "type": "cluster", "node_size": 18, "label": "code readability"}, "mitigations": {"concepts": "mitigations", "concept_list": ["mitigations"], "type": "cluster", "node_size": 18, "label": "mitigations"}, "assumptions": {"concepts": "assumptions", "concept_list": ["assumptions"], "type": "cluster", "node_size": 18, "label": "assumptions"}, "experimenter": {"concepts": "experimenter", "concept_list": ["experimenter"], "type": "cluster", "node_size": 18, "label": "experimenter"}, "confirmation": {"concepts": "confirmation", "concept_list": ["confirmation"], "type": "cluster", "node_size": 18, "label": "confirmation"}, "tool availability": {"concepts": "tool availability", "concept_list": ["tool availability"], "type": "cluster", "node_size": 18, "label": "tool availability"}, "character leak": {"concepts": "character leak", "concept_list": ["character leak"], "type": "cluster", "node_size": 18, "label": "character leak"}, "process success": {"concepts": "process success", "concept_list": ["process success"], "type": "cluster", "node_size": 18, "label": "process success"}, "discovery process": {"concepts": "discovery process", "concept_list": ["discovery process"], "type": "cluster", "node_size": 18, "label": "discovery process"}, "execution mode": {"concepts": "execution mode", "concept_list": ["execution mode"], "type": "cluster", "node_size": 18, "label": "execution mode"}, "step reinforcement": {"concepts": "step reinforcement", "concept_list": ["step reinforcement"], "type": "cluster", "node_size": 18, "label": "step reinforcement"}, "participant response": {"concepts": "participant response", "concept_list": ["participant response"], "type": "cluster", "node_size": 18, "label": "participant response"}, "tools": {"concepts": "tools", "concept_list": ["tools"], "type": "cluster", "node_size": 18, "label": "tools"}, "process factors": {"concepts": "process factors", "concept_list": ["process factors"], "type": "cluster", "node_size": 18, "label": "process factors"}, "tool usability": {"concepts": "tool usability", "concept_list": ["tool usability"], "type": "cluster", "node_size": 18, "label": "tool usability"}, "remote exploit": {"concepts": "remote exploit", "concept_list": ["remote exploit"], "type": "cluster", "node_size": 18, "label": "remote exploit"}, "malware techniques": {"concepts": "malware techniques", "concept_list": ["malware techniques"], "type": "cluster", "node_size": 18, "label": "malware techniques"}, "alternative tools": {"concepts": "alternative tools", "concept_list": ["alternative tools"], "type": "cluster", "node_size": 18, "label": "alternative tools"}, "common bugs": {"concepts": "common bugs", "concept_list": ["common bugs"], "type": "cluster", "node_size": 18, "label": "common bugs"}, "code obfuscation": {"concepts": "code obfuscation", "concept_list": ["code obfuscation"], "type": "cluster", "node_size": 18, "label": "code obfuscation"}, "success likelihood": {"concepts": "success likelihood", "concept_list": ["success likelihood"], "type": "cluster", "node_size": 18, "label": "success likelihood"}, "instructions": {"concepts": "instructions", "concept_list": ["instructions"], "type": "cluster", "node_size": 18, "label": "instructions"}, "participant": {"concepts": "participant", "concept_list": ["participant"], "type": "cluster", "node_size": 18, "label": "participant"}, "failure": {"concepts": "failure", "concept_list": ["failure"], "type": "cluster", "node_size": 18, "label": "failure"}, "control flow": {"concepts": "control flow", "concept_list": ["control flow"], "type": "cluster", "node_size": 18, "label": "control flow"}, "distraction": {"concepts": "distraction", "concept_list": ["distraction"], "type": "cluster", "node_size": 18, "label": "distraction"}, "instance analysis": {"concepts": "instance analysis", "concept_list": ["instance analysis"], "type": "cluster", "node_size": 18, "label": "instance analysis"}, "semi-structured interview": {"concepts": "semi-structured interview", "concept_list": ["semi-structured interview"], "type": "cluster", "node_size": 18, "label": "semi-structured interview"}, "local exploit": {"concepts": "local exploit", "concept_list": ["local exploit"], "type": "cluster", "node_size": 18, "label": "local exploit"}, "versions": {"concepts": "versions", "concept_list": ["versions"], "type": "cluster", "node_size": 18, "label": "versions"}, "enabler": {"concepts": "enabler", "concept_list": ["enabler"], "type": "cluster", "node_size": 18, "label": "enabler"}, "decompilers": {"concepts": "decompilers", "concept_list": ["decompilers"], "type": "cluster", "node_size": 18, "label": "decompilers"}, "versioning": {"concepts": "versioning", "concept_list": ["versioning"], "type": "cluster", "node_size": 18, "label": "versioning"}, "process connection": {"concepts": "process connection", "concept_list": ["process connection"], "type": "cluster", "node_size": 18, "label": "process connection"}, "approach": {"concepts": "approach", "concept_list": ["approach"], "type": "cluster", "node_size": 18, "label": "approach"}, "ropper": {"concepts": "ropper", "concept_list": ["ropper"], "type": "cluster", "node_size": 18, "label": "ropper"}, "debugger": {"concepts": "debugger", "concept_list": ["debugger"], "type": "cluster", "node_size": 18, "label": "debugger"}, "technical issues": {"concepts": "technical issues", "concept_list": ["technical issues"], "type": "cluster", "node_size": 18, "label": "technical issues"}, "diagram": {"concepts": "diagram", "concept_list": ["diagram"], "type": "cluster", "node_size": 18, "label": "diagram"}, "positive factors": {"concepts": "positive factors", "concept_list": ["positive factors"], "type": "cluster", "node_size": 18, "label": "positive factors"}, "local execution": {"concepts": "local execution", "concept_list": ["local execution"], "type": "cluster", "node_size": 18, "label": "local execution"}, "category iteration": {"concepts": "category iteration", "concept_list": ["category iteration"], "type": "cluster", "node_size": 18, "label": "category iteration"}, "attackers": {"concepts": "attackers", "concept_list": ["attackers"], "type": "cluster", "node_size": 18, "label": "attackers"}, "decompilation readability": {"concepts": "decompilation readability", "concept_list": ["decompilation readability"], "type": "cluster", "node_size": 18, "label": "decompilation readability"}, "knowledge": {"concepts": "knowledge", "concept_list": ["knowledge"], "type": "cluster", "node_size": 18, "label": "knowledge"}, "configuration": {"concepts": "configuration", "concept_list": ["configuration"], "type": "cluster", "node_size": 18, "label": "configuration"}, "architecture": {"concepts": "architecture", "concept_list": ["architecture"], "type": "cluster", "node_size": 18, "label": "architecture"}, "process structure": {"concepts": "process structure", "concept_list": ["process structure"], "type": "cluster", "node_size": 18, "label": "process structure"}, "fcm exercise": {"concepts": "fcm exercise", "concept_list": ["fcm exercise"], "type": "cluster", "node_size": 18, "label": "fcm exercise"}, "arm": {"concepts": "arm", "concept_list": ["arm"], "type": "cluster", "node_size": 18, "label": "arm"}, "process failure": {"concepts": "process failure", "concept_list": ["process failure"], "type": "cluster", "node_size": 18, "label": "process failure"}, "architecture switching": {"concepts": "architecture switching", "concept_list": ["architecture switching"], "type": "cluster", "node_size": 18, "label": "architecture switching"}, "example recall": {"concepts": "example recall", "concept_list": ["example recall"], "type": "cluster", "node_size": 18, "label": "example recall"}, "progress barriers": {"concepts": "progress barriers", "concept_list": ["progress barriers"], "type": "cluster", "node_size": 18, "label": "progress barriers"}, "failure factors": {"concepts": "failure factors", "concept_list": ["failure factors"], "type": "cluster", "node_size": 18, "label": "failure factors"}, "proof of concept": {"concepts": "proof of concept", "concept_list": ["proof of concept"], "type": "cluster", "node_size": 18, "label": "proof of concept"}, "enablers": {"concepts": "enablers", "concept_list": ["enablers"], "type": "cluster", "node_size": 18, "label": "enablers"}, "remote progress": {"concepts": "remote progress", "concept_list": ["remote progress"], "type": "cluster", "node_size": 18, "label": "remote progress"}, "readability": {"concepts": "readability", "concept_list": ["readability"], "type": "cluster", "node_size": 18, "label": "readability"}, "process iteration": {"concepts": "process iteration", "concept_list": ["process iteration"], "type": "cluster", "node_size": 18, "label": "process iteration"}, "disruption": {"concepts": "disruption", "concept_list": ["disruption"], "type": "cluster", "node_size": 18, "label": "disruption"}, "misleading file headers": {"concepts": "misleading file headers", "concept_list": ["misleading file headers"], "type": "cluster", "node_size": 18, "label": "misleading file headers"}, "flag": {"concepts": "flag", "concept_list": ["flag"], "type": "cluster", "node_size": 18, "label": "flag"}, "program execution": {"concepts": "program execution", "concept_list": ["program execution"], "type": "cluster", "node_size": 18, "label": "program execution"}, "vulnerability analysis": {"concepts": "vulnerability analysis", "concept_list": ["vulnerability analysis"], "type": "cluster", "node_size": 18, "label": "vulnerability analysis"}, "chaining primitives": {"concepts": "chaining primitives", "concept_list": ["chaining primitives"], "type": "cluster", "node_size": 18, "label": "chaining primitives"}, "influence": {"concepts": "influence", "concept_list": ["influence"], "type": "cluster", "node_size": 18, "label": "influence"}, "exploit primitives": {"concepts": "exploit primitives", "concept_list": ["exploit primitives"], "type": "cluster", "node_size": 18, "label": "exploit primitives"}, "technical roles": {"concepts": "technical roles", "concept_list": ["technical roles"], "type": "cluster", "node_size": 18, "label": "technical roles"}, "disruptions": {"concepts": "disruptions", "concept_list": ["disruptions"], "type": "cluster", "node_size": 18, "label": "disruptions"}, "architectures": {"concepts": "architectures", "concept_list": ["architectures"], "type": "cluster", "node_size": 18, "label": "architectures"}, "mediation": {"concepts": "mediation", "concept_list": ["mediation"], "type": "cluster", "node_size": 18, "label": "mediation"}, "local setup": {"concepts": "local setup", "concept_list": ["local setup"], "type": "cluster", "node_size": 18, "label": "local setup"}, "mixed outcome": {"concepts": "mixed outcome", "concept_list": ["mixed outcome"], "type": "cluster", "node_size": 18, "label": "mixed outcome"}, "technical barriers": {"concepts": "technical barriers", "concept_list": ["technical barriers"], "type": "cluster", "node_size": 18, "label": "technical barriers"}, "cyber attacks": {"concepts": "cyber attacks", "concept_list": ["cyber attacks"], "type": "cluster", "node_size": 18, "label": "cyber attacks"}, "troubleshooting": {"concepts": "troubleshooting", "concept_list": ["troubleshooting"], "type": "cluster", "node_size": 18, "label": "troubleshooting"}, "system compatibility": {"concepts": "system compatibility", "concept_list": ["system compatibility"], "type": "cluster", "node_size": 18, "label": "system compatibility"}, "data execution prevention": {"concepts": "data execution prevention", "concept_list": ["data execution prevention"], "type": "cluster", "node_size": 18, "label": "data execution prevention"}, "language support": {"concepts": "language support", "concept_list": ["language support"], "type": "cluster", "node_size": 18, "label": "language support"}, "cts": {"concepts": "cts", "concept_list": ["cts"], "type": "cluster", "node_size": 18, "label": "cts"}, "step iteration": {"concepts": "step iteration", "concept_list": ["step iteration"], "type": "cluster", "node_size": 18, "label": "step iteration"}, "self-unpacking binary": {"concepts": "self-unpacking binary", "concept_list": ["self-unpacking binary"], "type": "cluster", "node_size": 18, "label": "self-unpacking binary"}, "dynamic variables": {"concepts": "dynamic variables", "concept_list": ["dynamic variables"], "type": "cluster", "node_size": 18, "label": "dynamic variables"}, "file acquisition": {"concepts": "file acquisition", "concept_list": ["file acquisition"], "type": "cluster", "node_size": 18, "label": "file acquisition"}, "logs": {"concepts": "logs", "concept_list": ["logs"], "type": "cluster", "node_size": 18, "label": "logs"}, "setup": {"concepts": "setup", "concept_list": ["setup"], "type": "cluster", "node_size": 18, "label": "setup"}, "success factors": {"concepts": "success factors", "concept_list": ["success factors"], "type": "cluster", "node_size": 18, "label": "success factors"}, "process interpretation": {"concepts": "process interpretation", "concept_list": ["process interpretation"], "type": "cluster", "node_size": 18, "label": "process interpretation"}, "downloading files": {"concepts": "downloading files", "concept_list": ["downloading files"], "type": "cluster", "node_size": 18, "label": "downloading files"}, "support": {"concepts": "support", "concept_list": ["support"], "type": "cluster", "node_size": 18, "label": "support"}, "identification": {"concepts": "identification", "concept_list": ["identification"], "type": "cluster", "node_size": 18, "label": "identification"}, "negative relationship": {"concepts": "negative relationship", "concept_list": ["negative relationship"], "type": "cluster", "node_size": 18, "label": "negative relationship"}, "aslr": {"concepts": "aslr", "concept_list": ["aslr"], "type": "cluster", "node_size": 18, "label": "aslr"}, "factor": {"concepts": "factor", "concept_list": ["factor"], "type": "cluster", "node_size": 18, "label": "factor"}, "error reduction": {"concepts": "error reduction", "concept_list": ["error reduction"], "type": "cluster", "node_size": 18, "label": "error reduction"}, "decompiler": {"concepts": "decompiler", "concept_list": ["decompiler"], "type": "cluster", "node_size": 18, "label": "decompiler"}, "iterative process": {"concepts": "iterative process", "concept_list": ["iterative process"], "type": "cluster", "node_size": 18, "label": "iterative process"}, "challenge files": {"concepts": "challenge files", "concept_list": ["challenge files"], "type": "cluster", "node_size": 18, "label": "challenge files"}, "participant experience": {"concepts": "participant experience", "concept_list": ["participant experience"], "type": "cluster", "node_size": 18, "label": "participant experience"}, "polyglot": {"concepts": "polyglot", "concept_list": ["polyglot"], "type": "cluster", "node_size": 18, "label": "polyglot"}};
        const conceptData = {};
        const interClusterEdges = [["process discovery", "static variables", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["success reinforcement", "technical barriers", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["red herrings", "disruption", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["remote context", "dynamic variables", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "instance analysis", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["beliefs", "cyber attacks", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["give up step", "configuration", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["give up step", "distraction", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["process diagram", "step iteration", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["process upload", "language support", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["error handling", "language support", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["internal success", "enabler", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["static variables", "failure", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["vulnerability", "attackers", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["anti-debugger techniques", "cyber attacks", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["idea validation", "program execution", {"weight": 1.0, "confidence": 0.675, "type": "inter_cluster", "style": "solid"}], ["negative factors", "internal success", {"weight": -1.0, "confidence": 0.7999999999999999, "type": "inter_cluster", "style": "solid"}], ["challenge factors", "code obfuscation", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["forward flow", "success", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["process challenges", "operating system", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["static analysis", "control flow", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["server connection", "iterative process", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["anti-debugger", "factors", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["input", "process factors", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["decompilation", "flag", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["primitives", "success likelihood", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["steps", "process structure", {"weight": 1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["steps", "decompilation readability", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["steps", "positive factors", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["backward flow", "challenge text", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["debug strings", "positive factors", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["process flow", "downloading files", {"weight": 1.0, "confidence": 0.6499999999999999, "type": "inter_cluster", "style": "solid"}], ["process flow", "file acquisition", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["defense system", "process upload", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["process matrix", "discovery process", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["operating system", "tools", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["operating system", "ropper", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["local context", "idea validation", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["software tools", "mediation", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["romper", "give up step", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["alternatives", "process connection", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["code readability", "instructions", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["mitigations", "process upload", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["experimenter", "process iteration", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["character leak", "technical issues", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["process success", "downloading files", {"weight": 1.0, "confidence": 0.8333333333333334, "type": "inter_cluster", "style": "solid"}], ["process success", "success factors", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["execution mode", "idra", {"weight": -0.5, "confidence": 0.325, "type": "inter_cluster", "style": "solid"}], ["step reinforcement", "flag", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["participant response", "vulnerability analysis", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["tool usability", "challenge factors", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["remote exploit", "data execution prevention", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["malware techniques", "process success", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["common bugs", "acquisition success", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["common bugs", "enablers", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["participant", "approach", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["control flow", "common bugs", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["instance analysis", "character leak", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["semi-structured interview", "process discovery", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["local exploit", "progress barriers", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["versions", "error handling", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["decompilers", "enablers", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["versioning", "negative factors", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["versioning", "tools", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["debugger", "exploit", {"weight": 1.0, "confidence": 0.875, "type": "inter_cluster", "style": "solid"}], ["technical issues", "distraction", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["technical issues", "code analysis", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["diagram", "readability", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["positive factors", "misleading file headers", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["local execution", "data execution prevention", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["category iteration", "local setup", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["attackers", "approach", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["attackers", "success likelihood", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["decompilation readability", "influence", {"weight": 1.0, "confidence": 0.8500000000000001, "type": "inter_cluster", "style": "solid"}], ["decompilation readability", "readability", {"weight": 1.0, "confidence": 1.0, "type": "inter_cluster", "style": "solid"}], ["knowledge", "attackers", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["configuration", "remote progress", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["configuration", "support", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["architecture", "mitigations", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["architecture", "decompilation", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["architecture", "assumptions", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["process structure", "open-ended questions", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["fcm exercise", "category iteration", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["arm", "cts", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["process failure", "readability", {"weight": -1.0, "confidence": 0.7333333333333334, "type": "inter_cluster", "style": "solid"}], ["process failure", "decompiler", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["architecture switching", "static analysis", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["example recall", "process visualization", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["example recall", "identification", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["progress barriers", "failure factors", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["failure factors", "setup", {"weight": -1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["failure factors", "vulnerability", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["proof of concept", "steps", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["enablers", "diagramming", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["readability", "architectures", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["exploit primitives", "meta knowledge", {"weight": 1.0, "confidence": 0.6000000000000001, "type": "inter_cluster", "style": "solid"}], ["technical roles", "tool availability", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["disruptions", "assumptions", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["mediation", "success", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["mixed outcome", "step iteration", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["technical barriers", "primitives", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["troubleshooting", "usability", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["system compatibility", "idra", {"weight": 1.0, "confidence": 0.8999999999999999, "type": "inter_cluster", "style": "solid"}], ["self-unpacking binary", "indicators", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["self-unpacking binary", "breakpoint", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["dynamic variables", "program execution", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["logs", "decompiler", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["setup", "technical issues", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["setup", "mitigation steps", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["setup", "downloading files", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["success factors", "local execution", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["process interpretation", "challenge factors", {"weight": 0.6666666666666666, "confidence": 0.4166666666666667, "type": "inter_cluster", "style": "solid"}], ["process interpretation", "confirmation", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["process interpretation", "code obfuscation", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["downloading files", "backward flow", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["identification", "process judgment", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["negative relationship", "acquisition success", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["aslr", "software tools", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["factor", "alternative tools", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["error reduction", "process challenges", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["error reduction", "process interpretation", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["decompiler", "chaining primitives", {"weight": 1.0, "confidence": 0.7250000000000001, "type": "inter_cluster", "style": "solid"}], ["challenge files", "setup", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["participant experience", "vulnerability", {"weight": 1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["polyglot", "process interpretation", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["polyglot", "alternative tools", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>


<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Cultural Perspectives": {"concepts": "university, professors, university collaboration, academic collaboration", "concept_list": ["university", "professors", "university collaboration", "academic collaboration"], "type": "cluster", "node_size": 27, "label": "Cultural Perspectives"}, "Habitat Conservation": {"concepts": "perspective, scientific research, changing environments, small streams, beaver relocation, hindu, indigenous, christian, daoist culture, industrial laundry, population, resource management, muslim, religion, workshop, organizational culture, population focus, culture, christian culture, harvard conferences, cancer, property rights, hummingbirds, pvds, public relations, conservation, fire retardants, organizational change, delayed mortality, interfaith dialogue, cultural context, muslim culture, industrial laundry facilities, indigenous culture, regulatory, daoist, christian perspective, conference, orca recovery, data analysis, gps tracking, cultural diversity, public outreach, ethics, management, cultural change, institutional culture, political processes, pharmaceuticals, tire chemicals, food chain, regulatory component, chemical contamination, pvd, chesapeake workshop, hindu culture, cultural dependence, dominion perspective, treaties, elk slough, beaver structures, steering committee, equestrian activities", "concept_list": ["perspective", "scientific research", "changing environments", "small streams", "beaver relocation", "hindu", "indigenous", "christian", "daoist culture", "industrial laundry", "population", "resource management", "muslim", "religion", "workshop", "organizational culture", "population focus", "culture", "christian culture", "harvard conferences", "cancer", "property rights", "hummingbirds", "pvds", "public relations", "conservation", "fire retardants", "organizational change", "delayed mortality", "interfaith dialogue", "cultural context", "muslim culture", "industrial laundry facilities", "indigenous culture", "regulatory", "daoist", "christian perspective", "conference", "orca recovery", "data analysis", "gps tracking", "cultural diversity", "public outreach", "ethics", "management", "cultural change", "institutional culture", "political processes", "pharmaceuticals", "tire chemicals", "food chain", "regulatory component", "chemical contamination", "pvd", "chesapeake workshop", "hindu culture", "cultural dependence", "dominion perspective", "treaties", "elk slough", "beaver structures", "steering committee", "equestrian activities"], "type": "cluster", "node_size": 204, "label": "Habitat Conservation"}, "Legal Frameworks": {"concepts": "habitat protection, critical habitats, critical habitat, rearing ponds, pelagic zone, ecosystem functions, lush vegetation, northern california, salmon recovery, marshlands, species protection, trophic bottleneck, estuaries, fisheries, marine habitat, wetlands, ecological connectivity, habitat complexity, biodiversity, waterfowl, habitat methods, natal river, national fish habitat partnerships, shallow habitat, water quality, species of concern, national fish habitat partnership, ecological research, habitat engineers, songbirds, forage fish, fish populations, forestry, ecology, marine habitats, water quality testing, ecosystem recovery, nearshore habitat, fish habitat partnership, coastal restoration, fish habitat partnerships, insect populations, shifting ecosystems, multidimensional habitats, forest restoration, species diversity, climate change, indicator species, habitat restoration, shade cover, wildlife", "concept_list": ["habitat protection", "critical habitats", "critical habitat", "rearing ponds", "pelagic zone", "ecosystem functions", "lush vegetation", "northern california", "salmon recovery", "marshlands", "species protection", "trophic bottleneck", "estuaries", "fisheries", "marine habitat", "wetlands", "ecological connectivity", "habitat complexity", "biodiversity", "waterfowl", "habitat methods", "natal river", "national fish habitat partnerships", "shallow habitat", "water quality", "species of concern", "national fish habitat partnership", "ecological research", "habitat engineers", "songbirds", "forage fish", "fish populations", "forestry", "ecology", "marine habitats", "water quality testing", "ecosystem recovery", "nearshore habitat", "fish habitat partnership", "coastal restoration", "fish habitat partnerships", "insect populations", "shifting ecosystems", "multidimensional habitats", "forest restoration", "species diversity", "climate change", "indicator species", "habitat restoration", "shade cover", "wildlife"], "type": "cluster", "node_size": 168, "label": "Legal Frameworks"}, "Academic Collaboration": {"concepts": "legal frameworks, judeo, legal framework, legal, judeo culture, legal advocacy", "concept_list": ["legal frameworks", "judeo", "legal framework", "legal", "judeo culture", "legal advocacy"], "type": "cluster", "node_size": 33, "label": "Academic Collaboration"}};
        const conceptData = {"university": {"concepts": "university", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "university"}, "professors": {"concepts": "professors", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "professors"}, "university collaboration": {"concepts": "university collaboration", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "university collaboration"}, "academic collaboration": {"concepts": "academic collaboration", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "academic collaboration"}, "perspective": {"concepts": "perspective", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "perspective"}, "scientific research": {"concepts": "scientific research", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "scientific research"}, "changing environments": {"concepts": "changing environments", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "changing environments"}, "small streams": {"concepts": "small streams", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "small streams"}, "beaver relocation": {"concepts": "beaver relocation", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "beaver relocation"}, "hindu": {"concepts": "hindu", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "hindu"}, "indigenous": {"concepts": "indigenous", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "indigenous"}, "christian": {"concepts": "christian", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "christian"}, "daoist culture": {"concepts": "daoist culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "daoist culture"}, "industrial laundry": {"concepts": "industrial laundry", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "industrial laundry"}, "population": {"concepts": "population", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "population"}, "resource management": {"concepts": "resource management", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "resource management"}, "muslim": {"concepts": "muslim", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "muslim"}, "religion": {"concepts": "religion", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "religion"}, "workshop": {"concepts": "workshop", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "workshop"}, "organizational culture": {"concepts": "organizational culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "organizational culture"}, "population focus": {"concepts": "population focus", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "population focus"}, "culture": {"concepts": "culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "culture"}, "christian culture": {"concepts": "christian culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "christian culture"}, "harvard conferences": {"concepts": "harvard conferences", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "harvard conferences"}, "cancer": {"concepts": "cancer", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cancer"}, "property rights": {"concepts": "property rights", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "property rights"}, "hummingbirds": {"concepts": "hummingbirds", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "hummingbirds"}, "pvds": {"concepts": "pvds", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "pvds"}, "public relations": {"concepts": "public relations", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "public relations"}, "conservation": {"concepts": "conservation", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "conservation"}, "fire retardants": {"concepts": "fire retardants", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "fire retardants"}, "organizational change": {"concepts": "organizational change", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "organizational change"}, "delayed mortality": {"concepts": "delayed mortality", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "delayed mortality"}, "interfaith dialogue": {"concepts": "interfaith dialogue", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "interfaith dialogue"}, "cultural context": {"concepts": "cultural context", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural context"}, "muslim culture": {"concepts": "muslim culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "muslim culture"}, "industrial laundry facilities": {"concepts": "industrial laundry facilities", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "industrial laundry facilities"}, "indigenous culture": {"concepts": "indigenous culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "indigenous culture"}, "regulatory": {"concepts": "regulatory", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "regulatory"}, "daoist": {"concepts": "daoist", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "daoist"}, "christian perspective": {"concepts": "christian perspective", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "christian perspective"}, "conference": {"concepts": "conference", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "conference"}, "orca recovery": {"concepts": "orca recovery", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "orca recovery"}, "data analysis": {"concepts": "data analysis", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "data analysis"}, "gps tracking": {"concepts": "gps tracking", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "gps tracking"}, "cultural diversity": {"concepts": "cultural diversity", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural diversity"}, "public outreach": {"concepts": "public outreach", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "public outreach"}, "ethics": {"concepts": "ethics", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "ethics"}, "management": {"concepts": "management", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "management"}, "cultural change": {"concepts": "cultural change", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural change"}, "institutional culture": {"concepts": "institutional culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "institutional culture"}, "political processes": {"concepts": "political processes", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "political processes"}, "pharmaceuticals": {"concepts": "pharmaceuticals", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "pharmaceuticals"}, "tire chemicals": {"concepts": "tire chemicals", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "tire chemicals"}, "food chain": {"concepts": "food chain", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "food chain"}, "regulatory component": {"concepts": "regulatory component", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "regulatory component"}, "chemical contamination": {"concepts": "chemical contamination", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "chemical contamination"}, "pvd": {"concepts": "pvd", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "pvd"}, "chesapeake workshop": {"concepts": "chesapeake workshop", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "chesapeake workshop"}, "hindu culture": {"concepts": "hindu culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "hindu culture"}, "cultural dependence": {"concepts": "cultural dependence", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural dependence"}, "dominion perspective": {"concepts": "dominion perspective", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "dominion perspective"}, "treaties": {"concepts": "treaties", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "treaties"}, "elk slough": {"concepts": "elk slough", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "elk slough"}, "beaver structures": {"concepts": "beaver structures", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "beaver structures"}, "steering committee": {"concepts": "steering committee", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "steering committee"}, "equestrian activities": {"concepts": "equestrian activities", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "equestrian activities"}, "habitat protection": {"concepts": "habitat protection", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat protection"}, "critical habitats": {"concepts": "critical habitats", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "critical habitats"}, "critical habitat": {"concepts": "critical habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "critical habitat"}, "rearing ponds": {"concepts": "rearing ponds", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "rearing ponds"}, "pelagic zone": {"concepts": "pelagic zone", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "pelagic zone"}, "ecosystem functions": {"concepts": "ecosystem functions", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecosystem functions"}, "lush vegetation": {"concepts": "lush vegetation", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "lush vegetation"}, "northern california": {"concepts": "northern california", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "northern california"}, "salmon recovery": {"concepts": "salmon recovery", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "salmon recovery"}, "marshlands": {"concepts": "marshlands", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "marshlands"}, "species protection": {"concepts": "species protection", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "species protection"}, "trophic bottleneck": {"concepts": "trophic bottleneck", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "trophic bottleneck"}, "estuaries": {"concepts": "estuaries", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "estuaries"}, "fisheries": {"concepts": "fisheries", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fisheries"}, "marine habitat": {"concepts": "marine habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "marine habitat"}, "wetlands": {"concepts": "wetlands", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "wetlands"}, "ecological connectivity": {"concepts": "ecological connectivity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecological connectivity"}, "habitat complexity": {"concepts": "habitat complexity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat complexity"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "biodiversity"}, "waterfowl": {"concepts": "waterfowl", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "waterfowl"}, "habitat methods": {"concepts": "habitat methods", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat methods"}, "natal river": {"concepts": "natal river", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "natal river"}, "national fish habitat partnerships": {"concepts": "national fish habitat partnerships", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "national fish habitat partnerships"}, "shallow habitat": {"concepts": "shallow habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "shallow habitat"}, "water quality": {"concepts": "water quality", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "water quality"}, "species of concern": {"concepts": "species of concern", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "species of concern"}, "national fish habitat partnership": {"concepts": "national fish habitat partnership", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "national fish habitat partnership"}, "ecological research": {"concepts": "ecological research", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecological research"}, "habitat engineers": {"concepts": "habitat engineers", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat engineers"}, "songbirds": {"concepts": "songbirds", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "songbirds"}, "forage fish": {"concepts": "forage fish", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "forage fish"}, "fish populations": {"concepts": "fish populations", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fish populations"}, "forestry": {"concepts": "forestry", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "forestry"}, "ecology": {"concepts": "ecology", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecology"}, "marine habitats": {"concepts": "marine habitats", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "marine habitats"}, "water quality testing": {"concepts": "water quality testing", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "water quality testing"}, "ecosystem recovery": {"concepts": "ecosystem recovery", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecosystem recovery"}, "nearshore habitat": {"concepts": "nearshore habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "nearshore habitat"}, "fish habitat partnership": {"concepts": "fish habitat partnership", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fish habitat partnership"}, "coastal restoration": {"concepts": "coastal restoration", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "coastal restoration"}, "fish habitat partnerships": {"concepts": "fish habitat partnerships", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fish habitat partnerships"}, "insect populations": {"concepts": "insect populations", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "insect populations"}, "shifting ecosystems": {"concepts": "shifting ecosystems", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "shifting ecosystems"}, "multidimensional habitats": {"concepts": "multidimensional habitats", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "multidimensional habitats"}, "forest restoration": {"concepts": "forest restoration", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "forest restoration"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "species diversity"}, "climate change": {"concepts": "climate change", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "climate change"}, "indicator species": {"concepts": "indicator species", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "indicator species"}, "habitat restoration": {"concepts": "habitat restoration", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat restoration"}, "shade cover": {"concepts": "shade cover", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "shade cover"}, "wildlife": {"concepts": "wildlife", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "wildlife"}, "legal frameworks": {"concepts": "legal frameworks", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal frameworks"}, "judeo": {"concepts": "judeo", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "judeo"}, "legal framework": {"concepts": "legal framework", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal framework"}, "legal": {"concepts": "legal", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal"}, "judeo culture": {"concepts": "judeo culture", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "judeo culture"}, "legal advocacy": {"concepts": "legal advocacy", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal advocacy"}};
        const interClusterEdges = [["Cultural Perspectives", "Habitat Conservation", {"weight": 1.0, "confidence": 0.61, "type": "inter_cluster", "style": "solid"}], ["Cultural Perspectives", "Legal Frameworks", {"weight": 1.0, "confidence": 0.61, "type": "inter_cluster", "style": "solid"}], ["Cultural Perspectives", "Academic Collaboration", {"weight": 0.5, "confidence": 0.2, "type": "inter_cluster", "style": "solid"}], ["Habitat Conservation", "Legal Frameworks", {"weight": 0.75, "confidence": 0.6125, "type": "inter_cluster", "style": "solid"}], ["Habitat Conservation", "Cultural Perspectives", {"weight": 1.0, "confidence": 0.5700000000000001, "type": "inter_cluster", "style": "solid"}], ["Habitat Conservation", "Academic Collaboration", {"weight": 0.75, "confidence": 0.5874999999999999, "type": "inter_cluster", "style": "solid"}], ["Legal Frameworks", "Academic Collaboration", {"weight": 1.0, "confidence": 0.78, "type": "inter_cluster", "style": "solid"}], ["Legal Frameworks", "Habitat Conservation", {"weight": 1.0, "confidence": 0.7700000000000001, "type": "inter_cluster", "style": "solid"}], ["Legal Frameworks", "Cultural Perspectives", {"weight": 1.0, "confidence": 0.56, "type": "inter_cluster", "style": "solid"}], ["Academic Collaboration", "Legal Frameworks", {"weight": 1.0, "confidence": 0.8099999999999999, "type": "inter_cluster", "style": "solid"}], ["Academic Collaboration", "Habitat Conservation", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Academic Collaboration", "Cultural Perspectives", {"weight": 0.4, "confidence": 0.16, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Cultural Perspectives": [["university", {"concepts": "university", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "university"}], ["professors", {"concepts": "professors", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "professors"}], ["university collaboration", {"concepts": "university collaboration", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "university collaboration"}], ["academic collaboration", {"concepts": "academic collaboration", "type": "concept", "cluster": "Cultural Perspectives", "node_size": 10, "label": "academic collaboration"}]], "Habitat Conservation": [["perspective", {"concepts": "perspective", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "perspective"}], ["scientific research", {"concepts": "scientific research", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "scientific research"}], ["changing environments", {"concepts": "changing environments", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "changing environments"}], ["small streams", {"concepts": "small streams", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "small streams"}], ["beaver relocation", {"concepts": "beaver relocation", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "beaver relocation"}], ["hindu", {"concepts": "hindu", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "hindu"}], ["indigenous", {"concepts": "indigenous", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "indigenous"}], ["christian", {"concepts": "christian", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "christian"}], ["daoist culture", {"concepts": "daoist culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "daoist culture"}], ["industrial laundry", {"concepts": "industrial laundry", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "industrial laundry"}], ["population", {"concepts": "population", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "population"}], ["resource management", {"concepts": "resource management", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "resource management"}], ["muslim", {"concepts": "muslim", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "muslim"}], ["religion", {"concepts": "religion", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "religion"}], ["workshop", {"concepts": "workshop", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "workshop"}], ["organizational culture", {"concepts": "organizational culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "organizational culture"}], ["population focus", {"concepts": "population focus", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "population focus"}], ["culture", {"concepts": "culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "culture"}], ["christian culture", {"concepts": "christian culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "christian culture"}], ["harvard conferences", {"concepts": "harvard conferences", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "harvard conferences"}], ["cancer", {"concepts": "cancer", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cancer"}], ["property rights", {"concepts": "property rights", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "property rights"}], ["hummingbirds", {"concepts": "hummingbirds", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "hummingbirds"}], ["pvds", {"concepts": "pvds", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "pvds"}], ["public relations", {"concepts": "public relations", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "public relations"}], ["conservation", {"concepts": "conservation", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "conservation"}], ["fire retardants", {"concepts": "fire retardants", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "fire retardants"}], ["organizational change", {"concepts": "organizational change", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "organizational change"}], ["delayed mortality", {"concepts": "delayed mortality", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "delayed mortality"}], ["interfaith dialogue", {"concepts": "interfaith dialogue", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "interfaith dialogue"}], ["cultural context", {"concepts": "cultural context", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural context"}], ["muslim culture", {"concepts": "muslim culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "muslim culture"}], ["industrial laundry facilities", {"concepts": "industrial laundry facilities", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "industrial laundry facilities"}], ["indigenous culture", {"concepts": "indigenous culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "indigenous culture"}], ["regulatory", {"concepts": "regulatory", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "regulatory"}], ["daoist", {"concepts": "daoist", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "daoist"}], ["christian perspective", {"concepts": "christian perspective", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "christian perspective"}], ["conference", {"concepts": "conference", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "conference"}], ["orca recovery", {"concepts": "orca recovery", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "orca recovery"}], ["data analysis", {"concepts": "data analysis", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "data analysis"}], ["gps tracking", {"concepts": "gps tracking", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "gps tracking"}], ["cultural diversity", {"concepts": "cultural diversity", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural diversity"}], ["public outreach", {"concepts": "public outreach", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "public outreach"}], ["ethics", {"concepts": "ethics", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "ethics"}], ["management", {"concepts": "management", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "management"}], ["cultural change", {"concepts": "cultural change", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural change"}], ["institutional culture", {"concepts": "institutional culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "institutional culture"}], ["political processes", {"concepts": "political processes", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "political processes"}], ["pharmaceuticals", {"concepts": "pharmaceuticals", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "pharmaceuticals"}], ["tire chemicals", {"concepts": "tire chemicals", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "tire chemicals"}], ["food chain", {"concepts": "food chain", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "food chain"}], ["regulatory component", {"concepts": "regulatory component", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "regulatory component"}], ["chemical contamination", {"concepts": "chemical contamination", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "chemical contamination"}], ["pvd", {"concepts": "pvd", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "pvd"}], ["chesapeake workshop", {"concepts": "chesapeake workshop", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "chesapeake workshop"}], ["hindu culture", {"concepts": "hindu culture", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "hindu culture"}], ["cultural dependence", {"concepts": "cultural dependence", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "cultural dependence"}], ["dominion perspective", {"concepts": "dominion perspective", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "dominion perspective"}], ["treaties", {"concepts": "treaties", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "treaties"}], ["elk slough", {"concepts": "elk slough", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "elk slough"}], ["beaver structures", {"concepts": "beaver structures", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "beaver structures"}], ["steering committee", {"concepts": "steering committee", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "steering committee"}], ["equestrian activities", {"concepts": "equestrian activities", "type": "concept", "cluster": "Habitat Conservation", "node_size": 10, "label": "equestrian activities"}]], "Legal Frameworks": [["habitat protection", {"concepts": "habitat protection", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat protection"}], ["critical habitats", {"concepts": "critical habitats", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "critical habitats"}], ["critical habitat", {"concepts": "critical habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "critical habitat"}], ["rearing ponds", {"concepts": "rearing ponds", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "rearing ponds"}], ["pelagic zone", {"concepts": "pelagic zone", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "pelagic zone"}], ["ecosystem functions", {"concepts": "ecosystem functions", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecosystem functions"}], ["lush vegetation", {"concepts": "lush vegetation", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "lush vegetation"}], ["northern california", {"concepts": "northern california", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "northern california"}], ["salmon recovery", {"concepts": "salmon recovery", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "salmon recovery"}], ["marshlands", {"concepts": "marshlands", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "marshlands"}], ["species protection", {"concepts": "species protection", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "species protection"}], ["trophic bottleneck", {"concepts": "trophic bottleneck", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "trophic bottleneck"}], ["estuaries", {"concepts": "estuaries", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "estuaries"}], ["fisheries", {"concepts": "fisheries", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fisheries"}], ["marine habitat", {"concepts": "marine habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "marine habitat"}], ["wetlands", {"concepts": "wetlands", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "wetlands"}], ["ecological connectivity", {"concepts": "ecological connectivity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecological connectivity"}], ["habitat complexity", {"concepts": "habitat complexity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat complexity"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "biodiversity"}], ["waterfowl", {"concepts": "waterfowl", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "waterfowl"}], ["habitat methods", {"concepts": "habitat methods", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat methods"}], ["natal river", {"concepts": "natal river", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "natal river"}], ["national fish habitat partnerships", {"concepts": "national fish habitat partnerships", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "national fish habitat partnerships"}], ["shallow habitat", {"concepts": "shallow habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "shallow habitat"}], ["water quality", {"concepts": "water quality", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "water quality"}], ["species of concern", {"concepts": "species of concern", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "species of concern"}], ["national fish habitat partnership", {"concepts": "national fish habitat partnership", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "national fish habitat partnership"}], ["ecological research", {"concepts": "ecological research", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecological research"}], ["habitat engineers", {"concepts": "habitat engineers", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat engineers"}], ["songbirds", {"concepts": "songbirds", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "songbirds"}], ["forage fish", {"concepts": "forage fish", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "forage fish"}], ["fish populations", {"concepts": "fish populations", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fish populations"}], ["forestry", {"concepts": "forestry", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "forestry"}], ["ecology", {"concepts": "ecology", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecology"}], ["marine habitats", {"concepts": "marine habitats", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "marine habitats"}], ["water quality testing", {"concepts": "water quality testing", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "water quality testing"}], ["ecosystem recovery", {"concepts": "ecosystem recovery", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "ecosystem recovery"}], ["nearshore habitat", {"concepts": "nearshore habitat", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "nearshore habitat"}], ["fish habitat partnership", {"concepts": "fish habitat partnership", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fish habitat partnership"}], ["coastal restoration", {"concepts": "coastal restoration", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "coastal restoration"}], ["fish habitat partnerships", {"concepts": "fish habitat partnerships", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "fish habitat partnerships"}], ["insect populations", {"concepts": "insect populations", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "insect populations"}], ["shifting ecosystems", {"concepts": "shifting ecosystems", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "shifting ecosystems"}], ["multidimensional habitats", {"concepts": "multidimensional habitats", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "multidimensional habitats"}], ["forest restoration", {"concepts": "forest restoration", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "forest restoration"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "species diversity"}], ["climate change", {"concepts": "climate change", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "climate change"}], ["indicator species", {"concepts": "indicator species", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "indicator species"}], ["habitat restoration", {"concepts": "habitat restoration", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "habitat restoration"}], ["shade cover", {"concepts": "shade cover", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "shade cover"}], ["wildlife", {"concepts": "wildlife", "type": "concept", "cluster": "Legal Frameworks", "node_size": 10, "label": "wildlife"}]], "Academic Collaboration": [["legal frameworks", {"concepts": "legal frameworks", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal frameworks"}], ["judeo", {"concepts": "judeo", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "judeo"}], ["legal framework", {"concepts": "legal framework", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal framework"}], ["legal", {"concepts": "legal", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal"}], ["judeo culture", {"concepts": "judeo culture", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "judeo culture"}], ["legal advocacy", {"concepts": "legal advocacy", "type": "concept", "cluster": "Academic Collaboration", "node_size": 10, "label": "legal advocacy"}]]};
        const clusterEdges = {"Cultural Perspectives": [], "Habitat Conservation": [], "Legal Frameworks": [], "Academic Collaboration": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

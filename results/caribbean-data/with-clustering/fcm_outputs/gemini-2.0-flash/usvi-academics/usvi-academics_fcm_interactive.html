
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"local climate": {"concepts": "local climate", "concept_list": ["local climate"], "type": "cluster", "node_size": 18, "label": "local climate"}, "public comments": {"concepts": "public comments, man made sources, sctld, softball tournament", "concept_list": ["public comments", "man made sources", "sctld", "softball tournament"], "type": "cluster", "node_size": 27, "label": "public comments"}, "wealthier fishermen": {"concepts": "wealthier fishermen", "concept_list": ["wealthier fishermen"], "type": "cluster", "node_size": 18, "label": "wealthier fishermen"}, "invasive species": {"concepts": "invasive species", "concept_list": ["invasive species"], "type": "cluster", "node_size": 18, "label": "invasive species"}, "lobster landings": {"concepts": "lobster landings", "concept_list": ["lobster landings"], "type": "cluster", "node_size": 18, "label": "lobster landings"}, "adult outreach": {"concepts": "adult outreach, family tradition, intermarriage, personal grievances, community identity, youth outreach", "concept_list": ["adult outreach", "family tradition", "intermarriage", "personal grievances", "community identity", "youth outreach"], "type": "cluster", "node_size": 33, "label": "adult outreach"}, "[poaching]": {"concepts": "[poaching]", "concept_list": ["[poaching]"], "type": "cluster", "node_size": 18, "label": "[poaching]"}, "marine systems": {"concepts": "marine systems", "concept_list": ["marine systems"], "type": "cluster", "node_size": 18, "label": "marine systems"}, "pollution": {"concepts": "pollution", "concept_list": ["pollution"], "type": "cluster", "node_size": 18, "label": "pollution"}, "environmentalist views": {"concepts": "environmentalist views", "concept_list": ["environmentalist views"], "type": "cluster", "node_size": 18, "label": "environmentalist views"}, "lack of knowledge": {"concepts": "lack of knowledge, tang", "concept_list": ["lack of knowledge", "tang"], "type": "cluster", "node_size": 21, "label": "lack of knowledge"}, "Open Group Meetings": {"concepts": "lone wolf, under reporting", "concept_list": ["lone wolf", "under reporting"], "type": "cluster", "node_size": 21, "label": "Open Group Meetings"}, "Coral Reef Ecosystem": {"concepts": "junked groups, cohesion, grouper decline, open meetings, grouper, community relationships, family interactions, family relationships", "concept_list": ["junked groups", "cohesion", "grouper decline", "open meetings", "grouper", "community relationships", "family interactions", "family relationships"], "type": "cluster", "node_size": 39, "label": "Coral Reef Ecosystem"}, "Acropora Coral Cover": {"concepts": "coral reefs, fringing reefs, coral reef, coral reef monitoring, deep coral reef, reef fish, reef species, reef protection", "concept_list": ["coral reefs", "fringing reefs", "coral reef", "coral reef monitoring", "deep coral reef", "reef fish", "reef species", "reef protection"], "type": "cluster", "node_size": 39, "label": "Acropora Coral Cover"}, "Lone Wolf Reporting": {"concepts": "acropora corals, coral cover", "concept_list": ["acropora corals", "coral cover"], "type": "cluster", "node_size": 21, "label": "Lone Wolf Reporting"}, "Coral Health": {"concepts": "coral bleaching, coral disease, coral diseases, stony coral tissue loss", "concept_list": ["coral bleaching", "coral disease", "coral diseases", "stony coral tissue loss"], "type": "cluster", "node_size": 27, "label": "Coral Health"}, "Coral Reef Loss": {"concepts": "reef degradation, coral reef decline, live coral loss", "concept_list": ["reef degradation", "coral reef decline", "live coral loss"], "type": "cluster", "node_size": 24, "label": "Coral Reef Loss"}, "Climate Change": {"concepts": "climate change, climate drivers, environmental changes, global warming", "concept_list": ["climate change", "climate drivers", "environmental changes", "global warming"], "type": "cluster", "node_size": 27, "label": "Climate Change"}, "Storm Intensity": {"concepts": "increased storms, hurricanes", "concept_list": ["increased storms", "hurricanes"], "type": "cluster", "node_size": 21, "label": "Storm Intensity"}, "Coral Diseases": {"concepts": "environmental bent, seasonal closures", "concept_list": ["environmental bent", "seasonal closures"], "type": "cluster", "node_size": 21, "label": "Coral Diseases"}, "**Local Fish Trade**": {"concepts": "fish market, parrotfish, fish and wildlife, fish markets, queen conch, nassau grouper, bait fish, [fish markets], fish consumption, billfish, local fish, by catch", "concept_list": ["fish market", "parrotfish", "fish and wildlife", "fish markets", "queen conch", "nassau grouper", "bait fish", "[fish markets]", "fish consumption", "billfish", "local fish", "by catch"], "type": "cluster", "node_size": 51, "label": "**Local Fish Trade**"}, "Seagrass Climate Change": {"concepts": "environmental conditions, sediment, sea temperatures, sea temperature increase, sea grass, sea temperature, habitat change, ocean climate, halophila stipulacea, data workshop, external stresses, invasive sea grass, bleaching, shoreline erosion", "concept_list": ["environmental conditions", "sediment", "sea temperatures", "sea temperature increase", "sea grass", "sea temperature", "habitat change", "ocean climate", "halophila stipulacea", "data workshop", "external stresses", "invasive sea grass", "bleaching", "shoreline erosion"], "type": "cluster", "node_size": 57, "label": "Seagrass Climate Change"}, "Competitive Licensing": {"concepts": "license transfer, competitive, immediate profits", "concept_list": ["license transfer", "competitive", "immediate profits"], "type": "cluster", "node_size": 24, "label": "Competitive Licensing"}, "Recruitment Territories": {"concepts": "recruitment pulse, territories", "concept_list": ["recruitment pulse", "territories"], "type": "cluster", "node_size": 21, "label": "Recruitment Territories"}, "Cooperative Research": {"concepts": "cooperative research, research participation, researchers, research needs", "concept_list": ["cooperative research", "research participation", "researchers", "research needs"], "type": "cluster", "node_size": 27, "label": "Cooperative Research"}, "Scientific Negotiation": {"concepts": "negotiation, scientific advice", "concept_list": ["negotiation", "scientific advice"], "type": "cluster", "node_size": 21, "label": "Scientific Negotiation"}, "Fisheries Management": {"concepts": "fisheries populations, fisheries scientist, fishery management, sport fishery, multi use fishery, fisheries enhancement, [usvi fisheries], fisheries data, fisheries, fisheries depletion, recreational fishery, national marine fishery service, fisheries associations, caribbean fisheries, usvi fisheries, fishery, [fishery management]", "concept_list": ["fisheries populations", "fisheries scientist", "fishery management", "sport fishery", "multi use fishery", "fisheries enhancement", "[usvi fisheries]", "fisheries data", "fisheries", "fisheries depletion", "recreational fishery", "national marine fishery service", "fisheries associations", "caribbean fisheries", "usvi fisheries", "fishery", "[fishery management]"], "type": "cluster", "node_size": 66, "label": "Fisheries Management"}, "Fishing Regulations": {"concepts": "[fisher regulations], fisheries regulations, [fisheries regulations], [fishing regulations]", "concept_list": ["[fisher regulations]", "fisheries regulations", "[fisheries regulations]", "[fishing regulations]"], "type": "cluster", "node_size": 27, "label": "Fishing Regulations"}, "Fisher Concerns": {"concepts": "fisher concerns, red heine fishery, fisherman's association, usvi fishers, fishery improvement, fishery managers, fishers, fishery stakeholders, fisher monitoring, island based fishery, fishermen groups, subsistence fishermen, fishermen trust, local fishermen, [fishermen], conch fisherman, fishermen's association, part-time fishermen, fishermen livelihoods, fishermen perceptions, fisheries dependence, wealthy fishermen, [fishermen compliance], fishermen concerns, fishery issues, subsistence fishery, st. thomas fisherman's association, spear fishermen, fisher relationships, fisher cooperation, fishermen input, fishermen conflicts, fisher stakeholders", "concept_list": ["fisher concerns", "red heine fishery", "fisherman's association", "usvi fishers", "fishery improvement", "fishery managers", "fishers", "fishery stakeholders", "fisher monitoring", "island based fishery", "fishermen groups", "subsistence fishermen", "fishermen trust", "local fishermen", "[fishermen]", "conch fisherman", "fishermen's association", "part-time fishermen", "fishermen livelihoods", "fishermen perceptions", "fisheries dependence", "wealthy fishermen", "[fishermen compliance]", "fishermen concerns", "fishery issues", "subsistence fishery", "st. thomas fisherman's association", "spear fishermen", "fisher relationships", "fisher cooperation", "fishermen input", "fishermen conflicts", "fisher stakeholders"], "type": "cluster", "node_size": 114, "label": "Fisher Concerns"}, "Acoustic Monitoring": {"concepts": "acoustic tags, monitoring", "concept_list": ["acoustic tags", "monitoring"], "type": "cluster", "node_size": 21, "label": "Acoustic Monitoring"}, "Fishing Net Bycatch": {"concepts": "bycatch, gill nets, trammel nets", "concept_list": ["bycatch", "gill nets", "trammel nets"], "type": "cluster", "node_size": 24, "label": "Fishing Net Bycatch"}, "Development & Conservation": {"concepts": "conservation, development, moratorium, compensation, livelihood, political influence, enforcement problems, data discrepancies, tissue loss, immigrants, regionalized, tourism, seasonal moratorium, fac group, social activities, african dust, innovative enforcement, cultural standpoint, community cohesion, social groups, market stalls, sea surface temperatures, [spawning aggregations], spatial management, spawning bank, conflict, data modeling, cultural importance, grammanik bank, marketing center, political deference, peer pressure, overfished, right to fish, acropora loss, lack of grazers, spawning aggregations, economic loss, livelihoods, advisory council, spawning snappers, council meetings, resident populations, land inheritance, national park service, geographic divisions, spawning groupers, over exploiting, bleaching thresholds, boat captains, socialization, conch abundance, fish traps, young people, resource possession, long-term livelihood, [enforcement], overfishing, lionfish invasion, [council], autonomy, disrespect, stock assessment", "concept_list": ["conservation", "development", "moratorium", "compensation", "livelihood", "political influence", "enforcement problems", "data discrepancies", "tissue loss", "immigrants", "regionalized", "tourism", "seasonal moratorium", "fac group", "social activities", "african dust", "innovative enforcement", "cultural standpoint", "community cohesion", "social groups", "market stalls", "sea surface temperatures", "[spawning aggregations]", "spatial management", "spawning bank", "conflict", "data modeling", "cultural importance", "grammanik bank", "marketing center", "political deference", "peer pressure", "overfished", "right to fish", "acropora loss", "lack of grazers", "spawning aggregations", "economic loss", "livelihoods", "advisory council", "spawning snappers", "council meetings", "resident populations", "land inheritance", "national park service", "geographic divisions", "spawning groupers", "over exploiting", "bleaching thresholds", "boat captains", "socialization", "conch abundance", "fish traps", "young people", "resource possession", "long-term livelihood", "[enforcement]", "overfishing", "lionfish invasion", "[council]", "autonomy", "disrespect", "stock assessment"], "type": "cluster", "node_size": 204, "label": "Development & Conservation"}, "Resource Depletion": {"concepts": "short term, mortality, over exploitation, hand caught, long term, no take reserve, bycatch reduction, life cycle", "concept_list": ["short term", "mortality", "over exploitation", "hand caught", "long term", "no take reserve", "bycatch reduction", "life cycle"], "type": "cluster", "node_size": 39, "label": "Resource Depletion"}, "Trap Management": {"concepts": "trap reduction, trap design, trap numbers", "concept_list": ["trap reduction", "trap design", "trap numbers"], "type": "cluster", "node_size": 24, "label": "Trap Management"}, "Trap Theft": {"concepts": "trap theft, trap stealing", "concept_list": ["trap theft", "trap stealing"], "type": "cluster", "node_size": 21, "label": "Trap Theft"}, "Trap Acquisition": {"concepts": "pursing nets, trap buying, derelict traps", "concept_list": ["pursing nets", "trap buying", "derelict traps"], "type": "cluster", "node_size": 24, "label": "Trap Acquisition"}, "Target Species": {"concepts": "target species, commercially important species", "concept_list": ["target species", "commercially important species"], "type": "cluster", "node_size": 21, "label": "Target Species"}, "Ecological Sustainability": {"concepts": "ecological outcomes, sustainability, ecological roles, ecosystems, ecosystem ecology", "concept_list": ["ecological outcomes", "sustainability", "ecological roles", "ecosystems", "ecosystem ecology"], "type": "cluster", "node_size": 30, "label": "Ecological Sustainability"}, "Bird Habitat": {"concepts": "critical habitat, bird population", "concept_list": ["critical habitat", "bird population"], "type": "cluster", "node_size": 21, "label": "Bird Habitat"}, "Ecological Interactions": {"concepts": "exotic species, species diversity, ecologically important species, habitat use", "concept_list": ["exotic species", "species diversity", "ecologically important species", "habitat use"], "type": "cluster", "node_size": 27, "label": "Ecological Interactions"}, "Us vs. Them": {"concepts": "us versus them, antipathy", "concept_list": ["us versus them", "antipathy"], "type": "cluster", "node_size": 21, "label": "Us vs. Them"}, "USVI Agencies": {"concepts": "usvi, [usvi], noaa, dpnr", "concept_list": ["usvi", "[usvi]", "noaa", "dpnr"], "type": "cluster", "node_size": 27, "label": "USVI Agencies"}, "Resource Hotspots": {"concepts": "[resources], hot spots, ngos, resource conflict, closed area, sargassum", "concept_list": ["[resources]", "hot spots", "ngos", "resource conflict", "closed area", "sargassum"], "type": "cluster", "node_size": 33, "label": "Resource Hotspots"}, "Regulatory Framework": {"concepts": "regulations, [regulations], [compatible regulations]", "concept_list": ["regulations", "[regulations]", "[compatible regulations]"], "type": "cluster", "node_size": 24, "label": "Regulatory Framework"}, "Resource Enforcement": {"concepts": "compliance, noaa compliance, [resource enforcement], enforcement", "concept_list": ["compliance", "noaa compliance", "[resource enforcement]", "enforcement"], "type": "cluster", "node_size": 27, "label": "Resource Enforcement"}, "Mandated Compliance": {"concepts": "[compliance], mandated restrictions", "concept_list": ["[compliance]", "mandated restrictions"], "type": "cluster", "node_size": 21, "label": "Mandated Compliance"}, "Coastal Development": {"concepts": "coastal development, coastal development issues", "concept_list": ["coastal development", "coastal development issues"], "type": "cluster", "node_size": 21, "label": "Coastal Development"}, "Coastal Management": {"concepts": "coastal zone management, coastal protection, coast guard, coastal communities", "concept_list": ["coastal zone management", "coastal protection", "coast guard", "coastal communities"], "type": "cluster", "node_size": 27, "label": "Coastal Management"}, "Federal Governance": {"concepts": "federal oversight, federal government, [federal government], federal level", "concept_list": ["federal oversight", "federal government", "[federal government]", "federal level"], "type": "cluster", "node_size": 27, "label": "Federal Governance"}, "Government Influence": {"concepts": "government relations, government, political leverage, local government, [local government], local managers", "concept_list": ["government relations", "government", "political leverage", "local government", "[local government]", "local managers"], "type": "cluster", "node_size": 33, "label": "Government Influence"}, "Fish Reproduction Cycle": {"concepts": "fish reproduction, larval disbursal", "concept_list": ["fish reproduction", "larval disbursal"], "type": "cluster", "node_size": 21, "label": "Fish Reproduction Cycle"}, "Fish Development": {"concepts": "larval fish, juvenile fish, parrot fishes, lionfish", "concept_list": ["larval fish", "juvenile fish", "parrot fishes", "lionfish"], "type": "cluster", "node_size": 27, "label": "Fish Development"}, "Fishing Data": {"concepts": "catch seasons, landings records", "concept_list": ["catch seasons", "landings records"], "type": "cluster", "node_size": 21, "label": "Fishing Data"}, "Fishing Management": {"concepts": "over fishing, fishing restrictions, fishing moratorium", "concept_list": ["over fishing", "fishing restrictions", "fishing moratorium"], "type": "cluster", "node_size": 24, "label": "Fishing Management"}, "Fishing Activities": {"concepts": "fishing tournaments, commercial fishing, spear fishing, trap fishing, recreational fishing, fishing area, trap fishermen", "concept_list": ["fishing tournaments", "commercial fishing", "spear fishing", "trap fishing", "recreational fishing", "fishing area", "trap fishermen"], "type": "cluster", "node_size": 36, "label": "Fishing Activities"}, "Fishing & Aggregation": {"concepts": "fishing community, fishing problems, fishing aggregation devices, fishing aggregation, fishing aggregating devices, cruise ships, [fishing aggregation]", "concept_list": ["fishing community", "fishing problems", "fishing aggregation devices", "fishing aggregation", "fishing aggregating devices", "cruise ships", "[fishing aggregation]"], "type": "cluster", "node_size": 36, "label": "Fishing & Aggregation"}, "Management Decisions": {"concepts": "management decision, management restrictions, management measure, management planning, management decisions, management effectiveness, environmental explanation, management explanation", "concept_list": ["management decision", "management restrictions", "management measure", "management planning", "management decisions", "management effectiveness", "environmental explanation", "management explanation"], "type": "cluster", "node_size": 39, "label": "Management Decisions"}, "Council Decisions": {"concepts": "management council, decision makers, decision making", "concept_list": ["management council", "decision makers", "decision making"], "type": "cluster", "node_size": 24, "label": "Council Decisions"}, "Stock Management": {"concepts": "stock identification, rebuilding stock", "concept_list": ["stock identification", "rebuilding stock"], "type": "cluster", "node_size": 21, "label": "Stock Management"}, "Economic Growth & Influence": {"concepts": "economic dependence, growth rates, economic influence, economic standpoint, economic pressure, tax reasons, independent actors", "concept_list": ["economic dependence", "growth rates", "economic influence", "economic standpoint", "economic pressure", "tax reasons", "independent actors"], "type": "cluster", "node_size": 36, "label": "Economic Growth & Influence"}, "Sediment & Water": {"concepts": "sediment deposition, water conditions", "concept_list": ["sediment deposition", "water conditions"], "type": "cluster", "node_size": 21, "label": "Sediment & Water"}, "Water Pollution Sources": {"concepts": "raw sewage, land runoff", "concept_list": ["raw sewage", "land runoff"], "type": "cluster", "node_size": 21, "label": "Water Pollution Sources"}, "Seagrass Ecosystem Health": {"concepts": "turbidity, thalassia beds, water quality, poaching", "concept_list": ["turbidity", "thalassia beds", "water quality", "poaching"], "type": "cluster", "node_size": 27, "label": "Seagrass Ecosystem Health"}, "Marine Reserves": {"concepts": "marine reserve, hind bank marine reserve, marine reserves", "concept_list": ["marine reserve", "hind bank marine reserve", "marine reserves"], "type": "cluster", "node_size": 24, "label": "Marine Reserves"}, "Marine Conservation": {"concepts": "marine conservation, pelagic species, invasive seagrass, marine reserve areas", "concept_list": ["marine conservation", "pelagic species", "invasive seagrass", "marine reserve areas"], "type": "cluster", "node_size": 27, "label": "Marine Conservation"}, "Environmental Protection": {"concepts": "[environmental protection], environmental protection, environmental issues", "concept_list": ["[environmental protection]", "environmental protection", "environmental issues"], "type": "cluster", "node_size": 24, "label": "Environmental Protection"}, "Environmental Harm": {"concepts": "ecological harm, pollution sources, environmental concerns, human emissions", "concept_list": ["ecological harm", "pollution sources", "environmental concerns", "human emissions"], "type": "cluster", "node_size": 27, "label": "Environmental Harm"}, "Knowledge & Decisions": {"concepts": "traditional knowledge, knowledge, decision-making", "concept_list": ["traditional knowledge", "knowledge", "decision-making"], "type": "cluster", "node_size": 24, "label": "Knowledge & Decisions"}, "Regulatory Gap": {"concepts": "lack of regulation, lack of enforcement", "concept_list": ["lack of regulation", "lack of enforcement"], "type": "cluster", "node_size": 21, "label": "Regulatory Gap"}, "Caribbean Marine Issues": {"concepts": "diadema die-off, u.s. virgin islands, ciguatera poisoning", "concept_list": ["diadema die-off", "u.s. virgin islands", "ciguatera poisoning"], "type": "cluster", "node_size": 24, "label": "Caribbean Marine Issues"}, "Snapper Species": {"concepts": "mutton snapper, latin snapper, dog snapper, cubera snapper, snapper", "concept_list": ["mutton snapper", "latin snapper", "dog snapper", "cubera snapper", "snapper"], "type": "cluster", "node_size": 30, "label": "Snapper Species"}, "Grouper Species": {"concepts": "red hind, yellowfin grouper", "concept_list": ["red hind", "yellowfin grouper"], "type": "cluster", "node_size": 21, "label": "Grouper Species"}, "Abundance Dynamics": {"concepts": "fish abundance, algal abundance, fish decline", "concept_list": ["fish abundance", "algal abundance", "fish decline"], "type": "cluster", "node_size": 24, "label": "Abundance Dynamics"}, "Algal Bloom Dynamics": {"concepts": "algal composition, algal overgrowth, epiphytes, algal domination", "concept_list": ["algal composition", "algal overgrowth", "epiphytes", "algal domination"], "type": "cluster", "node_size": 27, "label": "Algal Bloom Dynamics"}, "Population Depletion": {"concepts": "population size, depleted populations, population depletion", "concept_list": ["population size", "depleted populations", "population depletion"], "type": "cluster", "node_size": 24, "label": "Population Depletion"}, "Escape Constraints": {"concepts": "size limits, escape panels", "concept_list": ["size limits", "escape panels"], "type": "cluster", "node_size": 21, "label": "Escape Constraints"}};
        const conceptData = {};
        const interClusterEdges = [["local climate", "Caribbean Marine Issues", {"weight": 1.0, "confidence": 0.4666666666666666, "type": "inter_cluster", "style": "solid"}], ["local climate", "Environmental Harm", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["wealthier fishermen", "Competitive Licensing", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["wealthier fishermen", "Population Depletion", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["wealthier fishermen", "Fishing Data", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["wealthier fishermen", "Fisheries Management", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["invasive species", "Ecological Sustainability", {"weight": -1.0, "confidence": 0.6999999999999998, "type": "inter_cluster", "style": "solid"}], ["invasive species", "Algal Bloom Dynamics", {"weight": 1.0, "confidence": 0.675, "type": "inter_cluster", "style": "solid"}], ["invasive species", "Ecological Interactions", {"weight": -1.0, "confidence": 0.5333333333333333, "type": "inter_cluster", "style": "solid"}], ["adult outreach", "Fishing Activities", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["marine systems", "Water Pollution Sources", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["pollution", "Coral Diseases", {"weight": 1.0, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["environmentalist views", "Ecological Sustainability", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["environmentalist views", "Coastal Development", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["lack of knowledge", "Acropora Coral Cover", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Open Group Meetings", "Abundance Dynamics", {"weight": -1.0, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Open Group Meetings", "Resource Depletion", {"weight": 1.0, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Open Group Meetings", "[poaching]", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Coral Reef Ecosystem", "adult outreach", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Lone Wolf Reporting", "Environmental Harm", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Lone Wolf Reporting", "Mandated Compliance", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Coral Health", "Environmental Harm", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Coral Reef Loss", "Fishing Data", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Coral Reef Loss", "Escape Constraints", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Storm Intensity", "Development & Conservation", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Coral Diseases", "Fisheries Management", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Seagrass Climate Change", "Ecological Interactions", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Seagrass Climate Change", "Algal Bloom Dynamics", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Seagrass Climate Change", "Environmental Protection", {"weight": -1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Seagrass Climate Change", "Fishing Management", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Recruitment Territories", "Stock Management", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Cooperative Research", "Fishing Regulations", {"weight": 1.0, "confidence": 0.625, "type": "inter_cluster", "style": "solid"}], ["Cooperative Research", "Target Species", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Scientific Negotiation", "Fish Development", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fisheries Management", "Regulatory Framework", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Fishing Regulations", "Fish Reproduction Cycle", {"weight": 1.0, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Fisher Concerns", "Acropora Coral Cover", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Acoustic Monitoring", "Grouper Species", {"weight": 0.6666666666666666, "confidence": 0.3666666666666667, "type": "inter_cluster", "style": "solid"}], ["Acoustic Monitoring", "Snapper Species", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fishing Net Bycatch", "Regulatory Framework", {"weight": 1.0, "confidence": 0.5666666666666668, "type": "inter_cluster", "style": "solid"}], ["Fishing Net Bycatch", "[poaching]", {"weight": 1.0, "confidence": 0.3833333333333333, "type": "inter_cluster", "style": "solid"}], ["Development & Conservation", "Grouper Species", {"weight": 1.0, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Development & Conservation", "Environmental Harm", {"weight": -0.5, "confidence": 0.2, "type": "inter_cluster", "style": "solid"}], ["Development & Conservation", "Coral Reef Loss", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Trap Management", "Council Decisions", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Trap Management", "public comments", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Trap Acquisition", "Trap Theft", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Trap Acquisition", "Coral Reef Ecosystem", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Bird Habitat", "Economic Growth & Influence", {"weight": 1.0, "confidence": 0.475, "type": "inter_cluster", "style": "solid"}], ["Us vs. Them", "lack of knowledge", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["USVI Agencies", "Government Influence", {"weight": 1.0, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Resource Hotspots", "Climate Change", {"weight": 0.6666666666666666, "confidence": 0.31666666666666665, "type": "inter_cluster", "style": "solid"}], ["Regulatory Framework", "Marine Reserves", {"weight": 1.0, "confidence": 0.575, "type": "inter_cluster", "style": "solid"}], ["Regulatory Framework", "USVI Agencies", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Resource Enforcement", "lobster landings", {"weight": 1.0, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Resource Enforcement", "Regulatory Framework", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["Mandated Compliance", "Fisher Concerns", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Mandated Compliance", "Snapper Species", {"weight": 0.5, "confidence": 0.15, "type": "inter_cluster", "style": "solid"}], ["Coastal Development", "marine systems", {"weight": -1.0, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Coastal Development", "Fisheries Management", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Coastal Development", "invasive species", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Federal Governance", "Us vs. Them", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Federal Governance", "Fishing Data", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fish Reproduction Cycle", "Marine Reserves", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Fish Reproduction Cycle", "marine systems", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Fish Reproduction Cycle", "Acoustic Monitoring", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fish Reproduction Cycle", "Acropora Coral Cover", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fishing Data", "USVI Agencies", {"weight": 0.5, "confidence": 0.25, "type": "inter_cluster", "style": "solid"}], ["Fishing Management", "[poaching]", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fishing Management", "Seagrass Climate Change", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fishing Activities", "Environmental Protection", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Fishing Activities", "Seagrass Ecosystem Health", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Fishing & Aggregation", "Fishing Activities", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Fishing & Aggregation", "Water Pollution Sources", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Management Decisions", "Council Decisions", {"weight": 1.0, "confidence": 0.6499999999999999, "type": "inter_cluster", "style": "solid"}], ["Management Decisions", "Climate Change", {"weight": 1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Stock Management", "Fish Development", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Sediment & Water", "Ecological Sustainability", {"weight": -1.0, "confidence": 0.4666666666666666, "type": "inter_cluster", "style": "solid"}], ["Water Pollution Sources", "Acropora Coral Cover", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Water Pollution Sources", "Bird Habitat", {"weight": -1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Water Pollution Sources", "Marine Conservation", {"weight": -1.0, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Environmental Protection", "Abundance Dynamics", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Environmental Harm", "Knowledge & Decisions", {"weight": -0.3333333333333333, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Environmental Harm", "Council Decisions", {"weight": 1.0, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Environmental Harm", "Coastal Management", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Environmental Harm", "Management Decisions", {"weight": 1.0, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}], ["Knowledge & Decisions", "Climate Change", {"weight": 1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Knowledge & Decisions", "Resource Depletion", {"weight": -1.0, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Regulatory Gap", "marine systems", {"weight": -1.0, "confidence": 0.3666666666666667, "type": "inter_cluster", "style": "solid"}], ["Regulatory Gap", "Bird Habitat", {"weight": -1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["Regulatory Gap", "Government Influence", {"weight": -0.5, "confidence": 0.2, "type": "inter_cluster", "style": "solid"}], ["Abundance Dynamics", "**Local Fish Trade**", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Algal Bloom Dynamics", "Coastal Management", {"weight": -1.0, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Population Depletion", "Cooperative Research", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"public comments": [], "adult outreach": [], "lack of knowledge": [], "Open Group Meetings": [], "Coral Reef Ecosystem": [], "Acropora Coral Cover": [], "Lone Wolf Reporting": [], "Coral Health": [], "Coral Reef Loss": [], "Climate Change": [], "Storm Intensity": [], "Coral Diseases": [], "**Local Fish Trade**": [], "Seagrass Climate Change": [], "Competitive Licensing": [], "Recruitment Territories": [], "Cooperative Research": [], "Scientific Negotiation": [], "Fisheries Management": [], "Fishing Regulations": [], "Fisher Concerns": [], "Acoustic Monitoring": [], "Fishing Net Bycatch": [], "Development & Conservation": [], "Resource Depletion": [], "Trap Management": [], "Trap Theft": [], "Trap Acquisition": [], "Target Species": [], "Ecological Sustainability": [], "Bird Habitat": [], "Ecological Interactions": [], "Us vs. Them": [], "USVI Agencies": [], "Resource Hotspots": [], "Regulatory Framework": [], "Resource Enforcement": [], "Mandated Compliance": [], "Coastal Development": [], "Coastal Management": [], "Federal Governance": [], "Government Influence": [], "Fish Reproduction Cycle": [], "Fish Development": [], "Fishing Data": [], "Fishing Management": [], "Fishing Activities": [], "Fishing & Aggregation": [], "Management Decisions": [], "Council Decisions": [], "Stock Management": [], "Economic Growth & Influence": [], "Sediment & Water": [], "Water Pollution Sources": [], "Seagrass Ecosystem Health": [], "Marine Reserves": [], "Marine Conservation": [], "Environmental Protection": [], "Environmental Harm": [], "Knowledge & Decisions": [], "Regulatory Gap": [], "Caribbean Marine Issues": [], "Snapper Species": [], "Grouper Species": [], "Abundance Dynamics": [], "Algal Bloom Dynamics": [], "Population Depletion": [], "Escape Constraints": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

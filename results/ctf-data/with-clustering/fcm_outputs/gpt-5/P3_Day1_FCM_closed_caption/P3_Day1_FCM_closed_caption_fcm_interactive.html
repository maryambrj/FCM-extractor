
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Decision Processes": {"concepts": "operating system, positive outcome, causal reasoning, methodological steps, protocol familiarity, code integration, dynamic modifications, tool compatibility, runtime type identification, human input, file signature, binary analysis, reasoning, objects, tasks, problem framing, libc version, knowledge representation, custom protocol, task performance, challenge, binary, aws, interaction, geographic location, object modification, cyber attack, environmental variables, agreement, protocol, heap management, reverse engineering, libc, surprise factor, libraries, dynamic linking, responsibility, python packages, discovery, package availability, time waster, missing package, code writing, research influence, identification, familiarity, completion, aarch, infrastructure location, compiled binary, variables, architecture detection, firmware, missing details, problem solving, cognitive mapping, breakpoint, instruction frequency, analysis process, function labeling, decompilation, rsa, dialogue, failure, prior knowledge, methodology, adaptation, compiler strings, gdb server, block cipher, query, participant, frequency analysis, clarification, cfc structure, resource availability, templated code, opcode, hardware differences, file format, experimentation process, function understanding, workflow, ghidra, program execution, protocols, validation, discussion, lattice structure, downstream effects, geography, support tools, graph, latency, software stack, knowledge sharing, cooperation, library dependency, diffie-hellman, hosting environment, binwalk, system architecture, explanation, socket input, instruction patterns, research, technical communication, directed graph, rtti, conflict, windows, elliptic curve, rust, control flow, norms, heap memory, tls, guidance, c++, user-friendliness, expertise, dynamic introspection, terminal inputs, remote setup, impediments, custom protocols, collaboration, factors, function identification, tool selection, fuzzy cognitive map, causal relationship, bare metal, connectivity, cultural practice, configurations, consensus, data flow, enablers, optimization level, data structure, c, belief system, static linking, dependency, process steps, known file format, time constraint, compressed section, task difficulty, stack, string obfuscation, architecture, surprise, binary file, function analysis, library strings, arm, local setup, go, graph traversal, iterative process, breakpoint analysis, strategy, unstructured data, object modifications, dynamic variable modification, teammate, cyber attacks, loader, influence factors, variable manipulation, distraction, graph theory, decompiling, new york, programming languages, code optimization, success, tool support, shared understanding, mental model, influence, dynamic code modifications, ctf, static analysis, questioning, influential factors, role distinctions, steps, bytecode, teammate collaboration, negotiation, causal relations, environment variables, solve script, experimenter, causal factors, interpretation, information flow, code modifications, automation, surprise factors, tool usage, stack identification, knowledge, infrastructure, function search, configs, runtime decompression, process, justification, pointers, multiple languages, binary code, cipher suite, technical challenge, alpha architecture, role differentiation, communication, gdb, data structure complexity, learning process, coordination, learning, hardware, workflow disruption, matrix, mitigation strategy, bytecode vm, virtual machine, stack analysis, enablement, handshake, computer visualization, linux, script execution, clang, data structures, success factors, subject matter expert, openssl, ctf challenge, operating systems, component frequency, hex editor, framework support, stack determination, upstream factors, problem-solving, architecture determination, framework, network latency, blob data, authentication, templating, disagreement, san francisco, negative influence", "concept_list": ["operating system", "positive outcome", "causal reasoning", "methodological steps", "protocol familiarity", "code integration", "dynamic modifications", "tool compatibility", "runtime type identification", "human input", "file signature", "binary analysis", "reasoning", "objects", "tasks", "problem framing", "libc version", "knowledge representation", "custom protocol", "task performance", "challenge", "binary", "aws", "interaction", "geographic location", "object modification", "cyber attack", "environmental variables", "agreement", "protocol", "heap management", "reverse engineering", "libc", "surprise factor", "libraries", "dynamic linking", "responsibility", "python packages", "discovery", "package availability", "time waster", "missing package", "code writing", "research influence", "identification", "familiarity", "completion", "aarch", "infrastructure location", "compiled binary", "variables", "architecture detection", "firmware", "missing details", "problem solving", "cognitive mapping", "breakpoint", "instruction frequency", "analysis process", "function labeling", "decompilation", "rsa", "dialogue", "failure", "prior knowledge", "methodology", "adaptation", "compiler strings", "gdb server", "block cipher", "query", "participant", "frequency analysis", "clarification", "cfc structure", "resource availability", "templated code", "opcode", "hardware differences", "file format", "experimentation process", "function understanding", "workflow", "ghidra", "program execution", "protocols", "validation", "discussion", "lattice structure", "downstream effects", "geography", "support tools", "graph", "latency", "software stack", "knowledge sharing", "cooperation", "library dependency", "diffie-hellman", "hosting environment", "binwalk", "system architecture", "explanation", "socket input", "instruction patterns", "research", "technical communication", "directed graph", "rtti", "conflict", "windows", "elliptic curve", "rust", "control flow", "norms", "heap memory", "tls", "guidance", "c++", "user-friendliness", "expertise", "dynamic introspection", "terminal inputs", "remote setup", "impediments", "custom protocols", "collaboration", "factors", "function identification", "tool selection", "fuzzy cognitive map", "causal relationship", "bare metal", "connectivity", "cultural practice", "configurations", "consensus", "data flow", "enablers", "optimization level", "data structure", "c", "belief system", "static linking", "dependency", "process steps", "known file format", "time constraint", "compressed section", "task difficulty", "stack", "string obfuscation", "architecture", "surprise", "binary file", "function analysis", "library strings", "arm", "local setup", "go", "graph traversal", "iterative process", "breakpoint analysis", "strategy", "unstructured data", "object modifications", "dynamic variable modification", "teammate", "cyber attacks", "loader", "influence factors", "variable manipulation", "distraction", "graph theory", "decompiling", "new york", "programming languages", "code optimization", "success", "tool support", "shared understanding", "mental model", "influence", "dynamic code modifications", "ctf", "static analysis", "questioning", "influential factors", "role distinctions", "steps", "bytecode", "teammate collaboration", "negotiation", "causal relations", "environment variables", "solve script", "experimenter", "causal factors", "interpretation", "information flow", "code modifications", "automation", "surprise factors", "tool usage", "stack identification", "knowledge", "infrastructure", "function search", "configs", "runtime decompression", "process", "justification", "pointers", "multiple languages", "binary code", "cipher suite", "technical challenge", "alpha architecture", "role differentiation", "communication", "gdb", "data structure complexity", "learning process", "coordination", "learning", "hardware", "workflow disruption", "matrix", "mitigation strategy", "bytecode vm", "virtual machine", "stack analysis", "enablement", "handshake", "computer visualization", "linux", "script execution", "clang", "data structures", "success factors", "subject matter expert", "openssl", "ctf challenge", "operating systems", "component frequency", "hex editor", "framework support", "stack determination", "upstream factors", "problem-solving", "architecture determination", "framework", "network latency", "blob data", "authentication", "templating", "disagreement", "san francisco", "negative influence"], "type": "cluster", "node_size": 792, "label": "Decision Processes"}, "Debugging & Organization": {"concepts": "decision-making, decision step, outcome determination, goal-oriented task analysis, semi-structured interview, decision-making process, decision outcome, decision making, decision process, decision outcomes, capture the flag", "concept_list": ["decision-making", "decision step", "outcome determination", "goal-oriented task analysis", "semi-structured interview", "decision-making process", "decision outcome", "decision making", "decision process", "decision outcomes", "capture the flag"], "type": "cluster", "node_size": 48, "label": "Debugging & Organization"}, "Technical Problem-Solving": {"concepts": "organizational issues, organizational task, debugger friendliness, debugging info, debugging, debugger usability, organizational process, debugging information", "concept_list": ["organizational issues", "organizational task", "debugger friendliness", "debugging info", "debugging", "debugger usability", "organizational process", "debugging information"], "type": "cluster", "node_size": 39, "label": "Technical Problem-Solving"}};
        const conceptData = {};
        const interClusterEdges = [["Decision Processes", "Debugging & Organization", {"weight": 0.6, "confidence": 0.45999999999999996, "type": "inter_cluster", "style": "solid"}], ["Decision Processes", "Technical Problem-Solving", {"weight": 0.6, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Debugging & Organization", "Decision Processes", {"weight": 0.6, "confidence": 0.53, "type": "inter_cluster", "style": "solid"}], ["Technical Problem-Solving", "Decision Processes", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Technical Problem-Solving", "Debugging & Organization", {"weight": 0.25, "confidence": 0.5, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"Decision Processes": [], "Debugging & Organization": [], "Technical Problem-Solving": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>


<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Fisheries Habitat": {"concepts": "natural resource management, coastal biodiversity, marine biodiversity, social-ecological systems, shoreline restoration, oyster reef development, ecological impact, intertidal area, ecosystem health, water quality, environmental sustainability, upland development, oyster reef restoration, marine coastal management, stressors, habitat restoration, climate change, environmental stressors, environmental quality, environmental restoration, nutrient removal, species resilience, wetland restoration, shoreline development, habitat quality, resilience, oyster reef predators, wetland ecology, marine debris, predator resilience, environmental management, ecosystem services, ecological resilience, ocean acidification, living shorelines, habitat, ecological restoration, environmental stress, ecosystem connectivity, ecological stressors, habitat forming species, conservation management, panama city, mississippi, conservation, positive impact, neutral impact, foundation species, species diversity, conservation efforts, native species, management, florida, range expansion, food-web species, harmful organisms, species of conservation concern, biodiversity, outreach, shell-forming organisms, species decrease, species conservation, applied research, data transcription, bidirectional relationships, single species management, bulkheads, organizational communication, communication protocols, relationship weights, conservation strategies, key food-web supporting species, species management, species invasions, research methodology, mental modeling, alabama, organizational facilitation, interview process, regulatory stance, expert knowledge, stakeholder reliance, species interaction, stakeholder engagement, inter-management relationships, education, species interactions, management approaches, key food-web species, species increase, risk management, interview methodology, participant feedback, negative impact, beach mouse, litter, data validation, system dynamics", "concept_list": ["natural resource management", "coastal biodiversity", "marine biodiversity", "social-ecological systems", "shoreline restoration", "oyster reef development", "ecological impact", "intertidal area", "ecosystem health", "water quality", "environmental sustainability", "upland development", "oyster reef restoration", "marine coastal management", "stressors", "habitat restoration", "climate change", "environmental stressors", "environmental quality", "environmental restoration", "nutrient removal", "species resilience", "wetland restoration", "shoreline development", "habitat quality", "resilience", "oyster reef predators", "wetland ecology", "marine debris", "predator resilience", "environmental management", "ecosystem services", "ecological resilience", "ocean acidification", "living shorelines", "habitat", "ecological restoration", "environmental stress", "ecosystem connectivity", "ecological stressors", "habitat forming species", "conservation management", "panama city", "mississippi", "conservation", "positive impact", "neutral impact", "foundation species", "species diversity", "conservation efforts", "native species", "management", "florida", "range expansion", "food-web species", "harmful organisms", "species of conservation concern", "biodiversity", "outreach", "shell-forming organisms", "species decrease", "species conservation", "applied research", "data transcription", "bidirectional relationships", "single species management", "bulkheads", "organizational communication", "communication protocols", "relationship weights", "conservation strategies", "key food-web supporting species", "species management", "species invasions", "research methodology", "mental modeling", "alabama", "organizational facilitation", "interview process", "regulatory stance", "expert knowledge", "stakeholder reliance", "species interaction", "stakeholder engagement", "inter-management relationships", "education", "species interactions", "management approaches", "key food-web species", "species increase", "risk management", "interview methodology", "participant feedback", "negative impact", "beach mouse", "litter", "data validation", "system dynamics"], "type": "cluster", "node_size": 309, "label": "Fisheries Habitat"}, "Conservation Strategies": {"concepts": "habitat for fisheries, fisheries habitat, fishery habitat, fishery species, fish and wildlife service, fisheries organisms", "concept_list": ["habitat for fisheries", "fisheries habitat", "fishery habitat", "fishery species", "fish and wildlife service", "fisheries organisms"], "type": "cluster", "node_size": 33, "label": "Conservation Strategies"}};
        const conceptData = {"natural resource management": {"concepts": "natural resource management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "natural resource management"}, "coastal biodiversity": {"concepts": "coastal biodiversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "coastal biodiversity"}, "marine biodiversity": {"concepts": "marine biodiversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "marine biodiversity"}, "social-ecological systems": {"concepts": "social-ecological systems", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "social-ecological systems"}, "shoreline restoration": {"concepts": "shoreline restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "shoreline restoration"}, "oyster reef development": {"concepts": "oyster reef development", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "oyster reef development"}, "ecological impact": {"concepts": "ecological impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological impact"}, "intertidal area": {"concepts": "intertidal area", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "intertidal area"}, "ecosystem health": {"concepts": "ecosystem health", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecosystem health"}, "water quality": {"concepts": "water quality", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "water quality"}, "environmental sustainability": {"concepts": "environmental sustainability", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental sustainability"}, "upland development": {"concepts": "upland development", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "upland development"}, "oyster reef restoration": {"concepts": "oyster reef restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "oyster reef restoration"}, "marine coastal management": {"concepts": "marine coastal management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "marine coastal management"}, "stressors": {"concepts": "stressors", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "stressors"}, "habitat restoration": {"concepts": "habitat restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat restoration"}, "climate change": {"concepts": "climate change", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "climate change"}, "environmental stressors": {"concepts": "environmental stressors", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental stressors"}, "environmental quality": {"concepts": "environmental quality", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental quality"}, "environmental restoration": {"concepts": "environmental restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental restoration"}, "nutrient removal": {"concepts": "nutrient removal", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "nutrient removal"}, "species resilience": {"concepts": "species resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species resilience"}, "wetland restoration": {"concepts": "wetland restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "wetland restoration"}, "shoreline development": {"concepts": "shoreline development", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "shoreline development"}, "habitat quality": {"concepts": "habitat quality", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat quality"}, "resilience": {"concepts": "resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "resilience"}, "oyster reef predators": {"concepts": "oyster reef predators", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "oyster reef predators"}, "wetland ecology": {"concepts": "wetland ecology", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "wetland ecology"}, "marine debris": {"concepts": "marine debris", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "marine debris"}, "predator resilience": {"concepts": "predator resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "predator resilience"}, "environmental management": {"concepts": "environmental management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental management"}, "ecosystem services": {"concepts": "ecosystem services", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecosystem services"}, "ecological resilience": {"concepts": "ecological resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological resilience"}, "ocean acidification": {"concepts": "ocean acidification", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ocean acidification"}, "living shorelines": {"concepts": "living shorelines", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "living shorelines"}, "habitat": {"concepts": "habitat", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat"}, "ecological restoration": {"concepts": "ecological restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological restoration"}, "environmental stress": {"concepts": "environmental stress", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental stress"}, "ecosystem connectivity": {"concepts": "ecosystem connectivity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecosystem connectivity"}, "ecological stressors": {"concepts": "ecological stressors", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological stressors"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat forming species"}, "conservation management": {"concepts": "conservation management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation management"}, "panama city": {"concepts": "panama city", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "panama city"}, "mississippi": {"concepts": "mississippi", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "mississippi"}, "conservation": {"concepts": "conservation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation"}, "positive impact": {"concepts": "positive impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "positive impact"}, "neutral impact": {"concepts": "neutral impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "neutral impact"}, "foundation species": {"concepts": "foundation species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "foundation species"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species diversity"}, "conservation efforts": {"concepts": "conservation efforts", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation efforts"}, "native species": {"concepts": "native species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "native species"}, "management": {"concepts": "management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "management"}, "florida": {"concepts": "florida", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "florida"}, "range expansion": {"concepts": "range expansion", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "range expansion"}, "food-web species": {"concepts": "food-web species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "food-web species"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "harmful organisms"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species of conservation concern"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "biodiversity"}, "outreach": {"concepts": "outreach", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "outreach"}, "shell-forming organisms": {"concepts": "shell-forming organisms", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "shell-forming organisms"}, "species decrease": {"concepts": "species decrease", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species decrease"}, "species conservation": {"concepts": "species conservation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species conservation"}, "applied research": {"concepts": "applied research", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "applied research"}, "data transcription": {"concepts": "data transcription", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "data transcription"}, "bidirectional relationships": {"concepts": "bidirectional relationships", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "bidirectional relationships"}, "single species management": {"concepts": "single species management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "single species management"}, "bulkheads": {"concepts": "bulkheads", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "bulkheads"}, "organizational communication": {"concepts": "organizational communication", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "organizational communication"}, "communication protocols": {"concepts": "communication protocols", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "communication protocols"}, "relationship weights": {"concepts": "relationship weights", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "relationship weights"}, "conservation strategies": {"concepts": "conservation strategies", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation strategies"}, "key food-web supporting species": {"concepts": "key food-web supporting species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "key food-web supporting species"}, "species management": {"concepts": "species management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species management"}, "species invasions": {"concepts": "species invasions", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species invasions"}, "research methodology": {"concepts": "research methodology", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "research methodology"}, "mental modeling": {"concepts": "mental modeling", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "mental modeling"}, "alabama": {"concepts": "alabama", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "alabama"}, "organizational facilitation": {"concepts": "organizational facilitation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "organizational facilitation"}, "interview process": {"concepts": "interview process", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "interview process"}, "regulatory stance": {"concepts": "regulatory stance", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "regulatory stance"}, "expert knowledge": {"concepts": "expert knowledge", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "expert knowledge"}, "stakeholder reliance": {"concepts": "stakeholder reliance", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "stakeholder reliance"}, "species interaction": {"concepts": "species interaction", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species interaction"}, "stakeholder engagement": {"concepts": "stakeholder engagement", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "stakeholder engagement"}, "inter-management relationships": {"concepts": "inter-management relationships", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "inter-management relationships"}, "education": {"concepts": "education", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "education"}, "species interactions": {"concepts": "species interactions", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species interactions"}, "management approaches": {"concepts": "management approaches", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "management approaches"}, "key food-web species": {"concepts": "key food-web species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "key food-web species"}, "species increase": {"concepts": "species increase", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species increase"}, "risk management": {"concepts": "risk management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "risk management"}, "interview methodology": {"concepts": "interview methodology", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "interview methodology"}, "participant feedback": {"concepts": "participant feedback", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "participant feedback"}, "negative impact": {"concepts": "negative impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "negative impact"}, "beach mouse": {"concepts": "beach mouse", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "beach mouse"}, "litter": {"concepts": "litter", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "litter"}, "data validation": {"concepts": "data validation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "data validation"}, "system dynamics": {"concepts": "system dynamics", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "system dynamics"}, "habitat for fisheries": {"concepts": "habitat for fisheries", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "habitat for fisheries"}, "fisheries habitat": {"concepts": "fisheries habitat", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fisheries habitat"}, "fishery habitat": {"concepts": "fishery habitat", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fishery habitat"}, "fishery species": {"concepts": "fishery species", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fishery species"}, "fish and wildlife service": {"concepts": "fish and wildlife service", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fish and wildlife service"}, "fisheries organisms": {"concepts": "fisheries organisms", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fisheries organisms"}};
        const interClusterEdges = [["Fisheries Habitat", "Conservation Strategies", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Fisheries Habitat": [["natural resource management", {"concepts": "natural resource management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "natural resource management"}], ["coastal biodiversity", {"concepts": "coastal biodiversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "coastal biodiversity"}], ["marine biodiversity", {"concepts": "marine biodiversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "marine biodiversity"}], ["social-ecological systems", {"concepts": "social-ecological systems", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "social-ecological systems"}], ["shoreline restoration", {"concepts": "shoreline restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "shoreline restoration"}], ["oyster reef development", {"concepts": "oyster reef development", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "oyster reef development"}], ["ecological impact", {"concepts": "ecological impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological impact"}], ["intertidal area", {"concepts": "intertidal area", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "intertidal area"}], ["ecosystem health", {"concepts": "ecosystem health", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecosystem health"}], ["water quality", {"concepts": "water quality", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "water quality"}], ["environmental sustainability", {"concepts": "environmental sustainability", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental sustainability"}], ["upland development", {"concepts": "upland development", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "upland development"}], ["oyster reef restoration", {"concepts": "oyster reef restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "oyster reef restoration"}], ["marine coastal management", {"concepts": "marine coastal management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "marine coastal management"}], ["stressors", {"concepts": "stressors", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "stressors"}], ["habitat restoration", {"concepts": "habitat restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat restoration"}], ["climate change", {"concepts": "climate change", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "climate change"}], ["environmental stressors", {"concepts": "environmental stressors", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental stressors"}], ["environmental quality", {"concepts": "environmental quality", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental quality"}], ["environmental restoration", {"concepts": "environmental restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental restoration"}], ["nutrient removal", {"concepts": "nutrient removal", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "nutrient removal"}], ["species resilience", {"concepts": "species resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species resilience"}], ["wetland restoration", {"concepts": "wetland restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "wetland restoration"}], ["shoreline development", {"concepts": "shoreline development", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "shoreline development"}], ["habitat quality", {"concepts": "habitat quality", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat quality"}], ["resilience", {"concepts": "resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "resilience"}], ["oyster reef predators", {"concepts": "oyster reef predators", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "oyster reef predators"}], ["wetland ecology", {"concepts": "wetland ecology", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "wetland ecology"}], ["marine debris", {"concepts": "marine debris", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "marine debris"}], ["predator resilience", {"concepts": "predator resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "predator resilience"}], ["environmental management", {"concepts": "environmental management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental management"}], ["ecosystem services", {"concepts": "ecosystem services", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecosystem services"}], ["ecological resilience", {"concepts": "ecological resilience", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological resilience"}], ["ocean acidification", {"concepts": "ocean acidification", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ocean acidification"}], ["living shorelines", {"concepts": "living shorelines", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "living shorelines"}], ["habitat", {"concepts": "habitat", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat"}], ["ecological restoration", {"concepts": "ecological restoration", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological restoration"}], ["environmental stress", {"concepts": "environmental stress", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "environmental stress"}], ["ecosystem connectivity", {"concepts": "ecosystem connectivity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecosystem connectivity"}], ["ecological stressors", {"concepts": "ecological stressors", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "ecological stressors"}], ["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "habitat forming species"}], ["conservation management", {"concepts": "conservation management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation management"}], ["panama city", {"concepts": "panama city", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "panama city"}], ["mississippi", {"concepts": "mississippi", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "mississippi"}], ["conservation", {"concepts": "conservation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation"}], ["positive impact", {"concepts": "positive impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "positive impact"}], ["neutral impact", {"concepts": "neutral impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "neutral impact"}], ["foundation species", {"concepts": "foundation species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "foundation species"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species diversity"}], ["conservation efforts", {"concepts": "conservation efforts", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation efforts"}], ["native species", {"concepts": "native species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "native species"}], ["management", {"concepts": "management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "management"}], ["florida", {"concepts": "florida", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "florida"}], ["range expansion", {"concepts": "range expansion", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "range expansion"}], ["food-web species", {"concepts": "food-web species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "food-web species"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "harmful organisms"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species of conservation concern"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "biodiversity"}], ["outreach", {"concepts": "outreach", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "outreach"}], ["shell-forming organisms", {"concepts": "shell-forming organisms", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "shell-forming organisms"}], ["species decrease", {"concepts": "species decrease", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species decrease"}], ["species conservation", {"concepts": "species conservation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species conservation"}], ["applied research", {"concepts": "applied research", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "applied research"}], ["data transcription", {"concepts": "data transcription", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "data transcription"}], ["bidirectional relationships", {"concepts": "bidirectional relationships", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "bidirectional relationships"}], ["single species management", {"concepts": "single species management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "single species management"}], ["bulkheads", {"concepts": "bulkheads", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "bulkheads"}], ["organizational communication", {"concepts": "organizational communication", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "organizational communication"}], ["communication protocols", {"concepts": "communication protocols", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "communication protocols"}], ["relationship weights", {"concepts": "relationship weights", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "relationship weights"}], ["conservation strategies", {"concepts": "conservation strategies", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "conservation strategies"}], ["key food-web supporting species", {"concepts": "key food-web supporting species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "key food-web supporting species"}], ["species management", {"concepts": "species management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species management"}], ["species invasions", {"concepts": "species invasions", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species invasions"}], ["research methodology", {"concepts": "research methodology", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "research methodology"}], ["mental modeling", {"concepts": "mental modeling", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "mental modeling"}], ["alabama", {"concepts": "alabama", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "alabama"}], ["organizational facilitation", {"concepts": "organizational facilitation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "organizational facilitation"}], ["interview process", {"concepts": "interview process", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "interview process"}], ["regulatory stance", {"concepts": "regulatory stance", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "regulatory stance"}], ["expert knowledge", {"concepts": "expert knowledge", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "expert knowledge"}], ["stakeholder reliance", {"concepts": "stakeholder reliance", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "stakeholder reliance"}], ["species interaction", {"concepts": "species interaction", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species interaction"}], ["stakeholder engagement", {"concepts": "stakeholder engagement", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "stakeholder engagement"}], ["inter-management relationships", {"concepts": "inter-management relationships", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "inter-management relationships"}], ["education", {"concepts": "education", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "education"}], ["species interactions", {"concepts": "species interactions", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species interactions"}], ["management approaches", {"concepts": "management approaches", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "management approaches"}], ["key food-web species", {"concepts": "key food-web species", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "key food-web species"}], ["species increase", {"concepts": "species increase", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "species increase"}], ["risk management", {"concepts": "risk management", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "risk management"}], ["interview methodology", {"concepts": "interview methodology", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "interview methodology"}], ["participant feedback", {"concepts": "participant feedback", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "participant feedback"}], ["negative impact", {"concepts": "negative impact", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "negative impact"}], ["beach mouse", {"concepts": "beach mouse", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "beach mouse"}], ["litter", {"concepts": "litter", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "litter"}], ["data validation", {"concepts": "data validation", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "data validation"}], ["system dynamics", {"concepts": "system dynamics", "type": "concept", "cluster": "Fisheries Habitat", "node_size": 10, "label": "system dynamics"}]], "Conservation Strategies": [["habitat for fisheries", {"concepts": "habitat for fisheries", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "habitat for fisheries"}], ["fisheries habitat", {"concepts": "fisheries habitat", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fisheries habitat"}], ["fishery habitat", {"concepts": "fishery habitat", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fishery habitat"}], ["fishery species", {"concepts": "fishery species", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fishery species"}], ["fish and wildlife service", {"concepts": "fish and wildlife service", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fish and wildlife service"}], ["fisheries organisms", {"concepts": "fisheries organisms", "type": "concept", "cluster": "Conservation Strategies", "node_size": 10, "label": "fisheries organisms"}]]};
        const clusterEdges = {"Fisheries Habitat": [], "Conservation Strategies": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

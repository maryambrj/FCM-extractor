
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Exploit Techniques": {"concepts": "script, language, environment, executable, decompilers, fuzzer, tool, program, python, fake flags, decompile, jumping to conclusions, o-tool, technical factors, challenge, ctf, file, debuggers, computer software, operating system, scripting, binary exploitation, useful output, binary, reversing challenge, mimic, libraries, virtualize, tools, assembly, javascript, examining source code, read code, examine code, code, c, input, format, standard output, iterative process, mac devices", "concept_list": ["script", "language", "environment", "executable", "decompilers", "fuzzer", "tool", "program", "python", "fake flags", "decompile", "jumping to conclusions", "o-tool", "technical factors", "challenge", "ctf", "file", "debuggers", "computer software", "operating system", "scripting", "binary exploitation", "useful output", "binary", "reversing challenge", "mimic", "libraries", "virtualize", "tools", "assembly", "javascript", "examining source code", "read code", "examine code", "code", "c", "input", "format", "standard output", "iterative process", "mac devices"], "type": "cluster", "node_size": 138, "label": "Exploit Techniques"}, "Pattern Recognition": {"concepts": "stack canary, server, malloc, misled, checksec, obfuscated, experimenter, open mind, unexpected behavior, malicious data, 64-bit, forensics, crypto, re-examine, pwntools, proof of concepts, functions, success condition, malicious packet, web-based ctf, heap exploitation, negative influence, misunderstanding, perception of progress, reading code, non-executable stack, crash program, running binary, registers, emulate, packet, step three, analyze, protections, test it out, challenges, heap, wireshark packet, pi cryptodome, security measures, exploit, structure, cyber attackers, data, flag, misleading results, surprises, byte values, failure, product understanding, ctf description, buffer sizes, ctf category, crashing, crypto challenge, binary data, previous experience, pwn challenges, identifying protections, past experience, process, challenge code, binary stripped, misused functions, testing exploit, burp suite, privileged permissions, response, cryptography challenge, stack protections, man in the middle, memory, crash, address randomization, distractions, check sec, cyber attacks, cryptographic libraries, bypass security, remote server", "concept_list": ["stack canary", "server", "malloc", "misled", "checksec", "obfuscated", "experimenter", "open mind", "unexpected behavior", "malicious data", "64-bit", "forensics", "crypto", "re-examine", "pwntools", "proof of concepts", "functions", "success condition", "malicious packet", "web-based ctf", "heap exploitation", "negative influence", "misunderstanding", "perception of progress", "reading code", "non-executable stack", "crash program", "running binary", "registers", "emulate", "packet", "step three", "analyze", "protections", "test it out", "challenges", "heap", "wireshark packet", "pi cryptodome", "security measures", "exploit", "structure", "cyber attackers", "data", "flag", "misleading results", "surprises", "byte values", "failure", "product understanding", "ctf description", "buffer sizes", "ctf category", "crashing", "crypto challenge", "binary data", "previous experience", "pwn challenges", "identifying protections", "past experience", "process", "challenge code", "binary stripped", "misused functions", "testing exploit", "burp suite", "privileged permissions", "response", "cryptography challenge", "stack protections", "man in the middle", "memory", "crash", "address randomization", "distractions", "check sec", "cyber attacks", "cryptographic libraries", "bypass security", "remote server"], "type": "cluster", "node_size": 255, "label": "Pattern Recognition"}, "GitHub Step": {"concepts": "pattern, input values, assumptions, causal graph, standard in, graphical data, ctfs, sensitive information, understanding, forensics challenges, challenge condition, source code, fuzzers, 32-bit, symbols, google results, causal relationships, wrong path, impersonating cookie, complex system, participant, outputs, output, progress, step two, function works, inconclusive results, tool errors, user input, base64, fresh start, standard input, statements, mathematical operation, fuzzy cognitive map, reversible operations, challenge type, causal factor, making assumptions, examining code, plain text, encryption algorithms, file signatures, identification patterns, skepticism, informative description, negative arrows, ciphertext, successful identification, file extensions, get request, code patterns, step number four, key factors, interaction, random values, readability, googling, encoding, frequency analysis, success, successful understanding, understanding code, directed network, encryption algorithm, time waster, craftsmanship, category tools, goal-based task analysis, patterns, google, decisions, hex values, conclusions, knowledge, discover, misleading belief, semi-structured approach, positive arrows, identification, usefulness, iterative step, beliefs, full understanding, generated factors, failure condition, meaning, feedback, matrix file", "concept_list": ["pattern", "input values", "assumptions", "causal graph", "standard in", "graphical data", "ctfs", "sensitive information", "understanding", "forensics challenges", "challenge condition", "source code", "fuzzers", "32-bit", "symbols", "google results", "causal relationships", "wrong path", "impersonating cookie", "complex system", "participant", "outputs", "output", "progress", "step two", "function works", "inconclusive results", "tool errors", "user input", "base64", "fresh start", "standard input", "statements", "mathematical operation", "fuzzy cognitive map", "reversible operations", "challenge type", "causal factor", "making assumptions", "examining code", "plain text", "encryption algorithms", "file signatures", "identification patterns", "skepticism", "informative description", "negative arrows", "ciphertext", "successful identification", "file extensions", "get request", "code patterns", "step number four", "key factors", "interaction", "random values", "readability", "googling", "encoding", "frequency analysis", "success", "successful understanding", "understanding code", "directed network", "encryption algorithm", "time waster", "craftsmanship", "category tools", "goal-based task analysis", "patterns", "google", "decisions", "hex values", "conclusions", "knowledge", "discover", "misleading belief", "semi-structured approach", "positive arrows", "identification", "usefulness", "iterative step", "beliefs", "full understanding", "generated factors", "failure condition", "meaning", "feedback", "matrix file"], "type": "cluster", "node_size": 282, "label": "GitHub Step"}, "Vulnerability Detection": {"concepts": "step five, github", "concept_list": ["step five", "github"], "type": "cluster", "node_size": 21, "label": "Vulnerability Detection"}, "Code Analysis Tools": {"concepts": "possible vulnerability, discovered vulnerability, vulnerabilities, vulnerability", "concept_list": ["possible vulnerability", "discovered vulnerability", "vulnerabilities", "vulnerability"], "type": "cluster", "node_size": 27, "label": "Code Analysis Tools"}, "Code Vulnerabilities": {"concepts": "vulnerable, vulnerable functions, vulnerable program, vulnerable code, vulnerable coding", "concept_list": ["vulnerable", "vulnerable functions", "vulnerable program", "vulnerable code", "vulnerable coding"], "type": "cluster", "node_size": 30, "label": "Code Vulnerabilities"}, "Vulnerability Types": {"concepts": "vulnerability type, vulnerability type.", "concept_list": ["vulnerability type", "vulnerability type."], "type": "cluster", "node_size": 21, "label": "Vulnerability Types"}};
        const conceptData = {};
        const interClusterEdges = [["Exploit Techniques", "Vulnerability Detection", {"weight": 0.8, "confidence": 0.63, "type": "inter_cluster", "style": "solid"}], ["Exploit Techniques", "Pattern Recognition", {"weight": 0.75, "confidence": 0.5875, "type": "inter_cluster", "style": "solid"}], ["Exploit Techniques", "GitHub Step", {"weight": 0.5, "confidence": 0.42500000000000004, "type": "inter_cluster", "style": "solid"}], ["Exploit Techniques", "Code Vulnerabilities", {"weight": 0.3333333333333333, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Exploit Techniques", "Code Analysis Tools", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["Exploit Techniques", "Vulnerability Types", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["Pattern Recognition", "Vulnerability Detection", {"weight": 0.8, "confidence": 0.64, "type": "inter_cluster", "style": "solid"}], ["Pattern Recognition", "Code Vulnerabilities", {"weight": 0.75, "confidence": 0.5874999999999999, "type": "inter_cluster", "style": "solid"}], ["Pattern Recognition", "Code Analysis Tools", {"weight": 0.6, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Pattern Recognition", "Vulnerability Types", {"weight": 0.6666666666666666, "confidence": 0.5166666666666667, "type": "inter_cluster", "style": "solid"}], ["Pattern Recognition", "Exploit Techniques", {"weight": 0.4, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Pattern Recognition", "GitHub Step", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["GitHub Step", "Exploit Techniques", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["GitHub Step", "Pattern Recognition", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["GitHub Step", "Vulnerability Detection", {"weight": 0.3333333333333333, "confidence": 0.2833333333333333, "type": "inter_cluster", "style": "solid"}], ["GitHub Step", "Code Analysis Tools", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["GitHub Step", "Code Vulnerabilities", {"weight": 0.3333333333333333, "confidence": 0.2833333333333333, "type": "inter_cluster", "style": "solid"}], ["GitHub Step", "Vulnerability Types", {"weight": 0.3333333333333333, "confidence": 0.2833333333333333, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Detection", "Exploit Techniques", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Detection", "Pattern Recognition", {"weight": 0.5, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Detection", "Code Vulnerabilities", {"weight": 0.8, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Detection", "GitHub Step", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Detection", "Code Analysis Tools", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Detection", "Vulnerability Types", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Code Analysis Tools", "Pattern Recognition", {"weight": 0.8, "confidence": 0.63, "type": "inter_cluster", "style": "solid"}], ["Code Analysis Tools", "Vulnerability Types", {"weight": 0.6666666666666666, "confidence": 0.5499999999999999, "type": "inter_cluster", "style": "solid"}], ["Code Analysis Tools", "GitHub Step", {"weight": 0.5, "confidence": 0.38749999999999996, "type": "inter_cluster", "style": "solid"}], ["Code Analysis Tools", "Vulnerability Detection", {"weight": 0.4, "confidence": 0.31, "type": "inter_cluster", "style": "solid"}], ["Code Analysis Tools", "Code Vulnerabilities", {"weight": 0.5, "confidence": 0.475, "type": "inter_cluster", "style": "solid"}], ["Code Analysis Tools", "Exploit Techniques", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["Code Vulnerabilities", "Vulnerability Detection", {"weight": 0.8, "confidence": 0.61, "type": "inter_cluster", "style": "solid"}], ["Code Vulnerabilities", "Pattern Recognition", {"weight": 0.75, "confidence": 0.575, "type": "inter_cluster", "style": "solid"}], ["Code Vulnerabilities", "Code Analysis Tools", {"weight": 0.5, "confidence": 0.4375, "type": "inter_cluster", "style": "solid"}], ["Code Vulnerabilities", "Exploit Techniques", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["Code Vulnerabilities", "Vulnerability Types", {"weight": 0.3333333333333333, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Code Vulnerabilities", "GitHub Step", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Types", "GitHub Step", {"weight": 0.8, "confidence": 0.6200000000000001, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Types", "Pattern Recognition", {"weight": 0.75, "confidence": 0.575, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Types", "Code Vulnerabilities", {"weight": 0.5, "confidence": 0.4375, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Types", "Code Analysis Tools", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Types", "Exploit Techniques", {"weight": 0.3333333333333333, "confidence": 0.2833333333333333, "type": "inter_cluster", "style": "solid"}], ["Vulnerability Types", "Vulnerability Detection", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"Exploit Techniques": [], "Pattern Recognition": [], "GitHub Step": [], "Vulnerability Detection": [], "Code Analysis Tools": [], "Code Vulnerabilities": [], "Vulnerability Types": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

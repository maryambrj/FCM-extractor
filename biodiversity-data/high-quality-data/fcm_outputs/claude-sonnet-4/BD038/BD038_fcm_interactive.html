
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"clean water act": {"concepts": "clean water act", "concept_list": ["clean water act"], "type": "cluster", "node_size": 18, "label": "clean water act"}, "food web": {"concepts": "food web", "concept_list": ["food web"], "type": "cluster", "node_size": 18, "label": "food web"}, "environmental nonprofit": {"concepts": "environmental nonprofit", "concept_list": ["environmental nonprofit"], "type": "cluster", "node_size": 18, "label": "environmental nonprofit"}, "Marine Ecosystems": {"concepts": "marine resource management, wetlands, seagrass beds", "concept_list": ["marine resource management", "wetlands", "seagrass beds"], "type": "cluster", "node_size": 24, "label": "Marine Ecosystems"}, "Regulatory Framework": {"concepts": "epa, federal standards, army corps, state standards, submerged aquatic vegetation, permits, after the fact permits, enactment, policy, management policies", "concept_list": ["epa", "federal standards", "army corps", "state standards", "submerged aquatic vegetation", "permits", "after the fact permits", "enactment", "policy", "management policies"], "type": "cluster", "node_size": 45, "label": "Regulatory Framework"}, "Enforcement Actions": {"concepts": "habitat enforcement, federal enforcement, enforcement disconnect, epa enforcement, enforcement, enforcement plans, litigation, court involvement, regulatory enforcement", "concept_list": ["habitat enforcement", "federal enforcement", "enforcement disconnect", "epa enforcement", "enforcement", "enforcement plans", "litigation", "court involvement", "regulatory enforcement"], "type": "cluster", "node_size": 42, "label": "Enforcement Actions"}, "Habitat Management": {"concepts": "habitat forming, habitat, habitat protection, habitat functionality, habitat diversity, protected species habitat, habitat forming species, access habitats, restoration, fragmentation, degradation", "concept_list": ["habitat forming", "habitat", "habitat protection", "habitat functionality", "habitat diversity", "protected species habitat", "habitat forming species", "access habitats", "restoration", "fragmentation", "degradation"], "type": "cluster", "node_size": 48, "label": "Habitat Management"}, "Species Protection": {"concepts": "species conservation concern, conservation concern, sensitive species, protected species, listed species, delisting processes, poster child species, keystone species, supporting species, species protection, species, indicative species, invasive species, native vegetation, harmful organisms, organisms", "concept_list": ["species conservation concern", "conservation concern", "sensitive species", "protected species", "listed species", "delisting processes", "poster child species", "keystone species", "supporting species", "species protection", "species", "indicative species", "invasive species", "native vegetation", "harmful organisms", "organisms"], "type": "cluster", "node_size": 63, "label": "Species Protection"}, "Mitigation Banking": {"concepts": "mitigation credits, development credits, mitigation banks, improvement plans, incentivization", "concept_list": ["mitigation credits", "development credits", "mitigation banks", "improvement plans", "incentivization"], "type": "cluster", "node_size": 30, "label": "Mitigation Banking"}, "Public Data Collection": {"concepts": "public engagement, interview process, waterkeeper alliance, audubon society, surveys, habitat surveys, citizen scientists, public species counts, species counts, public data, data collection, biodiversity data, apps", "concept_list": ["public engagement", "interview process", "waterkeeper alliance", "audubon society", "surveys", "habitat surveys", "citizen scientists", "public species counts", "species counts", "public data", "data collection", "biodiversity data", "apps"], "type": "cluster", "node_size": 54, "label": "Public Data Collection"}, "Water Use Designations": {"concepts": "swimming designation, industrial uses, recreational swimming, wildlife propagation, migrations, seasonality, urbanized wildlife interactions", "concept_list": ["swimming designation", "industrial uses", "recreational swimming", "wildlife propagation", "migrations", "seasonality", "urbanized wildlife interactions"], "type": "cluster", "node_size": 36, "label": "Water Use Designations"}, "Water Quality Protection": {"concepts": "filtration, gallons, outfall, mobile bay, workshop tool, staff scientist, jurisdictional protection, threshold, biodiversity, protections", "concept_list": ["filtration", "gallons", "outfall", "mobile bay", "workshop tool", "staff scientist", "jurisdictional protection", "threshold", "biodiversity", "protections"], "type": "cluster", "node_size": 45, "label": "Water Quality Protection"}, "Regulatory Management": {"concepts": "biodiversity management, designations, regulatory agencies, development", "concept_list": ["biodiversity management", "designations", "regulatory agencies", "development"], "type": "cluster", "node_size": 27, "label": "Regulatory Management"}, "Water Quality Management": {"concepts": "water quality, water quality thresholds, water quality monitoring, water quality enforcement", "concept_list": ["water quality", "water quality thresholds", "water quality monitoring", "water quality enforcement"], "type": "cluster", "node_size": 27, "label": "Water Quality Management"}, "Treatment Systems": {"concepts": "water improvement plans, water improvement, wastewater treatment, effluent", "concept_list": ["water improvement plans", "water improvement", "wastewater treatment", "effluent"], "type": "cluster", "node_size": 27, "label": "Treatment Systems"}, "Water Bodies": {"concepts": "coastal waters, tributary waters, waterways, impaired waterways", "concept_list": ["coastal waters", "tributary waters", "waterways", "impaired waterways"], "type": "cluster", "node_size": 27, "label": "Water Bodies"}, "Restoration Efforts": {"concepts": "pollution intervention, oyster restoration", "concept_list": ["pollution intervention", "oyster restoration"], "type": "cluster", "node_size": 21, "label": "Restoration Efforts"}, "Riparian Corridors": {"concepts": "corridors, riparian, riparian bank", "concept_list": ["corridors", "riparian", "riparian bank"], "type": "cluster", "node_size": 24, "label": "Riparian Corridors"}, "Fish Management": {"concepts": "fish propagation, fish consumption, fishing designation", "concept_list": ["fish propagation", "fish consumption", "fishing designation"], "type": "cluster", "node_size": 24, "label": "Fish Management"}, "Ecosystem Value": {"concepts": "ecological value, ecosystem diversity, ecosystem resources", "concept_list": ["ecological value", "ecosystem diversity", "ecosystem resources"], "type": "cluster", "node_size": 24, "label": "Ecosystem Value"}, "Ecosystem Function": {"concepts": "ecosystem function, ecosystem components, restoration ecologist, food webs", "concept_list": ["ecosystem function", "ecosystem components", "restoration ecologist", "food webs"], "type": "cluster", "node_size": 27, "label": "Ecosystem Function"}};
        const conceptData = {"marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Ecosystems", "node_size": 10, "label": "marine resource management"}, "wetlands": {"concepts": "wetlands", "type": "concept", "cluster": "Marine Ecosystems", "node_size": 10, "label": "wetlands"}, "seagrass beds": {"concepts": "seagrass beds", "type": "concept", "cluster": "Marine Ecosystems", "node_size": 10, "label": "seagrass beds"}, "epa": {"concepts": "epa", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "epa"}, "federal standards": {"concepts": "federal standards", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "federal standards"}, "army corps": {"concepts": "army corps", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "army corps"}, "state standards": {"concepts": "state standards", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "state standards"}, "submerged aquatic vegetation": {"concepts": "submerged aquatic vegetation", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "submerged aquatic vegetation"}, "permits": {"concepts": "permits", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "permits"}, "after the fact permits": {"concepts": "after the fact permits", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "after the fact permits"}, "enactment": {"concepts": "enactment", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "enactment"}, "policy": {"concepts": "policy", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "policy"}, "management policies": {"concepts": "management policies", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "management policies"}, "habitat enforcement": {"concepts": "habitat enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "habitat enforcement"}, "federal enforcement": {"concepts": "federal enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "federal enforcement"}, "enforcement disconnect": {"concepts": "enforcement disconnect", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "enforcement disconnect"}, "epa enforcement": {"concepts": "epa enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "epa enforcement"}, "enforcement": {"concepts": "enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "enforcement"}, "enforcement plans": {"concepts": "enforcement plans", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "enforcement plans"}, "litigation": {"concepts": "litigation", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "litigation"}, "court involvement": {"concepts": "court involvement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "court involvement"}, "regulatory enforcement": {"concepts": "regulatory enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "regulatory enforcement"}, "habitat forming": {"concepts": "habitat forming", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat forming"}, "habitat": {"concepts": "habitat", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat"}, "habitat protection": {"concepts": "habitat protection", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat protection"}, "habitat functionality": {"concepts": "habitat functionality", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat functionality"}, "habitat diversity": {"concepts": "habitat diversity", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat diversity"}, "protected species habitat": {"concepts": "protected species habitat", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "protected species habitat"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat forming species"}, "access habitats": {"concepts": "access habitats", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "access habitats"}, "restoration": {"concepts": "restoration", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "restoration"}, "fragmentation": {"concepts": "fragmentation", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "fragmentation"}, "degradation": {"concepts": "degradation", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "degradation"}, "species conservation concern": {"concepts": "species conservation concern", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "species conservation concern"}, "conservation concern": {"concepts": "conservation concern", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "conservation concern"}, "sensitive species": {"concepts": "sensitive species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "sensitive species"}, "protected species": {"concepts": "protected species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "protected species"}, "listed species": {"concepts": "listed species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "listed species"}, "delisting processes": {"concepts": "delisting processes", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "delisting processes"}, "poster child species": {"concepts": "poster child species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "poster child species"}, "keystone species": {"concepts": "keystone species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "keystone species"}, "supporting species": {"concepts": "supporting species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "supporting species"}, "species protection": {"concepts": "species protection", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "species protection"}, "species": {"concepts": "species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "species"}, "indicative species": {"concepts": "indicative species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "indicative species"}, "invasive species": {"concepts": "invasive species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "invasive species"}, "native vegetation": {"concepts": "native vegetation", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "native vegetation"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "harmful organisms"}, "organisms": {"concepts": "organisms", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "organisms"}, "mitigation credits": {"concepts": "mitigation credits", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "mitigation credits"}, "development credits": {"concepts": "development credits", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "development credits"}, "mitigation banks": {"concepts": "mitigation banks", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "mitigation banks"}, "improvement plans": {"concepts": "improvement plans", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "improvement plans"}, "incentivization": {"concepts": "incentivization", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "incentivization"}, "public engagement": {"concepts": "public engagement", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "public engagement"}, "interview process": {"concepts": "interview process", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "interview process"}, "waterkeeper alliance": {"concepts": "waterkeeper alliance", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "waterkeeper alliance"}, "audubon society": {"concepts": "audubon society", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "audubon society"}, "surveys": {"concepts": "surveys", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "surveys"}, "habitat surveys": {"concepts": "habitat surveys", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "habitat surveys"}, "citizen scientists": {"concepts": "citizen scientists", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "citizen scientists"}, "public species counts": {"concepts": "public species counts", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "public species counts"}, "species counts": {"concepts": "species counts", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "species counts"}, "public data": {"concepts": "public data", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "public data"}, "data collection": {"concepts": "data collection", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "data collection"}, "biodiversity data": {"concepts": "biodiversity data", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "biodiversity data"}, "apps": {"concepts": "apps", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "apps"}, "swimming designation": {"concepts": "swimming designation", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "swimming designation"}, "industrial uses": {"concepts": "industrial uses", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "industrial uses"}, "recreational swimming": {"concepts": "recreational swimming", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "recreational swimming"}, "wildlife propagation": {"concepts": "wildlife propagation", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "wildlife propagation"}, "migrations": {"concepts": "migrations", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "migrations"}, "seasonality": {"concepts": "seasonality", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "seasonality"}, "urbanized wildlife interactions": {"concepts": "urbanized wildlife interactions", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "urbanized wildlife interactions"}, "filtration": {"concepts": "filtration", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "filtration"}, "gallons": {"concepts": "gallons", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "gallons"}, "outfall": {"concepts": "outfall", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "outfall"}, "mobile bay": {"concepts": "mobile bay", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "mobile bay"}, "workshop tool": {"concepts": "workshop tool", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "workshop tool"}, "staff scientist": {"concepts": "staff scientist", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "staff scientist"}, "jurisdictional protection": {"concepts": "jurisdictional protection", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "jurisdictional protection"}, "threshold": {"concepts": "threshold", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "threshold"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "biodiversity"}, "protections": {"concepts": "protections", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "protections"}, "biodiversity management": {"concepts": "biodiversity management", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "biodiversity management"}, "designations": {"concepts": "designations", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "designations"}, "regulatory agencies": {"concepts": "regulatory agencies", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "regulatory agencies"}, "development": {"concepts": "development", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "development"}, "water quality": {"concepts": "water quality", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality"}, "water quality thresholds": {"concepts": "water quality thresholds", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality thresholds"}, "water quality monitoring": {"concepts": "water quality monitoring", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality monitoring"}, "water quality enforcement": {"concepts": "water quality enforcement", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality enforcement"}, "water improvement plans": {"concepts": "water improvement plans", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "water improvement plans"}, "water improvement": {"concepts": "water improvement", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "water improvement"}, "wastewater treatment": {"concepts": "wastewater treatment", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "wastewater treatment"}, "effluent": {"concepts": "effluent", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "effluent"}, "coastal waters": {"concepts": "coastal waters", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "coastal waters"}, "tributary waters": {"concepts": "tributary waters", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "tributary waters"}, "waterways": {"concepts": "waterways", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "waterways"}, "impaired waterways": {"concepts": "impaired waterways", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "impaired waterways"}, "pollution intervention": {"concepts": "pollution intervention", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "pollution intervention"}, "oyster restoration": {"concepts": "oyster restoration", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "oyster restoration"}, "corridors": {"concepts": "corridors", "type": "concept", "cluster": "Riparian Corridors", "node_size": 10, "label": "corridors"}, "riparian": {"concepts": "riparian", "type": "concept", "cluster": "Riparian Corridors", "node_size": 10, "label": "riparian"}, "riparian bank": {"concepts": "riparian bank", "type": "concept", "cluster": "Riparian Corridors", "node_size": 10, "label": "riparian bank"}, "fish propagation": {"concepts": "fish propagation", "type": "concept", "cluster": "Fish Management", "node_size": 10, "label": "fish propagation"}, "fish consumption": {"concepts": "fish consumption", "type": "concept", "cluster": "Fish Management", "node_size": 10, "label": "fish consumption"}, "fishing designation": {"concepts": "fishing designation", "type": "concept", "cluster": "Fish Management", "node_size": 10, "label": "fishing designation"}, "ecological value": {"concepts": "ecological value", "type": "concept", "cluster": "Ecosystem Value", "node_size": 10, "label": "ecological value"}, "ecosystem diversity": {"concepts": "ecosystem diversity", "type": "concept", "cluster": "Ecosystem Value", "node_size": 10, "label": "ecosystem diversity"}, "ecosystem resources": {"concepts": "ecosystem resources", "type": "concept", "cluster": "Ecosystem Value", "node_size": 10, "label": "ecosystem resources"}, "ecosystem function": {"concepts": "ecosystem function", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "ecosystem function"}, "ecosystem components": {"concepts": "ecosystem components", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "ecosystem components"}, "restoration ecologist": {"concepts": "restoration ecologist", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "restoration ecologist"}, "food webs": {"concepts": "food webs", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "food webs"}};
        const interClusterEdges = [["clean water act", "Restoration Efforts", {"weight": 1.0, "confidence": 0.7875, "type": "inter_cluster", "style": "solid"}], ["clean water act", "Water Use Designations", {"weight": 0.2, "confidence": 0.48, "type": "inter_cluster", "style": "solid"}], ["food web", "Regulatory Framework", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["food web", "Public Data Collection", {"weight": 1.0, "confidence": 0.7374999999999999, "type": "inter_cluster", "style": "solid"}], ["food web", "Restoration Efforts", {"weight": 0.8, "confidence": 0.5900000000000001, "type": "inter_cluster", "style": "solid"}], ["environmental nonprofit", "Water Quality Management", {"weight": 0.6, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["environmental nonprofit", "Fish Management", {"weight": 0.4, "confidence": 0.64, "type": "inter_cluster", "style": "solid"}], ["environmental nonprofit", "Water Bodies", {"weight": 0.6666666666666666, "confidence": 0.5499999999999999, "type": "inter_cluster", "style": "solid"}], ["environmental nonprofit", "Water Use Designations", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["Marine Ecosystems", "Water Quality Management", {"weight": 0.8, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Marine Ecosystems", "food web", {"weight": 0.75, "confidence": 0.5875, "type": "inter_cluster", "style": "solid"}], ["Regulatory Framework", "clean water act", {"weight": 0.8, "confidence": 0.62, "type": "inter_cluster", "style": "solid"}], ["Regulatory Framework", "Marine Ecosystems", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Enforcement Actions", "environmental nonprofit", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Enforcement Actions", "Water Use Designations", {"weight": 0.25, "confidence": 0.175, "type": "inter_cluster", "style": "solid"}], ["Habitat Management", "Water Quality Management", {"weight": 1.0, "confidence": 0.77, "type": "inter_cluster", "style": "solid"}], ["Habitat Management", "Species Protection", {"weight": 0.8, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Habitat Management", "Ecosystem Function", {"weight": 0.75, "confidence": 0.6125, "type": "inter_cluster", "style": "solid"}], ["Habitat Management", "food web", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Species Protection", "Ecosystem Value", {"weight": 1.0, "confidence": 0.8100000000000002, "type": "inter_cluster", "style": "solid"}], ["Species Protection", "Public Data Collection", {"weight": 1.0, "confidence": 0.7833333333333333, "type": "inter_cluster", "style": "solid"}], ["Species Protection", "Water Quality Management", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Mitigation Banking", "Ecosystem Function", {"weight": -0.2, "confidence": 0.45999999999999996, "type": "inter_cluster", "style": "solid"}], ["Public Data Collection", "Water Quality Protection", {"weight": 0.75, "confidence": 0.5625, "type": "inter_cluster", "style": "solid"}], ["Public Data Collection", "Water Quality Management", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Public Data Collection", "Mitigation Banking", {"weight": -0.5, "confidence": 0.3125, "type": "inter_cluster", "style": "solid"}], ["Water Use Designations", "Ecosystem Function", {"weight": 1.0, "confidence": 0.74, "type": "inter_cluster", "style": "solid"}], ["Water Use Designations", "Marine Ecosystems", {"weight": 0.6666666666666666, "confidence": 0.5499999999999999, "type": "inter_cluster", "style": "solid"}], ["Water Use Designations", "clean water act", {"weight": 0.4, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Water Use Designations", "Fish Management", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["Water Quality Protection", "Water Quality Management", {"weight": 0.8, "confidence": 0.62, "type": "inter_cluster", "style": "solid"}], ["Water Quality Protection", "Enforcement Actions", {"weight": 0.8, "confidence": 0.58, "type": "inter_cluster", "style": "solid"}], ["Regulatory Management", "Marine Ecosystems", {"weight": 0.8, "confidence": 0.5900000000000001, "type": "inter_cluster", "style": "solid"}], ["Water Quality Management", "Habitat Management", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Treatment Systems", "Marine Ecosystems", {"weight": 0.5, "confidence": 0.3875, "type": "inter_cluster", "style": "solid"}], ["Water Bodies", "clean water act", {"weight": 0.25, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Water Bodies", "Public Data Collection", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["Water Bodies", "environmental nonprofit", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["Water Bodies", "Species Protection", {"weight": 0.3333333333333333, "confidence": 0.2333333333333333, "type": "inter_cluster", "style": "solid"}], ["Water Bodies", "Regulatory Framework", {"weight": 0.3333333333333333, "confidence": 0.2333333333333333, "type": "inter_cluster", "style": "solid"}], ["Restoration Efforts", "Habitat Management", {"weight": 0.8, "confidence": 0.67, "type": "inter_cluster", "style": "solid"}], ["Restoration Efforts", "food web", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["Restoration Efforts", "clean water act", {"weight": 0.3333333333333333, "confidence": 0.2333333333333333, "type": "inter_cluster", "style": "solid"}], ["Restoration Efforts", "Water Use Designations", {"weight": 0.3333333333333333, "confidence": 0.25, "type": "inter_cluster", "style": "solid"}], ["Riparian Corridors", "Mitigation Banking", {"weight": -0.2, "confidence": 0.45999999999999996, "type": "inter_cluster", "style": "solid"}], ["Fish Management", "Water Use Designations", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Value", "Habitat Management", {"weight": 0.8, "confidence": 0.6200000000000001, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Value", "Treatment Systems", {"weight": 0.75, "confidence": 0.575, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Value", "Species Protection", {"weight": 0.4, "confidence": 0.31, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Value", "Marine Ecosystems", {"weight": 0.4, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Function", "Habitat Management", {"weight": 0.2, "confidence": 0.47000000000000003, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Function", "Enforcement Actions", {"weight": 0.6, "confidence": 0.41, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Function", "Marine Ecosystems", {"weight": 0.6666666666666666, "confidence": 0.5333333333333333, "type": "inter_cluster", "style": "solid"}], ["Ecosystem Function", "Ecosystem Value", {"weight": 0.25, "confidence": 0.2125, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Marine Ecosystems": [["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Marine Ecosystems", "node_size": 10, "label": "marine resource management"}], ["wetlands", {"concepts": "wetlands", "type": "concept", "cluster": "Marine Ecosystems", "node_size": 10, "label": "wetlands"}], ["seagrass beds", {"concepts": "seagrass beds", "type": "concept", "cluster": "Marine Ecosystems", "node_size": 10, "label": "seagrass beds"}]], "Regulatory Framework": [["epa", {"concepts": "epa", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "epa"}], ["federal standards", {"concepts": "federal standards", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "federal standards"}], ["army corps", {"concepts": "army corps", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "army corps"}], ["state standards", {"concepts": "state standards", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "state standards"}], ["submerged aquatic vegetation", {"concepts": "submerged aquatic vegetation", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "submerged aquatic vegetation"}], ["permits", {"concepts": "permits", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "permits"}], ["after the fact permits", {"concepts": "after the fact permits", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "after the fact permits"}], ["enactment", {"concepts": "enactment", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "enactment"}], ["policy", {"concepts": "policy", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "policy"}], ["management policies", {"concepts": "management policies", "type": "concept", "cluster": "Regulatory Framework", "node_size": 10, "label": "management policies"}]], "Enforcement Actions": [["habitat enforcement", {"concepts": "habitat enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "habitat enforcement"}], ["federal enforcement", {"concepts": "federal enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "federal enforcement"}], ["enforcement disconnect", {"concepts": "enforcement disconnect", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "enforcement disconnect"}], ["epa enforcement", {"concepts": "epa enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "epa enforcement"}], ["enforcement", {"concepts": "enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "enforcement"}], ["enforcement plans", {"concepts": "enforcement plans", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "enforcement plans"}], ["litigation", {"concepts": "litigation", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "litigation"}], ["court involvement", {"concepts": "court involvement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "court involvement"}], ["regulatory enforcement", {"concepts": "regulatory enforcement", "type": "concept", "cluster": "Enforcement Actions", "node_size": 10, "label": "regulatory enforcement"}]], "Habitat Management": [["habitat forming", {"concepts": "habitat forming", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat forming"}], ["habitat", {"concepts": "habitat", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat"}], ["habitat protection", {"concepts": "habitat protection", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat protection"}], ["habitat functionality", {"concepts": "habitat functionality", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat functionality"}], ["habitat diversity", {"concepts": "habitat diversity", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat diversity"}], ["protected species habitat", {"concepts": "protected species habitat", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "protected species habitat"}], ["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "habitat forming species"}], ["access habitats", {"concepts": "access habitats", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "access habitats"}], ["restoration", {"concepts": "restoration", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "restoration"}], ["fragmentation", {"concepts": "fragmentation", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "fragmentation"}], ["degradation", {"concepts": "degradation", "type": "concept", "cluster": "Habitat Management", "node_size": 10, "label": "degradation"}]], "Species Protection": [["species conservation concern", {"concepts": "species conservation concern", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "species conservation concern"}], ["conservation concern", {"concepts": "conservation concern", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "conservation concern"}], ["sensitive species", {"concepts": "sensitive species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "sensitive species"}], ["protected species", {"concepts": "protected species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "protected species"}], ["listed species", {"concepts": "listed species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "listed species"}], ["delisting processes", {"concepts": "delisting processes", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "delisting processes"}], ["poster child species", {"concepts": "poster child species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "poster child species"}], ["keystone species", {"concepts": "keystone species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "keystone species"}], ["supporting species", {"concepts": "supporting species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "supporting species"}], ["species protection", {"concepts": "species protection", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "species protection"}], ["species", {"concepts": "species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "species"}], ["indicative species", {"concepts": "indicative species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "indicative species"}], ["invasive species", {"concepts": "invasive species", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "invasive species"}], ["native vegetation", {"concepts": "native vegetation", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "native vegetation"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "harmful organisms"}], ["organisms", {"concepts": "organisms", "type": "concept", "cluster": "Species Protection", "node_size": 10, "label": "organisms"}]], "Mitigation Banking": [["mitigation credits", {"concepts": "mitigation credits", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "mitigation credits"}], ["development credits", {"concepts": "development credits", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "development credits"}], ["mitigation banks", {"concepts": "mitigation banks", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "mitigation banks"}], ["improvement plans", {"concepts": "improvement plans", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "improvement plans"}], ["incentivization", {"concepts": "incentivization", "type": "concept", "cluster": "Mitigation Banking", "node_size": 10, "label": "incentivization"}]], "Public Data Collection": [["public engagement", {"concepts": "public engagement", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "public engagement"}], ["interview process", {"concepts": "interview process", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "interview process"}], ["waterkeeper alliance", {"concepts": "waterkeeper alliance", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "waterkeeper alliance"}], ["audubon society", {"concepts": "audubon society", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "audubon society"}], ["surveys", {"concepts": "surveys", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "surveys"}], ["habitat surveys", {"concepts": "habitat surveys", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "habitat surveys"}], ["citizen scientists", {"concepts": "citizen scientists", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "citizen scientists"}], ["public species counts", {"concepts": "public species counts", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "public species counts"}], ["species counts", {"concepts": "species counts", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "species counts"}], ["public data", {"concepts": "public data", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "public data"}], ["data collection", {"concepts": "data collection", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "data collection"}], ["biodiversity data", {"concepts": "biodiversity data", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "biodiversity data"}], ["apps", {"concepts": "apps", "type": "concept", "cluster": "Public Data Collection", "node_size": 10, "label": "apps"}]], "Water Use Designations": [["swimming designation", {"concepts": "swimming designation", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "swimming designation"}], ["industrial uses", {"concepts": "industrial uses", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "industrial uses"}], ["recreational swimming", {"concepts": "recreational swimming", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "recreational swimming"}], ["wildlife propagation", {"concepts": "wildlife propagation", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "wildlife propagation"}], ["migrations", {"concepts": "migrations", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "migrations"}], ["seasonality", {"concepts": "seasonality", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "seasonality"}], ["urbanized wildlife interactions", {"concepts": "urbanized wildlife interactions", "type": "concept", "cluster": "Water Use Designations", "node_size": 10, "label": "urbanized wildlife interactions"}]], "Water Quality Protection": [["filtration", {"concepts": "filtration", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "filtration"}], ["gallons", {"concepts": "gallons", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "gallons"}], ["outfall", {"concepts": "outfall", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "outfall"}], ["mobile bay", {"concepts": "mobile bay", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "mobile bay"}], ["workshop tool", {"concepts": "workshop tool", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "workshop tool"}], ["staff scientist", {"concepts": "staff scientist", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "staff scientist"}], ["jurisdictional protection", {"concepts": "jurisdictional protection", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "jurisdictional protection"}], ["threshold", {"concepts": "threshold", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "threshold"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "biodiversity"}], ["protections", {"concepts": "protections", "type": "concept", "cluster": "Water Quality Protection", "node_size": 10, "label": "protections"}]], "Regulatory Management": [["biodiversity management", {"concepts": "biodiversity management", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "biodiversity management"}], ["designations", {"concepts": "designations", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "designations"}], ["regulatory agencies", {"concepts": "regulatory agencies", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "regulatory agencies"}], ["development", {"concepts": "development", "type": "concept", "cluster": "Regulatory Management", "node_size": 10, "label": "development"}]], "Water Quality Management": [["water quality", {"concepts": "water quality", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality"}], ["water quality thresholds", {"concepts": "water quality thresholds", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality thresholds"}], ["water quality monitoring", {"concepts": "water quality monitoring", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality monitoring"}], ["water quality enforcement", {"concepts": "water quality enforcement", "type": "concept", "cluster": "Water Quality Management", "node_size": 10, "label": "water quality enforcement"}]], "Treatment Systems": [["water improvement plans", {"concepts": "water improvement plans", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "water improvement plans"}], ["water improvement", {"concepts": "water improvement", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "water improvement"}], ["wastewater treatment", {"concepts": "wastewater treatment", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "wastewater treatment"}], ["effluent", {"concepts": "effluent", "type": "concept", "cluster": "Treatment Systems", "node_size": 10, "label": "effluent"}]], "Water Bodies": [["coastal waters", {"concepts": "coastal waters", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "coastal waters"}], ["tributary waters", {"concepts": "tributary waters", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "tributary waters"}], ["waterways", {"concepts": "waterways", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "waterways"}], ["impaired waterways", {"concepts": "impaired waterways", "type": "concept", "cluster": "Water Bodies", "node_size": 10, "label": "impaired waterways"}]], "Restoration Efforts": [["pollution intervention", {"concepts": "pollution intervention", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "pollution intervention"}], ["oyster restoration", {"concepts": "oyster restoration", "type": "concept", "cluster": "Restoration Efforts", "node_size": 10, "label": "oyster restoration"}]], "Riparian Corridors": [["corridors", {"concepts": "corridors", "type": "concept", "cluster": "Riparian Corridors", "node_size": 10, "label": "corridors"}], ["riparian", {"concepts": "riparian", "type": "concept", "cluster": "Riparian Corridors", "node_size": 10, "label": "riparian"}], ["riparian bank", {"concepts": "riparian bank", "type": "concept", "cluster": "Riparian Corridors", "node_size": 10, "label": "riparian bank"}]], "Fish Management": [["fish propagation", {"concepts": "fish propagation", "type": "concept", "cluster": "Fish Management", "node_size": 10, "label": "fish propagation"}], ["fish consumption", {"concepts": "fish consumption", "type": "concept", "cluster": "Fish Management", "node_size": 10, "label": "fish consumption"}], ["fishing designation", {"concepts": "fishing designation", "type": "concept", "cluster": "Fish Management", "node_size": 10, "label": "fishing designation"}]], "Ecosystem Value": [["ecological value", {"concepts": "ecological value", "type": "concept", "cluster": "Ecosystem Value", "node_size": 10, "label": "ecological value"}], ["ecosystem diversity", {"concepts": "ecosystem diversity", "type": "concept", "cluster": "Ecosystem Value", "node_size": 10, "label": "ecosystem diversity"}], ["ecosystem resources", {"concepts": "ecosystem resources", "type": "concept", "cluster": "Ecosystem Value", "node_size": 10, "label": "ecosystem resources"}]], "Ecosystem Function": [["ecosystem function", {"concepts": "ecosystem function", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "ecosystem function"}], ["ecosystem components", {"concepts": "ecosystem components", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "ecosystem components"}], ["restoration ecologist", {"concepts": "restoration ecologist", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "restoration ecologist"}], ["food webs", {"concepts": "food webs", "type": "concept", "cluster": "Ecosystem Function", "node_size": 10, "label": "food webs"}]]};
        const clusterEdges = {"Marine Ecosystems": [], "Regulatory Framework": [], "Enforcement Actions": [], "Habitat Management": [], "Species Protection": [], "Mitigation Banking": [], "Public Data Collection": [], "Water Use Designations": [], "Water Quality Protection": [], "Regulatory Management": [], "Water Quality Management": [], "Treatment Systems": [], "Water Bodies": [], "Restoration Efforts": [], "Riparian Corridors": [], "Fish Management": [], "Ecosystem Value": [], "Ecosystem Function": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

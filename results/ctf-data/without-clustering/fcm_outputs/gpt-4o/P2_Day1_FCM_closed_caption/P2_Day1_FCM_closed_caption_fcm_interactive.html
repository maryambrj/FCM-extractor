
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"semi-structured interview": {"concepts": "semi-structured interview", "concept_list": ["semi-structured interview"], "type": "cluster", "node_size": 18, "label": "semi-structured interview"}, "communication": {"concepts": "communication", "concept_list": ["communication"], "type": "cluster", "node_size": 18, "label": "communication"}, "prior knowledge": {"concepts": "prior knowledge", "concept_list": ["prior knowledge"], "type": "cluster", "node_size": 18, "label": "prior knowledge"}, "data collection": {"concepts": "data collection", "concept_list": ["data collection"], "type": "cluster", "node_size": 18, "label": "data collection"}, "full exploitation": {"concepts": "full exploitation", "concept_list": ["full exploitation"], "type": "cluster", "node_size": 18, "label": "full exploitation"}, "directed graph": {"concepts": "directed graph", "concept_list": ["directed graph"], "type": "cluster", "node_size": 18, "label": "directed graph"}, "patient": {"concepts": "patient", "concept_list": ["patient"], "type": "cluster", "node_size": 18, "label": "patient"}, "readable": {"concepts": "readable", "concept_list": ["readable"], "type": "cluster", "node_size": 18, "label": "readable"}, "encryption": {"concepts": "encryption", "concept_list": ["encryption"], "type": "cluster", "node_size": 18, "label": "encryption"}, "physical interface": {"concepts": "physical interface", "concept_list": ["physical interface"], "type": "cluster", "node_size": 18, "label": "physical interface"}, "interest determination": {"concepts": "interest determination", "concept_list": ["interest determination"], "type": "cluster", "node_size": 18, "label": "interest determination"}, "labels": {"concepts": "labels", "concept_list": ["labels"], "type": "cluster", "node_size": 18, "label": "labels"}, "physical tools": {"concepts": "physical tools", "concept_list": ["physical tools"], "type": "cluster", "node_size": 18, "label": "physical tools"}, "identification": {"concepts": "identification", "concept_list": ["identification"], "type": "cluster", "node_size": 18, "label": "identification"}, "layout": {"concepts": "layout", "concept_list": ["layout"], "type": "cluster", "node_size": 18, "label": "layout"}, "specific purpose": {"concepts": "specific purpose", "concept_list": ["specific purpose"], "type": "cluster", "node_size": 18, "label": "specific purpose"}, "system understanding": {"concepts": "system understanding", "concept_list": ["system understanding"], "type": "cluster", "node_size": 18, "label": "system understanding"}, "layer of security": {"concepts": "layer of security", "concept_list": ["layer of security"], "type": "cluster", "node_size": 18, "label": "layer of security"}, "reverse engineered": {"concepts": "reverse engineered", "concept_list": ["reverse engineered"], "type": "cluster", "node_size": 18, "label": "reverse engineered"}, "security systems": {"concepts": "security systems", "concept_list": ["security systems"], "type": "cluster", "node_size": 18, "label": "security systems"}, "collect data": {"concepts": "collect data", "concept_list": ["collect data"], "type": "cluster", "node_size": 18, "label": "collect data"}, "negative": {"concepts": "negative", "concept_list": ["negative"], "type": "cluster", "node_size": 18, "label": "negative"}, "access": {"concepts": "access", "concept_list": ["access"], "type": "cluster", "node_size": 18, "label": "access"}, "granularity": {"concepts": "granularity", "concept_list": ["granularity"], "type": "cluster", "node_size": 18, "label": "granularity"}, "undocumented": {"concepts": "undocumented", "concept_list": ["undocumented"], "type": "cluster", "node_size": 18, "label": "undocumented"}, "partial access": {"concepts": "partial access", "concept_list": ["partial access"], "type": "cluster", "node_size": 18, "label": "partial access"}, "flag capture": {"concepts": "flag capture", "concept_list": ["flag capture"], "type": "cluster", "node_size": 18, "label": "flag capture"}, "firmware": {"concepts": "firmware", "concept_list": ["firmware"], "type": "cluster", "node_size": 18, "label": "firmware"}, "framework": {"concepts": "framework", "concept_list": ["framework"], "type": "cluster", "node_size": 18, "label": "framework"}, "computer visualization tool": {"concepts": "computer visualization tool", "concept_list": ["computer visualization tool"], "type": "cluster", "node_size": 18, "label": "computer visualization tool"}, "successfully id": {"concepts": "successfully id", "concept_list": ["successfully id"], "type": "cluster", "node_size": 18, "label": "successfully id"}, "data availability": {"concepts": "data availability", "concept_list": ["data availability"], "type": "cluster", "node_size": 18, "label": "data availability"}, "additional security": {"concepts": "additional security", "concept_list": ["additional security"], "type": "cluster", "node_size": 18, "label": "additional security"}, "impediments": {"concepts": "impediments", "concept_list": ["impediments"], "type": "cluster", "node_size": 18, "label": "impediments"}, "overview": {"concepts": "overview", "concept_list": ["overview"], "type": "cluster", "node_size": 18, "label": "overview"}, "interfacing": {"concepts": "interfacing", "concept_list": ["interfacing"], "type": "cluster", "node_size": 18, "label": "interfacing"}, "physical requirements": {"concepts": "physical requirements", "concept_list": ["physical requirements"], "type": "cluster", "node_size": 18, "label": "physical requirements"}, "protocols": {"concepts": "protocols", "concept_list": ["protocols"], "type": "cluster", "node_size": 18, "label": "protocols"}, "physical interfacing": {"concepts": "physical interfacing", "concept_list": ["physical interfacing"], "type": "cluster", "node_size": 18, "label": "physical interfacing"}, "power filtering": {"concepts": "power filtering", "concept_list": ["power filtering"], "type": "cluster", "node_size": 18, "label": "power filtering"}, "obfuscation": {"concepts": "obfuscation", "concept_list": ["obfuscation"], "type": "cluster", "node_size": 18, "label": "obfuscation"}, "bespoke system": {"concepts": "bespoke system", "concept_list": ["bespoke system"], "type": "cluster", "node_size": 18, "label": "bespoke system"}, "tool software": {"concepts": "tool software", "concept_list": ["tool software"], "type": "cluster", "node_size": 18, "label": "tool software"}, "features": {"concepts": "features", "concept_list": ["features"], "type": "cluster", "node_size": 18, "label": "features"}, "standardized interfaces": {"concepts": "standardized interfaces", "concept_list": ["standardized interfaces"], "type": "cluster", "node_size": 18, "label": "standardized interfaces"}, "missing data": {"concepts": "missing data", "concept_list": ["missing data"], "type": "cluster", "node_size": 18, "label": "missing data"}, "success": {"concepts": "success", "concept_list": ["success"], "type": "cluster", "node_size": 18, "label": "success"}, "difficulties": {"concepts": "difficulties", "concept_list": ["difficulties"], "type": "cluster", "node_size": 18, "label": "difficulties"}, "security measures": {"concepts": "security measures", "concept_list": ["security measures"], "type": "cluster", "node_size": 18, "label": "security measures"}, "fuzzy cognitive map": {"concepts": "fuzzy cognitive map", "concept_list": ["fuzzy cognitive map"], "type": "cluster", "node_size": 18, "label": "fuzzy cognitive map"}, "knowledge": {"concepts": "knowledge", "concept_list": ["knowledge"], "type": "cluster", "node_size": 18, "label": "knowledge"}, "decisions": {"concepts": "decisions", "concept_list": ["decisions"], "type": "cluster", "node_size": 18, "label": "decisions"}, "supporting hardware": {"concepts": "supporting hardware", "concept_list": ["supporting hardware"], "type": "cluster", "node_size": 18, "label": "supporting hardware"}, "data sheets": {"concepts": "data sheets", "concept_list": ["data sheets"], "type": "cluster", "node_size": 18, "label": "data sheets"}, "output": {"concepts": "output", "concept_list": ["output"], "type": "cluster", "node_size": 18, "label": "output"}, "data collection failure": {"concepts": "data collection failure", "concept_list": ["data collection failure"], "type": "cluster", "node_size": 18, "label": "data collection failure"}, "security mechanisms": {"concepts": "security mechanisms", "concept_list": ["security mechanisms"], "type": "cluster", "node_size": 18, "label": "security mechanisms"}, "reverse engineering": {"concepts": "reverse engineering", "concept_list": ["reverse engineering"], "type": "cluster", "node_size": 18, "label": "reverse engineering"}, "node": {"concepts": "node", "concept_list": ["node"], "type": "cluster", "node_size": 18, "label": "node"}, "mislabeling": {"concepts": "mislabeling", "concept_list": ["mislabeling"], "type": "cluster", "node_size": 18, "label": "mislabeling"}, "target": {"concepts": "target", "concept_list": ["target"], "type": "cluster", "node_size": 18, "label": "target"}, "data protocol": {"concepts": "data protocol", "concept_list": ["data protocol"], "type": "cluster", "node_size": 18, "label": "data protocol"}, "environment": {"concepts": "environment", "concept_list": ["environment"], "type": "cluster", "node_size": 18, "label": "environment"}, "security": {"concepts": "security", "concept_list": ["security"], "type": "cluster", "node_size": 18, "label": "security"}, "languages": {"concepts": "languages", "concept_list": ["languages"], "type": "cluster", "node_size": 18, "label": "languages"}, "matrix": {"concepts": "matrix", "concept_list": ["matrix"], "type": "cluster", "node_size": 18, "label": "matrix"}, "subcomponents": {"concepts": "subcomponents", "concept_list": ["subcomponents"], "type": "cluster", "node_size": 18, "label": "subcomponents"}, "steps to success": {"concepts": "steps to success", "concept_list": ["steps to success"], "type": "cluster", "node_size": 18, "label": "steps to success"}, "participant": {"concepts": "participant", "concept_list": ["participant"], "type": "cluster", "node_size": 18, "label": "participant"}, "understandable": {"concepts": "understandable", "concept_list": ["understandable"], "type": "cluster", "node_size": 18, "label": "understandable"}, "re": {"concepts": "re", "concept_list": ["re"], "type": "cluster", "node_size": 18, "label": "re"}, "security information": {"concepts": "security information", "concept_list": ["security information"], "type": "cluster", "node_size": 18, "label": "security information"}, "functional interest": {"concepts": "functional interest", "concept_list": ["functional interest"], "type": "cluster", "node_size": 18, "label": "functional interest"}, "supporting role": {"concepts": "supporting role", "concept_list": ["supporting role"], "type": "cluster", "node_size": 18, "label": "supporting role"}, "beliefs": {"concepts": "beliefs", "concept_list": ["beliefs"], "type": "cluster", "node_size": 18, "label": "beliefs"}, "failure": {"concepts": "failure", "concept_list": ["failure"], "type": "cluster", "node_size": 18, "label": "failure"}, "factors": {"concepts": "factors", "concept_list": ["factors"], "type": "cluster", "node_size": 18, "label": "factors"}, "challenges": {"concepts": "challenges", "concept_list": ["challenges"], "type": "cluster", "node_size": 18, "label": "challenges"}, "subject matter expert": {"concepts": "subject matter expert", "concept_list": ["subject matter expert"], "type": "cluster", "node_size": 18, "label": "subject matter expert"}, "strategies": {"concepts": "strategies", "concept_list": ["strategies"], "type": "cluster", "node_size": 18, "label": "strategies"}, "security perspective": {"concepts": "security perspective", "concept_list": ["security perspective"], "type": "cluster", "node_size": 18, "label": "security perspective"}, "node placement.": {"concepts": "node placement.", "concept_list": ["node placement."], "type": "cluster", "node_size": 18, "label": "node placement."}, "testing device": {"concepts": "testing device", "concept_list": ["testing device"], "type": "cluster", "node_size": 18, "label": "testing device"}, "key components": {"concepts": "key components", "concept_list": ["key components"], "type": "cluster", "node_size": 18, "label": "key components"}, "schedules": {"concepts": "schedules", "concept_list": ["schedules"], "type": "cluster", "node_size": 18, "label": "schedules"}, "libraries": {"concepts": "libraries", "concept_list": ["libraries"], "type": "cluster", "node_size": 18, "label": "libraries"}, "process": {"concepts": "process", "concept_list": ["process"], "type": "cluster", "node_size": 18, "label": "process"}, "intuition": {"concepts": "intuition", "concept_list": ["intuition"], "type": "cluster", "node_size": 18, "label": "intuition"}, "exploit": {"concepts": "exploit", "concept_list": ["exploit"], "type": "cluster", "node_size": 18, "label": "exploit"}, "prior information": {"concepts": "prior information", "concept_list": ["prior information"], "type": "cluster", "node_size": 18, "label": "prior information"}, "data sheet": {"concepts": "data sheet", "concept_list": ["data sheet"], "type": "cluster", "node_size": 18, "label": "data sheet"}, "screen sharing": {"concepts": "screen sharing", "concept_list": ["screen sharing"], "type": "cluster", "node_size": 18, "label": "screen sharing"}, "granularity.": {"concepts": "granularity.", "concept_list": ["granularity."], "type": "cluster", "node_size": 18, "label": "granularity."}, "functionality of interest": {"concepts": "functionality of interest", "concept_list": ["functionality of interest"], "type": "cluster", "node_size": 18, "label": "functionality of interest"}, "iterative process": {"concepts": "iterative process", "concept_list": ["iterative process"], "type": "cluster", "node_size": 18, "label": "iterative process"}, "exploitation": {"concepts": "exploitation", "concept_list": ["exploitation"], "type": "cluster", "node_size": 18, "label": "exploitation"}, "protections": {"concepts": "protections", "concept_list": ["protections"], "type": "cluster", "node_size": 18, "label": "protections"}, "interface": {"concepts": "interface", "concept_list": ["interface"], "type": "cluster", "node_size": 18, "label": "interface"}, "fcm exercise": {"concepts": "fcm exercise", "concept_list": ["fcm exercise"], "type": "cluster", "node_size": 18, "label": "fcm exercise"}, "analysis": {"concepts": "analysis", "concept_list": ["analysis"], "type": "cluster", "node_size": 18, "label": "analysis"}, "capabilities": {"concepts": "capabilities", "concept_list": ["capabilities"], "type": "cluster", "node_size": 18, "label": "capabilities"}, "level of access": {"concepts": "level of access", "concept_list": ["level of access"], "type": "cluster", "node_size": 18, "label": "level of access"}, "meaningful information": {"concepts": "meaningful information", "concept_list": ["meaningful information"], "type": "cluster", "node_size": 18, "label": "meaningful information"}, "positive relationship": {"concepts": "positive relationship", "concept_list": ["positive relationship"], "type": "cluster", "node_size": 18, "label": "positive relationship"}, "connector": {"concepts": "connector", "concept_list": ["connector"], "type": "cluster", "node_size": 18, "label": "connector"}, "failure to obtain access": {"concepts": "failure to obtain access", "concept_list": ["failure to obtain access"], "type": "cluster", "node_size": 18, "label": "failure to obtain access"}, "software component": {"concepts": "software component", "concept_list": ["software component"], "type": "cluster", "node_size": 18, "label": "software component"}, "privileged access": {"concepts": "privileged access", "concept_list": ["privileged access"], "type": "cluster", "node_size": 18, "label": "privileged access"}, "time-wasting": {"concepts": "time-wasting", "concept_list": ["time-wasting"], "type": "cluster", "node_size": 18, "label": "time-wasting"}, "cyber attacks": {"concepts": "cyber attacks", "concept_list": ["cyber attacks"], "type": "cluster", "node_size": 18, "label": "cyber attacks"}, "positive": {"concepts": "positive", "concept_list": ["positive"], "type": "cluster", "node_size": 18, "label": "positive"}, "functionality": {"concepts": "functionality", "concept_list": ["functionality"], "type": "cluster", "node_size": 18, "label": "functionality"}, "common protections": {"concepts": "common protections", "concept_list": ["common protections"], "type": "cluster", "node_size": 18, "label": "common protections"}, "lack of documentation": {"concepts": "lack of documentation", "concept_list": ["lack of documentation"], "type": "cluster", "node_size": 18, "label": "lack of documentation"}, "access goals": {"concepts": "access goals", "concept_list": ["access goals"], "type": "cluster", "node_size": 18, "label": "access goals"}, "key items": {"concepts": "key items", "concept_list": ["key items"], "type": "cluster", "node_size": 18, "label": "key items"}, "experimenter": {"concepts": "experimenter", "concept_list": ["experimenter"], "type": "cluster", "node_size": 18, "label": "experimenter"}, "information acquisition": {"concepts": "information acquisition", "concept_list": ["information acquisition"], "type": "cluster", "node_size": 18, "label": "information acquisition"}, "steps": {"concepts": "steps", "concept_list": ["steps"], "type": "cluster", "node_size": 18, "label": "steps"}, "distractions": {"concepts": "distractions", "concept_list": ["distractions"], "type": "cluster", "node_size": 18, "label": "distractions"}};
        const conceptData = {};
        const interClusterEdges = [["semi-structured interview", "subject matter expert", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["prior knowledge", "success", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["prior knowledge", "physical tools", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["data collection", "decisions", {"weight": 0.5, "confidence": 0.425, "type": "inter_cluster", "style": "solid"}], ["full exploitation", "physical tools", {"weight": 1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["full exploitation", "lack of documentation", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["readable", "languages", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["readable", "data collection", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["readable", "failure to obtain access", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["readable", "key components", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["readable", "additional security", {"weight": -1.0, "confidence": 0.55, "type": "inter_cluster", "style": "solid"}], ["encryption", "failure", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["physical interface", "partial access", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["physical interface", "mislabeling", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["physical interface", "supporting role", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["interest determination", "power filtering", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["interest determination", "security information", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["labels", "data sheet", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["labels", "firmware", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["physical tools", "functionality of interest", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["identification", "software component", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["identification", "privileged access", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["identification", "layout", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["layout", "collect data", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["specific purpose", "reverse engineered", {"weight": 1.0, "confidence": 0.6624999999999999, "type": "inter_cluster", "style": "solid"}], ["specific purpose", "mislabeling", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["system understanding", "failure", {"weight": -0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["reverse engineered", "capabilities", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["reverse engineered", "partial access", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["security systems", "encryption", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["collect data", "schedules", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["granularity", "common protections", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["partial access", "functionality of interest", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["flag capture", "challenges", {"weight": -0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["firmware", "data sheet", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["framework", "re", {"weight": 0.5, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["computer visualization tool", "success", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["computer visualization tool", "positive relationship", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["computer visualization tool", "data sheets", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["computer visualization tool", "physical interfacing", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["successfully id", "re", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["successfully id", "impediments", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["data availability", "interface", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["additional security", "data availability", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["impediments", "access", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["overview", "key items", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["protocols", "standardized interfaces", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["physical interfacing", "interfacing", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["obfuscation", "lack of documentation", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["obfuscation", "communication", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["bespoke system", "failure to obtain access", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["bespoke system", "patient", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["tool software", "features", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["tool software", "matrix", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["tool software", "fcm exercise", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["features", "prior knowledge", {"weight": 0.6666666666666666, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["features", "common protections", {"weight": 0.5, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["standardized interfaces", "protocols", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["standardized interfaces", "impediments", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["missing data", "understandable", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["difficulties", "access", {"weight": -1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["difficulties", "failure", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["fuzzy cognitive map", "strategies", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["knowledge", "framework", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["knowledge", "granularity", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["knowledge", "mislabeling", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["decisions", "common protections", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["decisions", "protections", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["supporting hardware", "labels", {"weight": 0.6666666666666666, "confidence": 0.39999999999999997, "type": "inter_cluster", "style": "solid"}], ["output", "readable", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["data collection failure", "meaningful information", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["data collection failure", "information acquisition", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["data collection failure", "common protections", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["security mechanisms", "node", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["security mechanisms", "data collection", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["reverse engineering", "screen sharing", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["node", "time-wasting", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["target", "security perspective", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["target", "obfuscation", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["environment", "languages", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["security", "interface", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["security", "layer of security", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["steps to success", "reverse engineering", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["steps to success", "semi-structured interview", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["steps to success", "positive", {"weight": 0.5, "confidence": 0.4, "type": "inter_cluster", "style": "solid"}], ["steps to success", "challenges", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["participant", "process", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["participant", "readable", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["participant", "exploitation", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["beliefs", "readable", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["failure", "negative", {"weight": 0.6666666666666666, "confidence": 0.5499999999999999, "type": "inter_cluster", "style": "solid"}], ["failure", "exploit", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["failure", "environment", {"weight": -0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["factors", "computer visualization tool", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["factors", "features", {"weight": 0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["challenges", "tool software", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["subject matter expert", "key items", {"weight": 1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["subject matter expert", "power filtering", {"weight": 0.5, "confidence": 0.325, "type": "inter_cluster", "style": "solid"}], ["security perspective", "functionality of interest", {"weight": 1.0, "confidence": 0.675, "type": "inter_cluster", "style": "solid"}], ["node placement.", "analysis", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["testing device", "prior knowledge", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["testing device", "negative", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["schedules", "steps", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["process", "intuition", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["intuition", "full exploitation", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["intuition", "undocumented", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["intuition", "firmware", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["exploit", "security measures", {"weight": -1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["exploit", "mislabeling", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["prior information", "output", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["data sheet", "tool software", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["data sheet", "directed graph", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["screen sharing", "identification", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["granularity.", "difficulties", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["functionality of interest", "overview", {"weight": 1.0, "confidence": 0.675, "type": "inter_cluster", "style": "solid"}], ["functionality of interest", "process", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["iterative process", "readable", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["exploitation", "additional security", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["protections", "libraries", {"weight": 1.0, "confidence": 0.6499999999999999, "type": "inter_cluster", "style": "solid"}], ["protections", "failure", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["protections", "interfacing", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["fcm exercise", "semi-structured interview", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["fcm exercise", "process", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["fcm exercise", "protections", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["fcm exercise", "challenges", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["fcm exercise", "key components", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["fcm exercise", "target", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["analysis", "subcomponents", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["analysis", "identification", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["capabilities", "reverse engineered", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["capabilities", "functional interest", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["level of access", "success", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["meaningful information", "impediments", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["positive relationship", "collect data", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["positive relationship", "data protocol", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["connector", "interfacing", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["connector", "additional security", {"weight": 0.5, "confidence": 0.325, "type": "inter_cluster", "style": "solid"}], ["connector", "process", {"weight": 0.5, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["failure to obtain access", "analysis", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["failure to obtain access", "obfuscation", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["privileged access", "patient", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["privileged access", "target", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["cyber attacks", "data availability", {"weight": -1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["cyber attacks", "meaningful information", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["positive", "physical requirements", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["functionality", "access goals", {"weight": 1.0, "confidence": 0.7749999999999999, "type": "inter_cluster", "style": "solid"}], ["functionality", "physical tools", {"weight": 1.0, "confidence": 0.675, "type": "inter_cluster", "style": "solid"}], ["common protections", "participant", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["lack of documentation", "identification", {"weight": -1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["experimenter", "undocumented", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["information acquisition", "data availability", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["information acquisition", "partial access", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["information acquisition", "success", {"weight": 1.0, "confidence": 0.8, "type": "inter_cluster", "style": "solid"}], ["steps", "flag capture", {"weight": 1.0, "confidence": 0.9, "type": "inter_cluster", "style": "solid"}], ["steps", "positive", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["distractions", "exploit", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>


<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Ecosystem Services": {"concepts": "marine mammals, fishing sector, fishermen, fishery sector, small-scale fisheries, fishing biomass, oyster farmers, fishery economics, fisheries, seabird management, single species fisheries management, fisheries economics, fisheries management, marine resource management, fisheries access", "concept_list": ["marine mammals", "fishing sector", "fishermen", "fishery sector", "small-scale fisheries", "fishing biomass", "oyster farmers", "fishery economics", "fisheries", "seabird management", "single species fisheries management", "fisheries economics", "fisheries management", "marine resource management", "fisheries access"], "type": "cluster", "node_size": 60, "label": "Ecosystem Services"}, "Water Resources": {"concepts": "food web, waterfront homeowners, conservation concern, qualitative binning, median, cultural benefits, wellbeing, aggregation, relationship weight, contaminants, endangered species, habitat destruction, ecotourism sector, conservation management, number of species, food security, endangered species management, damming, thesis chapter, lake victoria, average, habitat forming species, regional managers, ecosystem roles, stressors, historical context, biodiversity, data analysis, ecosystem services, wildlife survey, researchers, system dynamics, data collection, food benefits, flooding, environmental changes, economics, mental models, collective model, bins, harmful organisms, east africa, conservation concern species, nutrition, thematic coding framework, mixed method approaches, human wildlife conflict, ecosystem, species number, mental modeling, resource users, cultural recreation services, species-specific management, stakeholder influence, health, side projects, nutritional benefits, adjacency matrix, human wellbeing, ecotourism, income, stakeholders, master list, diversity of functions, mixed method, species diversity, unintended consequences, species traits, drought, invasive species, biodiversity management, unique concept, anthropogenic stressors, species of conservation concern, ecosystem relationships, tonle sap, trait diversity, toxins, connection, ngos, mental modeler, individual matrix, recreational benefits, food web supporting species, functional diversity", "concept_list": ["food web", "waterfront homeowners", "conservation concern", "qualitative binning", "median", "cultural benefits", "wellbeing", "aggregation", "relationship weight", "contaminants", "endangered species", "habitat destruction", "ecotourism sector", "conservation management", "number of species", "food security", "endangered species management", "damming", "thesis chapter", "lake victoria", "average", "habitat forming species", "regional managers", "ecosystem roles", "stressors", "historical context", "biodiversity", "data analysis", "ecosystem services", "wildlife survey", "researchers", "system dynamics", "data collection", "food benefits", "flooding", "environmental changes", "economics", "mental models", "collective model", "bins", "harmful organisms", "east africa", "conservation concern species", "nutrition", "thematic coding framework", "mixed method approaches", "human wildlife conflict", "ecosystem", "species number", "mental modeling", "resource users", "cultural recreation services", "species-specific management", "stakeholder influence", "health", "side projects", "nutritional benefits", "adjacency matrix", "human wellbeing", "ecotourism", "income", "stakeholders", "master list", "diversity of functions", "mixed method", "species diversity", "unintended consequences", "species traits", "drought", "invasive species", "biodiversity management", "unique concept", "anthropogenic stressors", "species of conservation concern", "ecosystem relationships", "tonle sap", "trait diversity", "toxins", "connection", "ngos", "mental modeler", "individual matrix", "recreational benefits", "food web supporting species", "functional diversity"], "type": "cluster", "node_size": 270, "label": "Water Resources"}, "Fisheries Management": {"concepts": "water quantity, aquatic ecosystems, water quality, river dolphins, river flow, water availability", "concept_list": ["water quantity", "aquatic ecosystems", "water quality", "river dolphins", "river flow", "water availability"], "type": "cluster", "node_size": 33, "label": "Fisheries Management"}};
        const conceptData = {"marine mammals": {"concepts": "marine mammals", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "marine mammals"}, "fishing sector": {"concepts": "fishing sector", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishing sector"}, "fishermen": {"concepts": "fishermen", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishermen"}, "fishery sector": {"concepts": "fishery sector", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishery sector"}, "small-scale fisheries": {"concepts": "small-scale fisheries", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "small-scale fisheries"}, "fishing biomass": {"concepts": "fishing biomass", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishing biomass"}, "oyster farmers": {"concepts": "oyster farmers", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "oyster farmers"}, "fishery economics": {"concepts": "fishery economics", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishery economics"}, "fisheries": {"concepts": "fisheries", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries"}, "seabird management": {"concepts": "seabird management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "seabird management"}, "single species fisheries management": {"concepts": "single species fisheries management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "single species fisheries management"}, "fisheries economics": {"concepts": "fisheries economics", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries economics"}, "fisheries management": {"concepts": "fisheries management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries management"}, "marine resource management": {"concepts": "marine resource management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "marine resource management"}, "fisheries access": {"concepts": "fisheries access", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries access"}, "food web": {"concepts": "food web", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food web"}, "waterfront homeowners": {"concepts": "waterfront homeowners", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "waterfront homeowners"}, "conservation concern": {"concepts": "conservation concern", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "conservation concern"}, "qualitative binning": {"concepts": "qualitative binning", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "qualitative binning"}, "median": {"concepts": "median", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "median"}, "cultural benefits": {"concepts": "cultural benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "cultural benefits"}, "wellbeing": {"concepts": "wellbeing", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "wellbeing"}, "aggregation": {"concepts": "aggregation", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "aggregation"}, "relationship weight": {"concepts": "relationship weight", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "relationship weight"}, "contaminants": {"concepts": "contaminants", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "contaminants"}, "endangered species": {"concepts": "endangered species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "endangered species"}, "habitat destruction": {"concepts": "habitat destruction", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "habitat destruction"}, "ecotourism sector": {"concepts": "ecotourism sector", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecotourism sector"}, "conservation management": {"concepts": "conservation management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "conservation management"}, "number of species": {"concepts": "number of species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "number of species"}, "food security": {"concepts": "food security", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food security"}, "endangered species management": {"concepts": "endangered species management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "endangered species management"}, "damming": {"concepts": "damming", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "damming"}, "thesis chapter": {"concepts": "thesis chapter", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "thesis chapter"}, "lake victoria": {"concepts": "lake victoria", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "lake victoria"}, "average": {"concepts": "average", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "average"}, "habitat forming species": {"concepts": "habitat forming species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "habitat forming species"}, "regional managers": {"concepts": "regional managers", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "regional managers"}, "ecosystem roles": {"concepts": "ecosystem roles", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem roles"}, "stressors": {"concepts": "stressors", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "stressors"}, "historical context": {"concepts": "historical context", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "historical context"}, "biodiversity": {"concepts": "biodiversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "biodiversity"}, "data analysis": {"concepts": "data analysis", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "data analysis"}, "ecosystem services": {"concepts": "ecosystem services", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem services"}, "wildlife survey": {"concepts": "wildlife survey", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "wildlife survey"}, "researchers": {"concepts": "researchers", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "researchers"}, "system dynamics": {"concepts": "system dynamics", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "system dynamics"}, "data collection": {"concepts": "data collection", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "data collection"}, "food benefits": {"concepts": "food benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food benefits"}, "flooding": {"concepts": "flooding", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "flooding"}, "environmental changes": {"concepts": "environmental changes", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "environmental changes"}, "economics": {"concepts": "economics", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "economics"}, "mental models": {"concepts": "mental models", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mental models"}, "collective model": {"concepts": "collective model", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "collective model"}, "bins": {"concepts": "bins", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "bins"}, "harmful organisms": {"concepts": "harmful organisms", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "harmful organisms"}, "east africa": {"concepts": "east africa", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "east africa"}, "conservation concern species": {"concepts": "conservation concern species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "conservation concern species"}, "nutrition": {"concepts": "nutrition", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "nutrition"}, "thematic coding framework": {"concepts": "thematic coding framework", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "thematic coding framework"}, "mixed method approaches": {"concepts": "mixed method approaches", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mixed method approaches"}, "human wildlife conflict": {"concepts": "human wildlife conflict", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "human wildlife conflict"}, "ecosystem": {"concepts": "ecosystem", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem"}, "species number": {"concepts": "species number", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species number"}, "mental modeling": {"concepts": "mental modeling", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mental modeling"}, "resource users": {"concepts": "resource users", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "resource users"}, "cultural recreation services": {"concepts": "cultural recreation services", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "cultural recreation services"}, "species-specific management": {"concepts": "species-specific management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species-specific management"}, "stakeholder influence": {"concepts": "stakeholder influence", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "stakeholder influence"}, "health": {"concepts": "health", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "health"}, "side projects": {"concepts": "side projects", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "side projects"}, "nutritional benefits": {"concepts": "nutritional benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "nutritional benefits"}, "adjacency matrix": {"concepts": "adjacency matrix", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "adjacency matrix"}, "human wellbeing": {"concepts": "human wellbeing", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "human wellbeing"}, "ecotourism": {"concepts": "ecotourism", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecotourism"}, "income": {"concepts": "income", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "income"}, "stakeholders": {"concepts": "stakeholders", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "stakeholders"}, "master list": {"concepts": "master list", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "master list"}, "diversity of functions": {"concepts": "diversity of functions", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "diversity of functions"}, "mixed method": {"concepts": "mixed method", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mixed method"}, "species diversity": {"concepts": "species diversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species diversity"}, "unintended consequences": {"concepts": "unintended consequences", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "unintended consequences"}, "species traits": {"concepts": "species traits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species traits"}, "drought": {"concepts": "drought", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "drought"}, "invasive species": {"concepts": "invasive species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "invasive species"}, "biodiversity management": {"concepts": "biodiversity management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "biodiversity management"}, "unique concept": {"concepts": "unique concept", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "unique concept"}, "anthropogenic stressors": {"concepts": "anthropogenic stressors", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "anthropogenic stressors"}, "species of conservation concern": {"concepts": "species of conservation concern", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species of conservation concern"}, "ecosystem relationships": {"concepts": "ecosystem relationships", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem relationships"}, "tonle sap": {"concepts": "tonle sap", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "tonle sap"}, "trait diversity": {"concepts": "trait diversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "trait diversity"}, "toxins": {"concepts": "toxins", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "toxins"}, "connection": {"concepts": "connection", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "connection"}, "ngos": {"concepts": "ngos", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ngos"}, "mental modeler": {"concepts": "mental modeler", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mental modeler"}, "individual matrix": {"concepts": "individual matrix", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "individual matrix"}, "recreational benefits": {"concepts": "recreational benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "recreational benefits"}, "food web supporting species": {"concepts": "food web supporting species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food web supporting species"}, "functional diversity": {"concepts": "functional diversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "functional diversity"}, "water quantity": {"concepts": "water quantity", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water quantity"}, "aquatic ecosystems": {"concepts": "aquatic ecosystems", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "aquatic ecosystems"}, "water quality": {"concepts": "water quality", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water quality"}, "river dolphins": {"concepts": "river dolphins", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "river dolphins"}, "river flow": {"concepts": "river flow", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "river flow"}, "water availability": {"concepts": "water availability", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water availability"}};
        const interClusterEdges = [["Ecosystem Services", "Water Resources", {"weight": 0.6, "confidence": 0.48, "type": "inter_cluster", "style": "solid"}], ["Water Resources", "Ecosystem Services", {"weight": 0.4, "confidence": 0.32, "type": "inter_cluster", "style": "solid"}], ["Fisheries Management", "Ecosystem Services", {"weight": 0.6, "confidence": 0.44000000000000006, "type": "inter_cluster", "style": "solid"}], ["Fisheries Management", "Water Resources", {"weight": 0.4, "confidence": 0.33999999999999997, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Ecosystem Services": [["marine mammals", {"concepts": "marine mammals", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "marine mammals"}], ["fishing sector", {"concepts": "fishing sector", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishing sector"}], ["fishermen", {"concepts": "fishermen", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishermen"}], ["fishery sector", {"concepts": "fishery sector", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishery sector"}], ["small-scale fisheries", {"concepts": "small-scale fisheries", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "small-scale fisheries"}], ["fishing biomass", {"concepts": "fishing biomass", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishing biomass"}], ["oyster farmers", {"concepts": "oyster farmers", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "oyster farmers"}], ["fishery economics", {"concepts": "fishery economics", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fishery economics"}], ["fisheries", {"concepts": "fisheries", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries"}], ["seabird management", {"concepts": "seabird management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "seabird management"}], ["single species fisheries management", {"concepts": "single species fisheries management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "single species fisheries management"}], ["fisheries economics", {"concepts": "fisheries economics", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries economics"}], ["fisheries management", {"concepts": "fisheries management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries management"}], ["marine resource management", {"concepts": "marine resource management", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "marine resource management"}], ["fisheries access", {"concepts": "fisheries access", "type": "concept", "cluster": "Ecosystem Services", "node_size": 10, "label": "fisheries access"}]], "Water Resources": [["food web", {"concepts": "food web", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food web"}], ["waterfront homeowners", {"concepts": "waterfront homeowners", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "waterfront homeowners"}], ["conservation concern", {"concepts": "conservation concern", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "conservation concern"}], ["qualitative binning", {"concepts": "qualitative binning", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "qualitative binning"}], ["median", {"concepts": "median", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "median"}], ["cultural benefits", {"concepts": "cultural benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "cultural benefits"}], ["wellbeing", {"concepts": "wellbeing", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "wellbeing"}], ["aggregation", {"concepts": "aggregation", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "aggregation"}], ["relationship weight", {"concepts": "relationship weight", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "relationship weight"}], ["contaminants", {"concepts": "contaminants", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "contaminants"}], ["endangered species", {"concepts": "endangered species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "endangered species"}], ["habitat destruction", {"concepts": "habitat destruction", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "habitat destruction"}], ["ecotourism sector", {"concepts": "ecotourism sector", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecotourism sector"}], ["conservation management", {"concepts": "conservation management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "conservation management"}], ["number of species", {"concepts": "number of species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "number of species"}], ["food security", {"concepts": "food security", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food security"}], ["endangered species management", {"concepts": "endangered species management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "endangered species management"}], ["damming", {"concepts": "damming", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "damming"}], ["thesis chapter", {"concepts": "thesis chapter", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "thesis chapter"}], ["lake victoria", {"concepts": "lake victoria", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "lake victoria"}], ["average", {"concepts": "average", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "average"}], ["habitat forming species", {"concepts": "habitat forming species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "habitat forming species"}], ["regional managers", {"concepts": "regional managers", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "regional managers"}], ["ecosystem roles", {"concepts": "ecosystem roles", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem roles"}], ["stressors", {"concepts": "stressors", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "stressors"}], ["historical context", {"concepts": "historical context", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "historical context"}], ["biodiversity", {"concepts": "biodiversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "biodiversity"}], ["data analysis", {"concepts": "data analysis", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "data analysis"}], ["ecosystem services", {"concepts": "ecosystem services", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem services"}], ["wildlife survey", {"concepts": "wildlife survey", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "wildlife survey"}], ["researchers", {"concepts": "researchers", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "researchers"}], ["system dynamics", {"concepts": "system dynamics", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "system dynamics"}], ["data collection", {"concepts": "data collection", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "data collection"}], ["food benefits", {"concepts": "food benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food benefits"}], ["flooding", {"concepts": "flooding", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "flooding"}], ["environmental changes", {"concepts": "environmental changes", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "environmental changes"}], ["economics", {"concepts": "economics", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "economics"}], ["mental models", {"concepts": "mental models", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mental models"}], ["collective model", {"concepts": "collective model", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "collective model"}], ["bins", {"concepts": "bins", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "bins"}], ["harmful organisms", {"concepts": "harmful organisms", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "harmful organisms"}], ["east africa", {"concepts": "east africa", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "east africa"}], ["conservation concern species", {"concepts": "conservation concern species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "conservation concern species"}], ["nutrition", {"concepts": "nutrition", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "nutrition"}], ["thematic coding framework", {"concepts": "thematic coding framework", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "thematic coding framework"}], ["mixed method approaches", {"concepts": "mixed method approaches", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mixed method approaches"}], ["human wildlife conflict", {"concepts": "human wildlife conflict", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "human wildlife conflict"}], ["ecosystem", {"concepts": "ecosystem", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem"}], ["species number", {"concepts": "species number", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species number"}], ["mental modeling", {"concepts": "mental modeling", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mental modeling"}], ["resource users", {"concepts": "resource users", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "resource users"}], ["cultural recreation services", {"concepts": "cultural recreation services", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "cultural recreation services"}], ["species-specific management", {"concepts": "species-specific management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species-specific management"}], ["stakeholder influence", {"concepts": "stakeholder influence", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "stakeholder influence"}], ["health", {"concepts": "health", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "health"}], ["side projects", {"concepts": "side projects", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "side projects"}], ["nutritional benefits", {"concepts": "nutritional benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "nutritional benefits"}], ["adjacency matrix", {"concepts": "adjacency matrix", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "adjacency matrix"}], ["human wellbeing", {"concepts": "human wellbeing", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "human wellbeing"}], ["ecotourism", {"concepts": "ecotourism", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecotourism"}], ["income", {"concepts": "income", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "income"}], ["stakeholders", {"concepts": "stakeholders", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "stakeholders"}], ["master list", {"concepts": "master list", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "master list"}], ["diversity of functions", {"concepts": "diversity of functions", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "diversity of functions"}], ["mixed method", {"concepts": "mixed method", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mixed method"}], ["species diversity", {"concepts": "species diversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species diversity"}], ["unintended consequences", {"concepts": "unintended consequences", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "unintended consequences"}], ["species traits", {"concepts": "species traits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species traits"}], ["drought", {"concepts": "drought", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "drought"}], ["invasive species", {"concepts": "invasive species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "invasive species"}], ["biodiversity management", {"concepts": "biodiversity management", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "biodiversity management"}], ["unique concept", {"concepts": "unique concept", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "unique concept"}], ["anthropogenic stressors", {"concepts": "anthropogenic stressors", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "anthropogenic stressors"}], ["species of conservation concern", {"concepts": "species of conservation concern", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "species of conservation concern"}], ["ecosystem relationships", {"concepts": "ecosystem relationships", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ecosystem relationships"}], ["tonle sap", {"concepts": "tonle sap", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "tonle sap"}], ["trait diversity", {"concepts": "trait diversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "trait diversity"}], ["toxins", {"concepts": "toxins", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "toxins"}], ["connection", {"concepts": "connection", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "connection"}], ["ngos", {"concepts": "ngos", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "ngos"}], ["mental modeler", {"concepts": "mental modeler", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "mental modeler"}], ["individual matrix", {"concepts": "individual matrix", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "individual matrix"}], ["recreational benefits", {"concepts": "recreational benefits", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "recreational benefits"}], ["food web supporting species", {"concepts": "food web supporting species", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "food web supporting species"}], ["functional diversity", {"concepts": "functional diversity", "type": "concept", "cluster": "Water Resources", "node_size": 10, "label": "functional diversity"}]], "Fisheries Management": [["water quantity", {"concepts": "water quantity", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water quantity"}], ["aquatic ecosystems", {"concepts": "aquatic ecosystems", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "aquatic ecosystems"}], ["water quality", {"concepts": "water quality", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water quality"}], ["river dolphins", {"concepts": "river dolphins", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "river dolphins"}], ["river flow", {"concepts": "river flow", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "river flow"}], ["water availability", {"concepts": "water availability", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water availability"}]]};
        const clusterEdges = {"Ecosystem Services": [], "Water Resources": [], "Fisheries Management": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

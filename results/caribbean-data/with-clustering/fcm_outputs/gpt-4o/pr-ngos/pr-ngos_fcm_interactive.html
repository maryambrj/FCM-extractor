
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ‚Üê Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Fisheries Management": {"concepts": "federal government process, local mayor, public hearings, diving, sustainable fishing, long liners, meetings, climate change, vieques island, sustainable fishery regulations, pollution, sustainable fishery, part-time license, enforcement, commercial fishermen, caribbean fishery management council, tourism, infrastructure, violations, public input, sea level rise, swordfish, job opportunities., diving practices, federal government, fisher\u2019s forums, regulations, conch cleaning, participatory action, distrust, resource dependency, fishers, charter boats, illegal fishing, researchers, water surges, coast guard, territorial government process, puerto rico, territorial government, nassau grouper, government support, engaging, culebra., marine resources, decision making, course of action, puerto rican fisheries, livelihood, african dust, opposition, land-based pollution, recreational sector, policy implementation, fishers' health issues, science-based decisions, foreign investments, monitoring, habitat loss, oversight board, coastal communities, pr climate change council, us virgin islands, bajo de sico, communication gap, conservation, fishery ecosystem plan, local government, environmental concerns, data reporting, police, perspectives, acidic water, coast erosion, spawning periods, fishery management, full-time license, respect for regulations, decompression sickness, conflicts, federal waters, fishing communities, fiscal crisis, enforcement officers, public policy, resource management, fishery manager, dner advisor, commercial fishers, recreational fishing, fisheries, dner, storms, fishery managers, shark finning, tourists, additional funding, fishers' priorities, non-profit, divers, fisher's forums, community problems, poaching, ngo, community collaboration, informing, livelihood dependency, tourism businesses, system, culebra, water temperatures, natural resources, management actions, lack of enforcement, decision-makers, marine resources protection, conflict resolution", "concept_list": ["federal government process", "local mayor", "public hearings", "diving", "sustainable fishing", "long liners", "meetings", "climate change", "vieques island", "sustainable fishery regulations", "pollution", "sustainable fishery", "part-time license", "enforcement", "commercial fishermen", "caribbean fishery management council", "tourism", "infrastructure", "violations", "public input", "sea level rise", "swordfish", "job opportunities.", "diving practices", "federal government", "fisher\u2019s forums", "regulations", "conch cleaning", "participatory action", "distrust", "resource dependency", "fishers", "charter boats", "illegal fishing", "researchers", "water surges", "coast guard", "territorial government process", "puerto rico", "territorial government", "nassau grouper", "government support", "engaging", "culebra.", "marine resources", "decision making", "course of action", "puerto rican fisheries", "livelihood", "african dust", "opposition", "land-based pollution", "recreational sector", "policy implementation", "fishers' health issues", "science-based decisions", "foreign investments", "monitoring", "habitat loss", "oversight board", "coastal communities", "pr climate change council", "us virgin islands", "bajo de sico", "communication gap", "conservation", "fishery ecosystem plan", "local government", "environmental concerns", "data reporting", "police", "perspectives", "acidic water", "coast erosion", "spawning periods", "fishery management", "full-time license", "respect for regulations", "decompression sickness", "conflicts", "federal waters", "fishing communities", "fiscal crisis", "enforcement officers", "public policy", "resource management", "fishery manager", "dner advisor", "commercial fishers", "recreational fishing", "fisheries", "dner", "storms", "fishery managers", "shark finning", "tourists", "additional funding", "fishers' priorities", "non-profit", "divers", "fisher's forums", "community problems", "poaching", "ngo", "community collaboration", "informing", "livelihood dependency", "tourism businesses", "system", "culebra", "water temperatures", "natural resources", "management actions", "lack of enforcement", "decision-makers", "marine resources protection", "conflict resolution"], "type": "cluster", "node_size": 366, "label": "Fisheries Management"}, "Educational Programs": {"concepts": "formal education, education program, education, educating, educational efforts, poachers", "concept_list": ["formal education", "education program", "education", "educating", "educational efforts", "poachers"], "type": "cluster", "node_size": 33, "label": "Educational Programs"}, "Coral Reefs": {"concepts": "black corals, reef fish species, reef fish, coral bleaching, coral life, coral reef bleaching, coral reefs", "concept_list": ["black corals", "reef fish species", "reef fish", "coral bleaching", "coral life", "coral reef bleaching", "coral reefs"], "type": "cluster", "node_size": 36, "label": "Coral Reefs"}};
        const conceptData = {"federal government process": {"concepts": "federal government process", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "federal government process"}, "local mayor": {"concepts": "local mayor", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "local mayor"}, "public hearings": {"concepts": "public hearings", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "public hearings"}, "diving": {"concepts": "diving", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "diving"}, "sustainable fishing": {"concepts": "sustainable fishing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sustainable fishing"}, "long liners": {"concepts": "long liners", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "long liners"}, "meetings": {"concepts": "meetings", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "meetings"}, "climate change": {"concepts": "climate change", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "climate change"}, "vieques island": {"concepts": "vieques island", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "vieques island"}, "sustainable fishery regulations": {"concepts": "sustainable fishery regulations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sustainable fishery regulations"}, "pollution": {"concepts": "pollution", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "pollution"}, "sustainable fishery": {"concepts": "sustainable fishery", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sustainable fishery"}, "part-time license": {"concepts": "part-time license", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "part-time license"}, "enforcement": {"concepts": "enforcement", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "enforcement"}, "commercial fishermen": {"concepts": "commercial fishermen", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "commercial fishermen"}, "caribbean fishery management council": {"concepts": "caribbean fishery management council", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "caribbean fishery management council"}, "tourism": {"concepts": "tourism", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "tourism"}, "infrastructure": {"concepts": "infrastructure", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "infrastructure"}, "violations": {"concepts": "violations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "violations"}, "public input": {"concepts": "public input", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "public input"}, "sea level rise": {"concepts": "sea level rise", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sea level rise"}, "swordfish": {"concepts": "swordfish", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "swordfish"}, "job opportunities.": {"concepts": "job opportunities.", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "job opportunities."}, "diving practices": {"concepts": "diving practices", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "diving practices"}, "federal government": {"concepts": "federal government", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "federal government"}, "fisher\u2019s forums": {"concepts": "fisher\u2019s forums", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fisher\u2019s forums"}, "regulations": {"concepts": "regulations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "regulations"}, "conch cleaning": {"concepts": "conch cleaning", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conch cleaning"}, "participatory action": {"concepts": "participatory action", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "participatory action"}, "distrust": {"concepts": "distrust", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "distrust"}, "resource dependency": {"concepts": "resource dependency", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "resource dependency"}, "fishers": {"concepts": "fishers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishers"}, "charter boats": {"concepts": "charter boats", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "charter boats"}, "illegal fishing": {"concepts": "illegal fishing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "illegal fishing"}, "researchers": {"concepts": "researchers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "researchers"}, "water surges": {"concepts": "water surges", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water surges"}, "coast guard": {"concepts": "coast guard", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "coast guard"}, "territorial government process": {"concepts": "territorial government process", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "territorial government process"}, "puerto rico": {"concepts": "puerto rico", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "puerto rico"}, "territorial government": {"concepts": "territorial government", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "territorial government"}, "nassau grouper": {"concepts": "nassau grouper", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "nassau grouper"}, "government support": {"concepts": "government support", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "government support"}, "engaging": {"concepts": "engaging", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "engaging"}, "culebra.": {"concepts": "culebra.", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "culebra."}, "marine resources": {"concepts": "marine resources", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "marine resources"}, "decision making": {"concepts": "decision making", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "decision making"}, "course of action": {"concepts": "course of action", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "course of action"}, "puerto rican fisheries": {"concepts": "puerto rican fisheries", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "puerto rican fisheries"}, "livelihood": {"concepts": "livelihood", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "livelihood"}, "african dust": {"concepts": "african dust", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "african dust"}, "opposition": {"concepts": "opposition", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "opposition"}, "land-based pollution": {"concepts": "land-based pollution", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "land-based pollution"}, "recreational sector": {"concepts": "recreational sector", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "recreational sector"}, "policy implementation": {"concepts": "policy implementation", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "policy implementation"}, "fishers' health issues": {"concepts": "fishers' health issues", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishers' health issues"}, "science-based decisions": {"concepts": "science-based decisions", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "science-based decisions"}, "foreign investments": {"concepts": "foreign investments", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "foreign investments"}, "monitoring": {"concepts": "monitoring", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "monitoring"}, "habitat loss": {"concepts": "habitat loss", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "habitat loss"}, "oversight board": {"concepts": "oversight board", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "oversight board"}, "coastal communities": {"concepts": "coastal communities", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "coastal communities"}, "pr climate change council": {"concepts": "pr climate change council", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "pr climate change council"}, "us virgin islands": {"concepts": "us virgin islands", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "us virgin islands"}, "bajo de sico": {"concepts": "bajo de sico", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "bajo de sico"}, "communication gap": {"concepts": "communication gap", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "communication gap"}, "conservation": {"concepts": "conservation", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conservation"}, "fishery ecosystem plan": {"concepts": "fishery ecosystem plan", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery ecosystem plan"}, "local government": {"concepts": "local government", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "local government"}, "environmental concerns": {"concepts": "environmental concerns", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "environmental concerns"}, "data reporting": {"concepts": "data reporting", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "data reporting"}, "police": {"concepts": "police", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "police"}, "perspectives": {"concepts": "perspectives", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "perspectives"}, "acidic water": {"concepts": "acidic water", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "acidic water"}, "coast erosion": {"concepts": "coast erosion", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "coast erosion"}, "spawning periods": {"concepts": "spawning periods", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "spawning periods"}, "fishery management": {"concepts": "fishery management", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery management"}, "full-time license": {"concepts": "full-time license", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "full-time license"}, "respect for regulations": {"concepts": "respect for regulations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "respect for regulations"}, "decompression sickness": {"concepts": "decompression sickness", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "decompression sickness"}, "conflicts": {"concepts": "conflicts", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conflicts"}, "federal waters": {"concepts": "federal waters", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "federal waters"}, "fishing communities": {"concepts": "fishing communities", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishing communities"}, "fiscal crisis": {"concepts": "fiscal crisis", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fiscal crisis"}, "enforcement officers": {"concepts": "enforcement officers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "enforcement officers"}, "public policy": {"concepts": "public policy", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "public policy"}, "resource management": {"concepts": "resource management", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "resource management"}, "fishery manager": {"concepts": "fishery manager", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery manager"}, "dner advisor": {"concepts": "dner advisor", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "dner advisor"}, "commercial fishers": {"concepts": "commercial fishers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "commercial fishers"}, "recreational fishing": {"concepts": "recreational fishing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "recreational fishing"}, "fisheries": {"concepts": "fisheries", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fisheries"}, "dner": {"concepts": "dner", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "dner"}, "storms": {"concepts": "storms", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "storms"}, "fishery managers": {"concepts": "fishery managers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery managers"}, "shark finning": {"concepts": "shark finning", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "shark finning"}, "tourists": {"concepts": "tourists", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "tourists"}, "additional funding": {"concepts": "additional funding", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "additional funding"}, "fishers' priorities": {"concepts": "fishers' priorities", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishers' priorities"}, "non-profit": {"concepts": "non-profit", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "non-profit"}, "divers": {"concepts": "divers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "divers"}, "fisher's forums": {"concepts": "fisher's forums", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fisher's forums"}, "community problems": {"concepts": "community problems", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "community problems"}, "poaching": {"concepts": "poaching", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "poaching"}, "ngo": {"concepts": "ngo", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "ngo"}, "community collaboration": {"concepts": "community collaboration", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "community collaboration"}, "informing": {"concepts": "informing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "informing"}, "livelihood dependency": {"concepts": "livelihood dependency", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "livelihood dependency"}, "tourism businesses": {"concepts": "tourism businesses", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "tourism businesses"}, "system": {"concepts": "system", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "system"}, "culebra": {"concepts": "culebra", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "culebra"}, "water temperatures": {"concepts": "water temperatures", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water temperatures"}, "natural resources": {"concepts": "natural resources", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "natural resources"}, "management actions": {"concepts": "management actions", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "management actions"}, "lack of enforcement": {"concepts": "lack of enforcement", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "lack of enforcement"}, "decision-makers": {"concepts": "decision-makers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "decision-makers"}, "marine resources protection": {"concepts": "marine resources protection", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "marine resources protection"}, "conflict resolution": {"concepts": "conflict resolution", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conflict resolution"}, "formal education": {"concepts": "formal education", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "formal education"}, "education program": {"concepts": "education program", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "education program"}, "education": {"concepts": "education", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "education"}, "educating": {"concepts": "educating", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "educating"}, "educational efforts": {"concepts": "educational efforts", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "educational efforts"}, "poachers": {"concepts": "poachers", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "poachers"}, "black corals": {"concepts": "black corals", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "black corals"}, "reef fish species": {"concepts": "reef fish species", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "reef fish species"}, "reef fish": {"concepts": "reef fish", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "reef fish"}, "coral bleaching": {"concepts": "coral bleaching", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral bleaching"}, "coral life": {"concepts": "coral life", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral life"}, "coral reef bleaching": {"concepts": "coral reef bleaching", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral reef bleaching"}, "coral reefs": {"concepts": "coral reefs", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral reefs"}};
        const interClusterEdges = [["Fisheries Management", "Educational Programs", {"weight": 0.8, "confidence": 0.5800000000000001, "type": "inter_cluster", "style": "solid"}], ["Fisheries Management", "Coral Reefs", {"weight": 0.4, "confidence": 0.32999999999999996, "type": "inter_cluster", "style": "solid"}], ["Educational Programs", "Coral Reefs", {"weight": 0.8, "confidence": 0.5800000000000001, "type": "inter_cluster", "style": "solid"}], ["Educational Programs", "Fisheries Management", {"weight": 0.6, "confidence": 0.45999999999999996, "type": "inter_cluster", "style": "solid"}], ["Coral Reefs", "Fisheries Management", {"weight": 0.2, "confidence": 0.4800000000000001, "type": "inter_cluster", "style": "solid"}], ["Coral Reefs", "Educational Programs", {"weight": 0.2, "confidence": 0.43, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {"Fisheries Management": [["federal government process", {"concepts": "federal government process", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "federal government process"}], ["local mayor", {"concepts": "local mayor", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "local mayor"}], ["public hearings", {"concepts": "public hearings", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "public hearings"}], ["diving", {"concepts": "diving", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "diving"}], ["sustainable fishing", {"concepts": "sustainable fishing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sustainable fishing"}], ["long liners", {"concepts": "long liners", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "long liners"}], ["meetings", {"concepts": "meetings", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "meetings"}], ["climate change", {"concepts": "climate change", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "climate change"}], ["vieques island", {"concepts": "vieques island", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "vieques island"}], ["sustainable fishery regulations", {"concepts": "sustainable fishery regulations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sustainable fishery regulations"}], ["pollution", {"concepts": "pollution", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "pollution"}], ["sustainable fishery", {"concepts": "sustainable fishery", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sustainable fishery"}], ["part-time license", {"concepts": "part-time license", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "part-time license"}], ["enforcement", {"concepts": "enforcement", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "enforcement"}], ["commercial fishermen", {"concepts": "commercial fishermen", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "commercial fishermen"}], ["caribbean fishery management council", {"concepts": "caribbean fishery management council", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "caribbean fishery management council"}], ["tourism", {"concepts": "tourism", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "tourism"}], ["infrastructure", {"concepts": "infrastructure", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "infrastructure"}], ["violations", {"concepts": "violations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "violations"}], ["public input", {"concepts": "public input", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "public input"}], ["sea level rise", {"concepts": "sea level rise", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "sea level rise"}], ["swordfish", {"concepts": "swordfish", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "swordfish"}], ["job opportunities.", {"concepts": "job opportunities.", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "job opportunities."}], ["diving practices", {"concepts": "diving practices", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "diving practices"}], ["federal government", {"concepts": "federal government", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "federal government"}], ["fisher\u2019s forums", {"concepts": "fisher\u2019s forums", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fisher\u2019s forums"}], ["regulations", {"concepts": "regulations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "regulations"}], ["conch cleaning", {"concepts": "conch cleaning", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conch cleaning"}], ["participatory action", {"concepts": "participatory action", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "participatory action"}], ["distrust", {"concepts": "distrust", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "distrust"}], ["resource dependency", {"concepts": "resource dependency", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "resource dependency"}], ["fishers", {"concepts": "fishers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishers"}], ["charter boats", {"concepts": "charter boats", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "charter boats"}], ["illegal fishing", {"concepts": "illegal fishing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "illegal fishing"}], ["researchers", {"concepts": "researchers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "researchers"}], ["water surges", {"concepts": "water surges", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water surges"}], ["coast guard", {"concepts": "coast guard", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "coast guard"}], ["territorial government process", {"concepts": "territorial government process", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "territorial government process"}], ["puerto rico", {"concepts": "puerto rico", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "puerto rico"}], ["territorial government", {"concepts": "territorial government", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "territorial government"}], ["nassau grouper", {"concepts": "nassau grouper", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "nassau grouper"}], ["government support", {"concepts": "government support", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "government support"}], ["engaging", {"concepts": "engaging", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "engaging"}], ["culebra.", {"concepts": "culebra.", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "culebra."}], ["marine resources", {"concepts": "marine resources", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "marine resources"}], ["decision making", {"concepts": "decision making", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "decision making"}], ["course of action", {"concepts": "course of action", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "course of action"}], ["puerto rican fisheries", {"concepts": "puerto rican fisheries", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "puerto rican fisheries"}], ["livelihood", {"concepts": "livelihood", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "livelihood"}], ["african dust", {"concepts": "african dust", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "african dust"}], ["opposition", {"concepts": "opposition", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "opposition"}], ["land-based pollution", {"concepts": "land-based pollution", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "land-based pollution"}], ["recreational sector", {"concepts": "recreational sector", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "recreational sector"}], ["policy implementation", {"concepts": "policy implementation", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "policy implementation"}], ["fishers' health issues", {"concepts": "fishers' health issues", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishers' health issues"}], ["science-based decisions", {"concepts": "science-based decisions", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "science-based decisions"}], ["foreign investments", {"concepts": "foreign investments", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "foreign investments"}], ["monitoring", {"concepts": "monitoring", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "monitoring"}], ["habitat loss", {"concepts": "habitat loss", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "habitat loss"}], ["oversight board", {"concepts": "oversight board", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "oversight board"}], ["coastal communities", {"concepts": "coastal communities", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "coastal communities"}], ["pr climate change council", {"concepts": "pr climate change council", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "pr climate change council"}], ["us virgin islands", {"concepts": "us virgin islands", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "us virgin islands"}], ["bajo de sico", {"concepts": "bajo de sico", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "bajo de sico"}], ["communication gap", {"concepts": "communication gap", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "communication gap"}], ["conservation", {"concepts": "conservation", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conservation"}], ["fishery ecosystem plan", {"concepts": "fishery ecosystem plan", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery ecosystem plan"}], ["local government", {"concepts": "local government", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "local government"}], ["environmental concerns", {"concepts": "environmental concerns", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "environmental concerns"}], ["data reporting", {"concepts": "data reporting", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "data reporting"}], ["police", {"concepts": "police", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "police"}], ["perspectives", {"concepts": "perspectives", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "perspectives"}], ["acidic water", {"concepts": "acidic water", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "acidic water"}], ["coast erosion", {"concepts": "coast erosion", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "coast erosion"}], ["spawning periods", {"concepts": "spawning periods", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "spawning periods"}], ["fishery management", {"concepts": "fishery management", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery management"}], ["full-time license", {"concepts": "full-time license", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "full-time license"}], ["respect for regulations", {"concepts": "respect for regulations", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "respect for regulations"}], ["decompression sickness", {"concepts": "decompression sickness", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "decompression sickness"}], ["conflicts", {"concepts": "conflicts", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conflicts"}], ["federal waters", {"concepts": "federal waters", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "federal waters"}], ["fishing communities", {"concepts": "fishing communities", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishing communities"}], ["fiscal crisis", {"concepts": "fiscal crisis", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fiscal crisis"}], ["enforcement officers", {"concepts": "enforcement officers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "enforcement officers"}], ["public policy", {"concepts": "public policy", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "public policy"}], ["resource management", {"concepts": "resource management", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "resource management"}], ["fishery manager", {"concepts": "fishery manager", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery manager"}], ["dner advisor", {"concepts": "dner advisor", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "dner advisor"}], ["commercial fishers", {"concepts": "commercial fishers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "commercial fishers"}], ["recreational fishing", {"concepts": "recreational fishing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "recreational fishing"}], ["fisheries", {"concepts": "fisheries", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fisheries"}], ["dner", {"concepts": "dner", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "dner"}], ["storms", {"concepts": "storms", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "storms"}], ["fishery managers", {"concepts": "fishery managers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishery managers"}], ["shark finning", {"concepts": "shark finning", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "shark finning"}], ["tourists", {"concepts": "tourists", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "tourists"}], ["additional funding", {"concepts": "additional funding", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "additional funding"}], ["fishers' priorities", {"concepts": "fishers' priorities", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fishers' priorities"}], ["non-profit", {"concepts": "non-profit", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "non-profit"}], ["divers", {"concepts": "divers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "divers"}], ["fisher's forums", {"concepts": "fisher's forums", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "fisher's forums"}], ["community problems", {"concepts": "community problems", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "community problems"}], ["poaching", {"concepts": "poaching", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "poaching"}], ["ngo", {"concepts": "ngo", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "ngo"}], ["community collaboration", {"concepts": "community collaboration", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "community collaboration"}], ["informing", {"concepts": "informing", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "informing"}], ["livelihood dependency", {"concepts": "livelihood dependency", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "livelihood dependency"}], ["tourism businesses", {"concepts": "tourism businesses", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "tourism businesses"}], ["system", {"concepts": "system", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "system"}], ["culebra", {"concepts": "culebra", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "culebra"}], ["water temperatures", {"concepts": "water temperatures", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "water temperatures"}], ["natural resources", {"concepts": "natural resources", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "natural resources"}], ["management actions", {"concepts": "management actions", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "management actions"}], ["lack of enforcement", {"concepts": "lack of enforcement", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "lack of enforcement"}], ["decision-makers", {"concepts": "decision-makers", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "decision-makers"}], ["marine resources protection", {"concepts": "marine resources protection", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "marine resources protection"}], ["conflict resolution", {"concepts": "conflict resolution", "type": "concept", "cluster": "Fisheries Management", "node_size": 10, "label": "conflict resolution"}]], "Educational Programs": [["formal education", {"concepts": "formal education", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "formal education"}], ["education program", {"concepts": "education program", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "education program"}], ["education", {"concepts": "education", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "education"}], ["educating", {"concepts": "educating", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "educating"}], ["educational efforts", {"concepts": "educational efforts", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "educational efforts"}], ["poachers", {"concepts": "poachers", "type": "concept", "cluster": "Educational Programs", "node_size": 10, "label": "poachers"}]], "Coral Reefs": [["black corals", {"concepts": "black corals", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "black corals"}], ["reef fish species", {"concepts": "reef fish species", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "reef fish species"}], ["reef fish", {"concepts": "reef fish", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "reef fish"}], ["coral bleaching", {"concepts": "coral bleaching", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral bleaching"}], ["coral life", {"concepts": "coral life", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral life"}], ["coral reef bleaching", {"concepts": "coral reef bleaching", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral reef bleaching"}], ["coral reefs", {"concepts": "coral reefs", "type": "concept", "cluster": "Coral Reefs", "node_size": 10, "label": "coral reefs"}]]};
        const clusterEdges = {"Fisheries Management": [], "Educational Programs": [], "Coral Reefs": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} ‚Üí ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>


<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Malware Bugs": {"concepts": "tool support, common tools", "concept_list": ["tool support", "common tools"], "type": "cluster", "node_size": 21, "label": "Malware Bugs"}, "Code Readability": {"concepts": "malware techniques, bug", "concept_list": ["malware techniques", "bug"], "type": "cluster", "node_size": 21, "label": "Code Readability"}, "Security Tools": {"concepts": "decompiler, code readability, decompilation readability", "concept_list": ["decompiler", "code readability", "decompilation readability"], "type": "cluster", "node_size": 24, "label": "Security Tools"}, "Challenge Understanding": {"concepts": "ghidra, aslr, go, fcm exercise, ropper, buffer overflow, kidra, grep, os, download file, gdb, ctf, cts", "concept_list": ["ghidra", "aslr", "go", "fcm exercise", "ropper", "buffer overflow", "kidra", "grep", "os", "download file", "gdb", "ctf", "cts"], "type": "cluster", "node_size": 54, "label": "Challenge Understanding"}, "Tool Support": {"concepts": "fuzzing, understanding challenges, challenge, proof of concept, semi-structured, challenge understanding", "concept_list": ["fuzzing", "understanding challenges", "challenge", "proof of concept", "semi-structured", "challenge understanding"], "type": "cluster", "node_size": 33, "label": "Tool Support"}, "Debugging Challenges": {"concepts": "flag, register contexts, misleading information, connection success, virtual machines, emulation techniques, connect to server, time wasters, iterative process, common bug classes, data execution prevention, offensive context, characters, power pc, breakpoints, polyglot binaries, failure, external success, mitigation steps, bug classes, server, incorrect assumptions, static variables, internal misunderstanding, beliefs, success factors, diagram, flag indicators, acquisition success, p trace, input, file download, local setup, missing files, setup, ideas, distractions, red herrings, ctfs, remote context, statically analyzing, disruptions, rust, binaries, decompilation, original language, powerpc, file headers, local context, internal success, computer visualization software, wrong versions, emulation, user input, code obfuscation, primitive discovery tools, self-unpacking binary, fail to connect error, readability, discovery, computer visualization", "concept_list": ["flag", "register contexts", "misleading information", "connection success", "virtual machines", "emulation techniques", "connect to server", "time wasters", "iterative process", "common bug classes", "data execution prevention", "offensive context", "characters", "power pc", "breakpoints", "polyglot binaries", "failure", "external success", "mitigation steps", "bug classes", "server", "incorrect assumptions", "static variables", "internal misunderstanding", "beliefs", "success factors", "diagram", "flag indicators", "acquisition success", "p trace", "input", "file download", "local setup", "missing files", "setup", "ideas", "distractions", "red herrings", "ctfs", "remote context", "statically analyzing", "disruptions", "rust", "binaries", "decompilation", "original language", "powerpc", "file headers", "local context", "internal success", "computer visualization software", "wrong versions", "emulation", "user input", "code obfuscation", "primitive discovery tools", "self-unpacking binary", "fail to connect error", "readability", "discovery", "computer visualization"], "type": "cluster", "node_size": 198, "label": "Debugging Challenges"}, "Cyber Exploits": {"concepts": "cyber attackers, cyber attacks, local exploit, exploit primitives, defensive mitigations, permissions issues, remote exploit, remote exploit development, mitigations", "concept_list": ["cyber attackers", "cyber attacks", "local exploit", "exploit primitives", "defensive mitigations", "permissions issues", "remote exploit", "remote exploit development", "mitigations"], "type": "cluster", "node_size": 42, "label": "Cyber Exploits"}, "Decision Influences": {"concepts": "positive influence, influential factors, fuzzy cognitive map, decisions, dynamic variables, external factors, indicators, knowledge, vulnerability", "concept_list": ["positive influence", "influential factors", "fuzzy cognitive map", "decisions", "dynamic variables", "external factors", "indicators", "knowledge", "vulnerability"], "type": "cluster", "node_size": 42, "label": "Decision Influences"}, "Architecture Switching": {"concepts": "switching architecture, disassembler, control flow, execution instructions, architecture, compilation symbols, operating system, bypass mitigation, memory map, stack canaries", "concept_list": ["switching architecture", "disassembler", "control flow", "execution instructions", "architecture", "compilation symbols", "operating system", "bypass mitigation", "memory map", "stack canaries"], "type": "cluster", "node_size": 45, "label": "Architecture Switching"}, "Debugging Tools": {"concepts": "debug symbols, anti-debugger techniques, debugging, debugger, debug strings, error logs", "concept_list": ["debug symbols", "anti-debugger techniques", "debugging", "debugger", "debug strings", "error logs"], "type": "cluster", "node_size": 33, "label": "Debugging Tools"}, "Binary Development": {"concepts": "signed graph, binary, binary ninja, primitives, development, arm", "concept_list": ["signed graph", "binary", "binary ninja", "primitives", "development", "arm"], "type": "cluster", "node_size": 33, "label": "Binary Development"}};
        const conceptData = {};
        const interClusterEdges = [["Malware Bugs", "Debugging Tools", {"weight": 0.8, "confidence": 0.5700000000000001, "type": "inter_cluster", "style": "solid"}], ["Malware Bugs", "Challenge Understanding", {"weight": 0.75, "confidence": 0.5875, "type": "inter_cluster", "style": "solid"}], ["Malware Bugs", "Decision Influences", {"weight": 0.75, "confidence": 0.5625, "type": "inter_cluster", "style": "solid"}], ["Malware Bugs", "Code Readability", {"weight": 0.2, "confidence": 0.41, "type": "inter_cluster", "style": "solid"}], ["Malware Bugs", "Tool Support", {"weight": 0.25, "confidence": 0.175, "type": "inter_cluster", "style": "solid"}], ["Code Readability", "Architecture Switching", {"weight": 0.4, "confidence": 0.5800000000000001, "type": "inter_cluster", "style": "solid"}], ["Code Readability", "Security Tools", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Security Tools", "Malware Bugs", {"weight": 0.5, "confidence": 0.3875, "type": "inter_cluster", "style": "solid"}], ["Security Tools", "Debugging Challenges", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Security Tools", "Binary Development", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Challenge Understanding", "Security Tools", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Challenge Understanding", "Architecture Switching", {"weight": 0.4, "confidence": 0.29, "type": "inter_cluster", "style": "solid"}], ["Challenge Understanding", "Debugging Tools", {"weight": 0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Challenge Understanding", "Decision Influences", {"weight": 0.3333333333333333, "confidence": 0.25, "type": "inter_cluster", "style": "solid"}], ["Tool Support", "Binary Development", {"weight": 0.25, "confidence": 0.15, "type": "inter_cluster", "style": "solid"}], ["Debugging Challenges", "Debugging Tools", {"weight": 1.0, "confidence": 0.73, "type": "inter_cluster", "style": "solid"}], ["Debugging Challenges", "Tool Support", {"weight": 1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Debugging Challenges", "Decision Influences", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["Debugging Challenges", "Cyber Exploits", {"weight": 0.5, "confidence": 0.35, "type": "inter_cluster", "style": "solid"}], ["Cyber Exploits", "Decision Influences", {"weight": 0.8, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Cyber Exploits", "Tool Support", {"weight": 0.6, "confidence": 0.45, "type": "inter_cluster", "style": "solid"}], ["Cyber Exploits", "Code Readability", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Cyber Exploits", "Challenge Understanding", {"weight": 0.25, "confidence": 0.1625, "type": "inter_cluster", "style": "solid"}], ["Decision Influences", "Cyber Exploits", {"weight": 0.6, "confidence": 0.76, "type": "inter_cluster", "style": "solid"}], ["Decision Influences", "Challenge Understanding", {"weight": 0.8, "confidence": 0.57, "type": "inter_cluster", "style": "solid"}], ["Decision Influences", "Debugging Tools", {"weight": 0.8, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Decision Influences", "Debugging Challenges", {"weight": 0.5, "confidence": 0.375, "type": "inter_cluster", "style": "solid"}], ["Decision Influences", "Tool Support", {"weight": 0.25, "confidence": 0.1875, "type": "inter_cluster", "style": "solid"}], ["Architecture Switching", "Cyber Exploits", {"weight": 0.6, "confidence": 0.74, "type": "inter_cluster", "style": "solid"}], ["Architecture Switching", "Debugging Challenges", {"weight": 0.25, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Debugging Tools", "Cyber Exploits", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Debugging Tools", "Debugging Challenges", {"weight": 0.5, "confidence": 0.3625, "type": "inter_cluster", "style": "solid"}], ["Debugging Tools", "Malware Bugs", {"weight": 0.4, "confidence": 0.3, "type": "inter_cluster", "style": "solid"}], ["Binary Development", "Malware Bugs", {"weight": 0.6, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Binary Development", "Cyber Exploits", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Binary Development", "Security Tools", {"weight": 0.6666666666666666, "confidence": 0.48333333333333334, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"Malware Bugs": [], "Code Readability": [], "Security Tools": [], "Challenge Understanding": [], "Tool Support": [], "Debugging Challenges": [], "Cyber Exploits": [], "Decision Influences": [], "Architecture Switching": [], "Debugging Tools": [], "Binary Development": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>

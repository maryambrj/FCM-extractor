
<!DOCTYPE html>
<html>
<head>
    <title>Hierarchical FCM Visualization (Unconnected nodes removed)</title>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            padding: 20px;
            background: #f5f5f5;
        }
        
        #network { 
            width: 100%; 
            height: 600px; 
            border: 2px solid #ccc; 
            background: white;
            border-radius: 8px;
        }
        
        #controls {
            margin-bottom: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn {
            padding: 8px 16px;
            margin: 5px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary { background: #4A90E2; color: white; }
        .btn-primary:hover { background: #357ABD; }
        
        .btn-secondary { background: #6c757d; color: white; }
        .btn-secondary:hover { background: #545b62; }
        
        #current-view {
            font-weight: bold;
            color: #333;
            margin-left: 10px;
        }
        
        #legend {
            position: absolute;
            top: 20px;
            right: 20px;
            background: white;
            border: 1px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 12px;
            max-width: 200px;
        }
        
        .legend-item {
            margin: 5px 0;
            display: flex;
            align-items: center;
        }
        
        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .legend-line {
            width: 20px;
            height: 2px;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <h1>Fuzzy Cognitive Map - Hierarchical View</h1>
    
    <div id="controls">
        <button class="btn btn-secondary" id="back-btn" onclick="showClusterView()" style="display: none;">
            ← Back to Clusters
        </button>
        <span id="current-view">Cluster Overview</span>
        <div style="float: right;">
            <label>Min Confidence: </label>
            <input type="range" id="confidence-slider" min="0" max="1" step="0.1" value="0.3" 
                   onchange="updateConfidenceFilter(this.value)">
            <span id="confidence-value">0.3</span>
        </div>
    </div>
    
    <div id="network"></div>
    
    <div id="legend">
        <h4>Legend</h4>
        <div class="legend-item">
            <div class="legend-color" style="background: #4A90E2;"></div>
            <span>Clusters</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #FF9500;"></div>
            <span>Concepts</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #28A745;"></div>
            <span>Positive relationship</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #DC3545;"></div>
            <span>Negative relationship</span>
        </div>
        <div style="margin-top: 10px; font-style: italic; color: #666;">
            Click clusters to explore internal concepts
        </div>
    </div>

    <script>
        // Embedded data
        const clusterData = {"Academic Achievement": {"concepts": "student well-being, student motivation", "concept_list": ["student well-being", "student motivation"], "type": "cluster", "node_size": 21, "label": "Academic Achievement"}, "Community Systems": {"concepts": "academic structure, academic achievement, academic disparities", "concept_list": ["academic structure", "academic achievement", "academic disparities"], "type": "cluster", "node_size": 24, "label": "Community Systems"}, "Food Access": {"concepts": "community work, partnership, church hurt, public health, behavioral choices, stimulus, commandments, board members, mcdonald's, health disparities, investment, mental health, community trust, co-host rights, community, engagement journal, workforce development, loving systems, crisis response, holy spirit, comfort, normalization, shared values, talent, conflict over resources, organizational leadership, meijer, neighborhood resilience, complex systems, organizational boards, poor people campaign, service delivery, resource allocation, sector collaboration, transactional approach, spokesperson, gates scholar, physical health, availability, poor choices, meditation, neighborhood, partnership models, stimulus package, common good, turf wars, faith, resilience, kroger, collaboration, racial healing, support systems, transformation, effective engagement, peer influence, gardening, humanity, decision-making, practitioners, boots on the ground, prayer, community resources, system design, representation, provisions, community narrative, organizational narrative, credit allocation, commercial influence, supplemental sector, hand out, human structure, voice, system, righteousness, affordability, root causes, pandora's box, warming structure, profit over people, resident priorities, master planning, transformational change, public transportation, behavior, collaborative processes, narrative change, covid, intentionality, effective action, programs, crisis, cities, global issues, embrace, inclusion, tuskegee institute, positive impacts, humanization, anchor scripture, collective well-being, love, human hurt, program models, communication, organizational collaboration, recognition, hand up, community empowerment, teamwork, community engagement, hamady brothers, verses, abide, dignity, impact, racial inequities, grassroots organizations, choices, profit motive, church meetings, reliance on aid, john 15:1-12, neighborhood grants, social barriers, systemic barriers, environmental psychology, equity, black lives matter, task force, provision of services, urban planning, summit, voices, respect, social equity, leadership roles, screen sharing, community promotion, community foundation, role models, social change, maps, spatial differences, community leadership, leverage points, north end, shipt, compartmentalization, resource sharing, socioeconomic structure, climate crisis, negative byproducts, empowerment, support, provision, income, community impact, csa boxes, care, social structure, mindset, flint fresh, water crisis, life of crime, streamlined processes, subculture, leadership, stakeholders, generation change, community members, handout, community suffering, barriers, gm closures, equality, holistic approach, community values, trust, systemic change, social support, power structures, social transformation, collective belonging, eye contact, changing narrative, safety, foundations, value system, accessibility, delivery services, domino effect, vaccine perception, outcomes, infrastructure, judgmental aspect, serving, community partnerships, holy ghost, pandemic, history, creativity, values, truth, quality of life, competition, philanthropic field, articulation, administration, cyclical process, mott foundation, global health, social identity, transportation, community voices, grubhub, cultural values, apartment complexes, group identity, work from home, access to resources, access, impact story, racial pride, flint, partnerships, perception, philanthropy, resources, acting on behalf, field trips", "concept_list": ["community work", "partnership", "church hurt", "public health", "behavioral choices", "stimulus", "commandments", "board members", "mcdonald's", "health disparities", "investment", "mental health", "community trust", "co-host rights", "community", "engagement journal", "workforce development", "loving systems", "crisis response", "holy spirit", "comfort", "normalization", "shared values", "talent", "conflict over resources", "organizational leadership", "meijer", "neighborhood resilience", "complex systems", "organizational boards", "poor people campaign", "service delivery", "resource allocation", "sector collaboration", "transactional approach", "spokesperson", "gates scholar", "physical health", "availability", "poor choices", "meditation", "neighborhood", "partnership models", "stimulus package", "common good", "turf wars", "faith", "resilience", "kroger", "collaboration", "racial healing", "support systems", "transformation", "effective engagement", "peer influence", "gardening", "humanity", "decision-making", "practitioners", "boots on the ground", "prayer", "community resources", "system design", "representation", "provisions", "community narrative", "organizational narrative", "credit allocation", "commercial influence", "supplemental sector", "hand out", "human structure", "voice", "system", "righteousness", "affordability", "root causes", "pandora's box", "warming structure", "profit over people", "resident priorities", "master planning", "transformational change", "public transportation", "behavior", "collaborative processes", "narrative change", "covid", "intentionality", "effective action", "programs", "crisis", "cities", "global issues", "embrace", "inclusion", "tuskegee institute", "positive impacts", "humanization", "anchor scripture", "collective well-being", "love", "human hurt", "program models", "communication", "organizational collaboration", "recognition", "hand up", "community empowerment", "teamwork", "community engagement", "hamady brothers", "verses", "abide", "dignity", "impact", "racial inequities", "grassroots organizations", "choices", "profit motive", "church meetings", "reliance on aid", "john 15:1-12", "neighborhood grants", "social barriers", "systemic barriers", "environmental psychology", "equity", "black lives matter", "task force", "provision of services", "urban planning", "summit", "voices", "respect", "social equity", "leadership roles", "screen sharing", "community promotion", "community foundation", "role models", "social change", "maps", "spatial differences", "community leadership", "leverage points", "north end", "shipt", "compartmentalization", "resource sharing", "socioeconomic structure", "climate crisis", "negative byproducts", "empowerment", "support", "provision", "income", "community impact", "csa boxes", "care", "social structure", "mindset", "flint fresh", "water crisis", "life of crime", "streamlined processes", "subculture", "leadership", "stakeholders", "generation change", "community members", "handout", "community suffering", "barriers", "gm closures", "equality", "holistic approach", "community values", "trust", "systemic change", "social support", "power structures", "social transformation", "collective belonging", "eye contact", "changing narrative", "safety", "foundations", "value system", "accessibility", "delivery services", "domino effect", "vaccine perception", "outcomes", "infrastructure", "judgmental aspect", "serving", "community partnerships", "holy ghost", "pandemic", "history", "creativity", "values", "truth", "quality of life", "competition", "philanthropic field", "articulation", "administration", "cyclical process", "mott foundation", "global health", "social identity", "transportation", "community voices", "grubhub", "cultural values", "apartment complexes", "group identity", "work from home", "access to resources", "access", "impact story", "racial pride", "flint", "partnerships", "perception", "philanthropy", "resources", "acting on behalf", "field trips"], "type": "cluster", "node_size": 708, "label": "Food Access"}, "Local Funding": {"concepts": "chain restaurants, food price, food demos, lunch menus, nutrition education, food distribution, food amount, food skills, community meals, food preferences, nutritious foods, food access, food desert, school food system, food deserts, healthy food, food suppliers, mom and pop stores, local restaurants, hot cheetos, meal standards, convenience stores, community appetite, food bucks, flint food system, free meals, retail sources, unhealthy diet, food quality, food marketing, food insecurity, food security, child nutrition, free food, nutrition, fruit accessibility, food system, food accessibility, supplemental nutrition programs, grocery stores, fruit availability, school meals, cooking", "concept_list": ["chain restaurants", "food price", "food demos", "lunch menus", "nutrition education", "food distribution", "food amount", "food skills", "community meals", "food preferences", "nutritious foods", "food access", "food desert", "school food system", "food deserts", "healthy food", "food suppliers", "mom and pop stores", "local restaurants", "hot cheetos", "meal standards", "convenience stores", "community appetite", "food bucks", "flint food system", "free meals", "retail sources", "unhealthy diet", "food quality", "food marketing", "food insecurity", "food security", "child nutrition", "free food", "nutrition", "fruit accessibility", "food system", "food accessibility", "supplemental nutrition programs", "grocery stores", "fruit availability", "school meals", "cooking"], "type": "cluster", "node_size": 144, "label": "Local Funding"}, "Student Well-Being": {"concepts": "holistic funding, city government, governmental support, funding system, local farmers, farmers markets, braided funding, government response, economic development, local development, local economic development, farmers market", "concept_list": ["holistic funding", "city government", "governmental support", "funding system", "local farmers", "farmers markets", "braided funding", "government response", "economic development", "local development", "local economic development", "farmers market"], "type": "cluster", "node_size": 51, "label": "Student Well-Being"}, "Youth Academic Support": {"concepts": "urban education, student support, disadvantaged youth, socioeconomic status, student agency, scholarships, organizational knowledge, youth programs, academic support, school performance, college readiness, institutional knowledge, academic preparation, youth, childhood development, employment gap, educational attainment", "concept_list": ["urban education", "student support", "disadvantaged youth", "socioeconomic status", "student agency", "scholarships", "organizational knowledge", "youth programs", "academic support", "school performance", "college readiness", "institutional knowledge", "academic preparation", "youth", "childhood development", "employment gap", "educational attainment"], "type": "cluster", "node_size": 66, "label": "Youth Academic Support"}, "Educational Access": {"concepts": "educational barriers, educational opportunities, education crisis, education, educational equity, educational preparedness, opportunity for education, career development, educational value, educational policy, educational outcomes, value of education", "concept_list": ["educational barriers", "educational opportunities", "education crisis", "education", "educational equity", "educational preparedness", "opportunity for education", "career development", "educational value", "educational policy", "educational outcomes", "value of education"], "type": "cluster", "node_size": 51, "label": "Educational Access"}, "School Partnerships": {"concepts": "school partnerships, school-community connections, after school programs, out of school time, school engagement", "concept_list": ["school partnerships", "school-community connections", "after school programs", "out of school time", "school engagement"], "type": "cluster", "node_size": 30, "label": "School Partnerships"}, "Academic Standards": {"concepts": "academic standards, school standards, school rigor", "concept_list": ["academic standards", "school standards", "school rigor"], "type": "cluster", "node_size": 24, "label": "Academic Standards"}, "School Environment": {"concepts": "school environment, school support systems, school cafeterias, school resources", "concept_list": ["school environment", "school support systems", "school cafeterias", "school resources"], "type": "cluster", "node_size": 27, "label": "School Environment"}, "School Transitions": {"concepts": "school transfer, school policies, school system, school transitions", "concept_list": ["school transfer", "school policies", "school system", "school transitions"], "type": "cluster", "node_size": 27, "label": "School Transitions"}, "Sex Education": {"concepts": "sexual responsibility, sex educator, planned parenthood, sex education", "concept_list": ["sexual responsibility", "sex educator", "planned parenthood", "sex education"], "type": "cluster", "node_size": 27, "label": "Sex Education"}, "Family Involvement": {"concepts": "family engagement, family time, parental involvement", "concept_list": ["family engagement", "family time", "parental involvement"], "type": "cluster", "node_size": 24, "label": "Family Involvement"}};
        const conceptData = {};
        const interClusterEdges = [["Academic Achievement", "School Transitions", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Academic Achievement", "Sex Education", {"weight": 1.0, "confidence": 0.5833333333333334, "type": "inter_cluster", "style": "solid"}], ["Academic Achievement", "Academic Standards", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Community Systems", "Family Involvement", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Food Access", "Local Funding", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["Food Access", "Community Systems", {"weight": 1.0, "confidence": 0.6833333333333332, "type": "inter_cluster", "style": "solid"}], ["Food Access", "Academic Standards", {"weight": 0.75, "confidence": 0.475, "type": "inter_cluster", "style": "solid"}], ["Food Access", "School Transitions", {"weight": 0.3333333333333333, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Food Access", "Family Involvement", {"weight": 1.0, "confidence": 0.65, "type": "inter_cluster", "style": "solid"}], ["Local Funding", "Youth Academic Support", {"weight": 0.5, "confidence": 0.7375, "type": "inter_cluster", "style": "solid"}], ["Local Funding", "Academic Achievement", {"weight": 0.3333333333333333, "confidence": 0.7666666666666666, "type": "inter_cluster", "style": "solid"}], ["Local Funding", "Food Access", {"weight": 0.75, "confidence": 0.5125, "type": "inter_cluster", "style": "solid"}], ["Local Funding", "Family Involvement", {"weight": 0.3333333333333333, "confidence": 0.6333333333333333, "type": "inter_cluster", "style": "solid"}], ["Local Funding", "Community Systems", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Student Well-Being", "Youth Academic Support", {"weight": 1.0, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["Student Well-Being", "Local Funding", {"weight": 1.0, "confidence": 0.7333333333333334, "type": "inter_cluster", "style": "solid"}], ["Youth Academic Support", "School Environment", {"weight": 1.0, "confidence": 0.7000000000000001, "type": "inter_cluster", "style": "solid"}], ["Youth Academic Support", "School Partnerships", {"weight": 1.0, "confidence": 0.7999999999999999, "type": "inter_cluster", "style": "solid"}], ["Youth Academic Support", "School Transitions", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Youth Academic Support", "Food Access", {"weight": 1.0, "confidence": 0.7333333333333334, "type": "inter_cluster", "style": "solid"}], ["Youth Academic Support", "Sex Education", {"weight": 0.75, "confidence": 0.44999999999999996, "type": "inter_cluster", "style": "solid"}], ["Educational Access", "School Partnerships", {"weight": 1.0, "confidence": 0.6875, "type": "inter_cluster", "style": "solid"}], ["Educational Access", "Community Systems", {"weight": 1.0, "confidence": 0.85, "type": "inter_cluster", "style": "solid"}], ["Educational Access", "Academic Standards", {"weight": 1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["Educational Access", "School Environment", {"weight": 1.0, "confidence": 0.75, "type": "inter_cluster", "style": "solid"}], ["School Partnerships", "Local Funding", {"weight": 0.5, "confidence": 0.725, "type": "inter_cluster", "style": "solid"}], ["School Partnerships", "Academic Standards", {"weight": 1.0, "confidence": 0.7250000000000001, "type": "inter_cluster", "style": "solid"}], ["School Partnerships", "Sex Education", {"weight": 1.0, "confidence": 0.6166666666666667, "type": "inter_cluster", "style": "solid"}], ["School Partnerships", "Educational Access", {"weight": 1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["Academic Standards", "Family Involvement", {"weight": 0.5, "confidence": 0.625, "type": "inter_cluster", "style": "solid"}], ["Academic Standards", "Youth Academic Support", {"weight": 1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["School Environment", "Food Access", {"weight": 1.0, "confidence": 0.6799999999999999, "type": "inter_cluster", "style": "solid"}], ["School Environment", "Academic Achievement", {"weight": 1.0, "confidence": 0.8624999999999999, "type": "inter_cluster", "style": "solid"}], ["School Environment", "Academic Standards", {"weight": 1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["School Environment", "Youth Academic Support", {"weight": 1.0, "confidence": 0.8166666666666668, "type": "inter_cluster", "style": "solid"}], ["School Environment", "Local Funding", {"weight": 0.75, "confidence": 0.5875, "type": "inter_cluster", "style": "solid"}], ["School Environment", "Student Well-Being", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["School Environment", "School Transitions", {"weight": -1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["School Transitions", "Youth Academic Support", {"weight": -1.0, "confidence": 0.7333333333333334, "type": "inter_cluster", "style": "solid"}], ["School Transitions", "Family Involvement", {"weight": -1.0, "confidence": 0.6833333333333332, "type": "inter_cluster", "style": "solid"}], ["School Transitions", "Community Systems", {"weight": -1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["School Transitions", "Academic Achievement", {"weight": -1.0, "confidence": 0.775, "type": "inter_cluster", "style": "solid"}], ["School Transitions", "Sex Education", {"weight": -0.75, "confidence": 0.3875, "type": "inter_cluster", "style": "solid"}], ["School Transitions", "Academic Standards", {"weight": -1.0, "confidence": 0.7, "type": "inter_cluster", "style": "solid"}], ["Sex Education", "Youth Academic Support", {"weight": 1.0, "confidence": 0.6499999999999999, "type": "inter_cluster", "style": "solid"}], ["Sex Education", "Educational Access", {"weight": 1.0, "confidence": 0.6375, "type": "inter_cluster", "style": "solid"}], ["Sex Education", "Academic Achievement", {"weight": 1.0, "confidence": 0.6499999999999999, "type": "inter_cluster", "style": "solid"}], ["Sex Education", "Community Systems", {"weight": 1.0, "confidence": 0.6, "type": "inter_cluster", "style": "solid"}], ["Family Involvement", "Academic Achievement", {"weight": 1.0, "confidence": 0.875, "type": "inter_cluster", "style": "solid"}], ["Family Involvement", "School Environment", {"weight": 1.0, "confidence": 0.7375, "type": "inter_cluster", "style": "solid"}]];
        const clusterConcepts = {};
        const clusterEdges = {"Academic Achievement": [], "Community Systems": [], "Food Access": [], "Local Funding": [], "Student Well-Being": [], "Youth Academic Support": [], "Educational Access": [], "School Partnerships": [], "Academic Standards": [], "School Environment": [], "School Transitions": [], "Sex Education": [], "Family Involvement": []};
        
        let network;
        let currentView = 'clusters';
        let currentCluster = null;
        let minConfidence = 0.3;
        
        // Network options
        const options = {
            nodes: {
                font: { color: 'white', size: 14 },
                borderWidth: 2,
                shadow: true
            },
            edges: {
                arrows: { to: { enabled: true, scaleFactor: 1.2 } },
                shadow: true,
                smooth: { type: 'continuous' }
            },
            physics: {
                stabilization: { iterations: 100 },
                barnesHut: {
                    gravitationalConstant: -8000,
                    springConstant: 0.001,
                    springLength: 200
                }
            },
            interaction: {
                hover: true,
                selectConnectedEdges: false
            }
        };
        
        function initNetwork() {
            const container = document.getElementById('network');
            const data = getClusterViewData();
            network = new vis.Network(container, data, options);
            
            // Handle cluster clicks for drill-down
            network.on("click", function(params) {
                if (params.nodes.length > 0 && currentView === 'clusters') {
                    const clickedNode = params.nodes[0];
                    if (clusterConcepts[clickedNode]) {
                        showClusterDetail(clickedNode);
                    }
                }
            });
        }
        
        function getClusterViewData() {
            const nodes = [];
            const edges = [];
            
            // Add cluster nodes
            Object.entries(clusterData).forEach(([clusterId, data]) => {
                const concepts = data.concepts || [];
                const conceptsStr = Array.isArray(concepts) ? concepts.join(', ') : concepts;
                
                nodes.push({
                    id: clusterId,
                    label: clusterId,
                    title: `Cluster: ${clusterId}\nConcepts: ${conceptsStr}\nClick to explore internal relationships`,
                    color: '#4A90E2',
                    size: 25 + (conceptsStr.split(',').length * 2),
                    font: { color: 'white' }
                });
            });
            
            // Add inter-cluster edges
            interClusterEdges.forEach(([source, target, edgeData]) => {
                const confidence = edgeData.confidence || 1.0;
                const weight = edgeData.weight || 0;
                
                if (confidence >= minConfidence) {
                    edges.push({
                        from: source,
                        to: target,
                        color: weight > 0 ? '#28A745' : '#DC3545',
                        width: Math.abs(weight) * 3 + 1,
                        title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                        dashes: false
                    });
                }
            });
            
            return { nodes: nodes, edges: edges };
        }
        
        function getClusterDetailData(clusterId) {
            const nodes = [];
            const edges = [];
            
            // Add concept nodes for this cluster
            if (clusterConcepts[clusterId]) {
                clusterConcepts[clusterId].forEach(([conceptId, data]) => {
                    nodes.push({
                        id: conceptId,
                        label: conceptId,
                        title: `Concept: ${conceptId}\nFrom cluster: ${clusterId}`,
                        color: '#FF9500',
                        size: 20,
                        font: { color: 'white' }
                    });
                });
            }
            
            // Add intra-cluster edges
            if (clusterEdges[clusterId]) {
                clusterEdges[clusterId].forEach(([source, target, edgeData]) => {
                    const confidence = edgeData.confidence || 1.0;
                    const weight = edgeData.weight || 0;
                    
                    if (confidence >= minConfidence) {
                        edges.push({
                            from: source,
                            to: target,
                            color: weight > 0 ? '#28A745' : '#DC3545',
                            width: Math.abs(weight) * 3 + 1,
                            title: `${source} → ${target}\nWeight: ${weight}\nConfidence: ${confidence.toFixed(2)}`,
                            dashes: true
                        });
                    }
                });
            }
            
            return { nodes: nodes, edges: edges };
        }
        
        function showClusterView() {
            currentView = 'clusters';
            currentCluster = null;
            const data = getClusterViewData();
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'none';
            document.getElementById('current-view').textContent = 'Cluster Overview';
        }
        
        function showClusterDetail(clusterId) {
            currentView = 'concepts';
            currentCluster = clusterId;
            const data = getClusterDetailData(clusterId);
            network.setData(data);
            
            document.getElementById('back-btn').style.display = 'inline-block';
            document.getElementById('current-view').textContent = `Inside Cluster: ${clusterId}`;
        }
        
        function updateConfidenceFilter(value) {
            minConfidence = parseFloat(value);
            document.getElementById('confidence-value').textContent = value;
            
            // Refresh current view
            if (currentView === 'clusters') {
                showClusterView();
            } else {
                showClusterDetail(currentCluster);
            }
        }
        
        // Initialize the network when page loads
        window.onload = function() {
            initNetwork();
        };
    </script>
</body>
</html>
